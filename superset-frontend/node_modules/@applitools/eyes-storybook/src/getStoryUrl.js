'use strict';
const getIframeUrl = require('./getIframeUrl');

function getStoryUrl({parameters, id}, baseUrl) {
  let storyUrl = `${getIframeUrl(baseUrl)}&path=/story/${encodeURIComponent(id)}`;

  const queryParams = parameters && parameters.eyes && parameters.eyes.queryParams;
  if (queryParams) {
    storyUrl += `&eyes-query-params=${Object.keys(queryParams).join(',')}`;
    for (const [name, value] of Object.entries(queryParams)) {
      storyUrl += `&${name}=${encodeURIComponent(value)}`;
    }
  }

  return storyUrl;
}

module.exports = getStoryUrl;
