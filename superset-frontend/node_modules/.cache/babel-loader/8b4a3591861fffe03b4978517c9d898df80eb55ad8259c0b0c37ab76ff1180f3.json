{"ast":null,"code":"import _omit from \"lodash/omit\";function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";} /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { Input } from 'src/components/Input';\nimport { FormItem } from 'src/components/Form';\nimport jsonStringify from 'json-stringify-pretty-compact';\nimport Button from 'src/components/Button';\nimport { AntdForm, AsyncSelect, Col, Row } from 'src/components';\nimport rison from 'rison';\nimport { ensureIsArray, isFeatureEnabled, FeatureFlag, getCategoricalSchemeRegistry, styled, SupersetClient, t, getClientErrorObject, css } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport { JsonEditor } from 'src/components/AsyncAceEditor';\nimport ColorSchemeControlWrapper from 'src/dashboard/components/ColorSchemeControlWrapper';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { fetchTags, OBJECT_TYPES } from 'src/features/tags/tags';\nimport { loadTags } from 'src/components/Tags/utils';\nimport { applyColors, getColorNamespace, getFreshLabelsColorMapEntries } from 'src/utils/colorScheme';\nimport getOwnerName from 'src/utils/getOwnerName';\nimport { useDispatch } from 'react-redux';\nimport { setColorScheme, setDashboardMetadata } from 'src/dashboard/actions/dashboardState';\nimport { areObjectsEqual } from 'src/reduxUtils';import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nconst StyledFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\nconst StyledJsonEditor = styled(JsonEditor)`\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ theme }) => theme.colors.secondary.light2};\n`;var _ref = process.env.NODE_ENV === \"production\" ? { name: \"1blj7km\", styles: \"margin-top:1em\" } : { name: \"1gtq0eh-PropertiesModal\", styles: \"margin-top:1em;label:PropertiesModal;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL1Byb3BlcnRpZXNNb2RhbC9pbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMGNrQiIsImZpbGUiOiIvaG9tZS9hZGVsL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9Qcm9wZXJ0aWVzTW9kYWwvaW5kZXgudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IG9taXQgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdzcmMvY29tcG9uZW50cy9JbnB1dCc7XG5pbXBvcnQgeyBGb3JtSXRlbSB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0IGpzb25TdHJpbmdpZnkgZnJvbSAnanNvbi1zdHJpbmdpZnktcHJldHR5LWNvbXBhY3QnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IHsgQW50ZEZvcm0sIEFzeW5jU2VsZWN0LCBDb2wsIFJvdyB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCByaXNvbiBmcm9tICdyaXNvbic7XG5pbXBvcnQgeyBlbnN1cmVJc0FycmF5LCBpc0ZlYXR1cmVFbmFibGVkLCBGZWF0dXJlRmxhZywgZ2V0Q2F0ZWdvcmljYWxTY2hlbWVSZWdpc3RyeSwgc3R5bGVkLCBTdXBlcnNldENsaWVudCwgdCwgZ2V0Q2xpZW50RXJyb3JPYmplY3QsIGNzcywgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgTW9kYWwgZnJvbSAnc3JjL2NvbXBvbmVudHMvTW9kYWwnO1xuaW1wb3J0IHsgSnNvbkVkaXRvciB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0FzeW5jQWNlRWRpdG9yJztcbmltcG9ydCBDb2xvclNjaGVtZUNvbnRyb2xXcmFwcGVyIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9Db2xvclNjaGVtZUNvbnRyb2xXcmFwcGVyJztcbmltcG9ydCBGaWx0ZXJTY29wZU1vZGFsIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9maWx0ZXJzY29wZS9GaWx0ZXJTY29wZU1vZGFsJztcbmltcG9ydCB3aXRoVG9hc3RzIGZyb20gJ3NyYy9jb21wb25lbnRzL01lc3NhZ2VUb2FzdHMvd2l0aFRvYXN0cyc7XG5pbXBvcnQgeyBmZXRjaFRhZ3MsIE9CSkVDVF9UWVBFUyB9IGZyb20gJ3NyYy9mZWF0dXJlcy90YWdzL3RhZ3MnO1xuaW1wb3J0IHsgbG9hZFRhZ3MgfSBmcm9tICdzcmMvY29tcG9uZW50cy9UYWdzL3V0aWxzJztcbmltcG9ydCB7IGFwcGx5Q29sb3JzLCBnZXRDb2xvck5hbWVzcGFjZSwgZ2V0RnJlc2hMYWJlbHNDb2xvck1hcEVudHJpZXMsIH0gZnJvbSAnc3JjL3V0aWxzL2NvbG9yU2NoZW1lJztcbmltcG9ydCBnZXRPd25lck5hbWUgZnJvbSAnc3JjL3V0aWxzL2dldE93bmVyTmFtZSc7XG5pbXBvcnQgeyB1c2VEaXNwYXRjaCB9IGZyb20gJ3JlYWN0LXJlZHV4JztcbmltcG9ydCB7IHNldENvbG9yU2NoZW1lLCBzZXREYXNoYm9hcmRNZXRhZGF0YSwgfSBmcm9tICdzcmMvZGFzaGJvYXJkL2FjdGlvbnMvZGFzaGJvYXJkU3RhdGUnO1xuaW1wb3J0IHsgYXJlT2JqZWN0c0VxdWFsIH0gZnJvbSAnc3JjL3JlZHV4VXRpbHMnO1xuY29uc3QgU3R5bGVkRm9ybUl0ZW0gPSBzdHlsZWQoRm9ybUl0ZW0pIGBcbiAgbWFyZ2luLWJvdHRvbTogMDtcbmA7XG5jb25zdCBTdHlsZWRKc29uRWRpdG9yID0gc3R5bGVkKEpzb25FZGl0b3IpIGBcbiAgYm9yZGVyLXJhZGl1czogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ib3JkZXJSYWRpdXN9cHg7XG4gIGJvcmRlcjogMXB4IHNvbGlkICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLnNlY29uZGFyeS5saWdodDJ9O1xuYDtcbmNvbnN0IFByb3BlcnRpZXNNb2RhbCA9ICh7IGFkZFN1Y2Nlc3NUb2FzdCwgYWRkRGFuZ2VyVG9hc3QsIGNvbG9yU2NoZW1lOiBjdXJyZW50Q29sb3JTY2hlbWUsIGRhc2hib2FyZElkLCBkYXNoYm9hcmRJbmZvOiBjdXJyZW50RGFzaGJvYXJkSW5mbywgZGFzaGJvYXJkVGl0bGUsIG9uSGlkZSA9ICgpID0+IHsgfSwgb25seUFwcGx5ID0gZmFsc2UsIG9uU3VibWl0ID0gKCkgPT4geyB9LCBzaG93ID0gZmFsc2UsIH0pID0+IHtcbiAgICBjb25zdCBkaXNwYXRjaCA9IHVzZURpc3BhdGNoKCk7XG4gICAgY29uc3QgW2Zvcm1dID0gQW50ZEZvcm0udXNlRm9ybSgpO1xuICAgIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW2lzQWR2YW5jZWRPcGVuLCBzZXRJc0FkdmFuY2VkT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW2NvbG9yU2NoZW1lLCBzZXRDdXJyZW50Q29sb3JTY2hlbWVdID0gdXNlU3RhdGUoY3VycmVudENvbG9yU2NoZW1lKTtcbiAgICBjb25zdCBbanNvbk1ldGFkYXRhLCBzZXRKc29uTWV0YWRhdGFdID0gdXNlU3RhdGUoJycpO1xuICAgIGNvbnN0IFtkYXNoYm9hcmRJbmZvLCBzZXREYXNoYm9hcmRJbmZvXSA9IHVzZVN0YXRlKCk7XG4gICAgY29uc3QgW293bmVycywgc2V0T3duZXJzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBbcm9sZXMsIHNldFJvbGVzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBzYXZlTGFiZWwgPSBvbmx5QXBwbHkgPyB0KCdBcHBseScpIDogdCgnU2F2ZScpO1xuICAgIGNvbnN0IFt0YWdzLCBzZXRUYWdzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBjYXRlZ29yaWNhbFNjaGVtZVJlZ2lzdHJ5ID0gZ2V0Q2F0ZWdvcmljYWxTY2hlbWVSZWdpc3RyeSgpO1xuICAgIGNvbnN0IG9yaWdpbmFsRGFzaGJvYXJkTWV0YWRhdGEgPSB1c2VSZWYoe30pO1xuICAgIGNvbnN0IHRhZ3NBc1NlbGVjdFZhbHVlcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBjb25zdCBzZWxlY3RUYWdzID0gdGFncy5tYXAoKHRhZykgPT4gKHtcbiAgICAgICAgICAgIHZhbHVlOiB0YWcuaWQsXG4gICAgICAgICAgICBsYWJlbDogdGFnLm5hbWUsXG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdFRhZ3M7XG4gICAgfSwgW3RhZ3MubGVuZ3RoXSk7XG4gICAgY29uc3QgaGFuZGxlRXJyb3JSZXNwb25zZSA9IGFzeW5jIChyZXNwb25zZSkgPT4ge1xuICAgICAgICBjb25zdCB7IGVycm9yLCBzdGF0dXNUZXh0LCBtZXNzYWdlIH0gPSBhd2FpdCBnZXRDbGllbnRFcnJvck9iamVjdChyZXNwb25zZSk7XG4gICAgICAgIGxldCBlcnJvclRleHQgPSBlcnJvciB8fCBzdGF0dXNUZXh0IHx8IHQoJ0FuIGVycm9yIGhhcyBvY2N1cnJlZCcpO1xuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdvYmplY3QnICYmICdqc29uX21ldGFkYXRhJyBpbiBtZXNzYWdlKSB7XG4gICAgICAgICAgICBlcnJvclRleHQgPSBtZXNzYWdlLmpzb25fbWV0YWRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBlcnJvclRleHQgPSBtZXNzYWdlO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UgPT09ICdGb3JiaWRkZW4nKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JUZXh0ID0gdCgnWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gZWRpdCB0aGlzIGRhc2hib2FyZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIE1vZGFsLmVycm9yKHtcbiAgICAgICAgICAgIHRpdGxlOiB0KCdFcnJvcicpLFxuICAgICAgICAgICAgY29udGVudDogZXJyb3JUZXh0LFxuICAgICAgICAgICAgb2tCdXR0b25Qcm9wczogeyBkYW5nZXI6IHRydWUsIGNsYXNzTmFtZTogJ2J0bi1kYW5nZXInIH0sXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgbG9hZEFjY2Vzc09wdGlvbnMgPSB1c2VDYWxsYmFjaygoYWNjZXNzVHlwZSA9ICdvd25lcnMnLCBpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7XG4gICAgICAgICAgICBmaWx0ZXI6IGlucHV0LFxuICAgICAgICAgICAgcGFnZSxcbiAgICAgICAgICAgIHBhZ2Vfc2l6ZTogcGFnZVNpemUsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXNoYm9hcmQvcmVsYXRlZC8ke2FjY2Vzc1R5cGV9P3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICAgICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdFxuICAgICAgICAgICAgICAgIC5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uZXh0cmEuYWN0aXZlICE9PSB1bmRlZmluZWQgPyBpdGVtLmV4dHJhLmFjdGl2ZSA6IHRydWUpXG4gICAgICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgICAgICAgICBsYWJlbDogaXRlbS50ZXh0LFxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCxcbiAgICAgICAgfSkpO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBoYW5kbGVEYXNoYm9hcmREYXRhID0gdXNlQ2FsbGJhY2soZGFzaGJvYXJkRGF0YSA9PiB7XG4gICAgICAgIGNvbnN0IHsgaWQsIGRhc2hib2FyZF90aXRsZSwgc2x1ZywgY2VydGlmaWVkX2J5LCBjZXJ0aWZpY2F0aW9uX2RldGFpbHMsIG93bmVycywgcm9sZXMsIG1ldGFkYXRhLCBpc19tYW5hZ2VkX2V4dGVybmFsbHksIH0gPSBkYXNoYm9hcmREYXRhO1xuICAgICAgICBjb25zdCBkYXNoYm9hcmRJbmZvID0ge1xuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICB0aXRsZTogZGFzaGJvYXJkX3RpdGxlLFxuICAgICAgICAgICAgc2x1Zzogc2x1ZyB8fCAnJyxcbiAgICAgICAgICAgIGNlcnRpZmllZEJ5OiBjZXJ0aWZpZWRfYnkgfHwgJycsXG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uRGV0YWlsczogY2VydGlmaWNhdGlvbl9kZXRhaWxzIHx8ICcnLFxuICAgICAgICAgICAgaXNNYW5hZ2VkRXh0ZXJuYWxseTogaXNfbWFuYWdlZF9leHRlcm5hbGx5IHx8IGZhbHNlLFxuICAgICAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgIH07XG4gICAgICAgIGZvcm0uc2V0RmllbGRzVmFsdWUoZGFzaGJvYXJkSW5mbyk7XG4gICAgICAgIHNldERhc2hib2FyZEluZm8oZGFzaGJvYXJkSW5mbyk7XG4gICAgICAgIHNldE93bmVycyhvd25lcnMpO1xuICAgICAgICBzZXRSb2xlcyhyb2xlcyk7XG4gICAgICAgIHNldEN1cnJlbnRDb2xvclNjaGVtZShtZXRhZGF0YS5jb2xvcl9zY2hlbWUpO1xuICAgICAgICBjb25zdCBtZXRhRGF0YUNvcHkgPSBvbWl0KG1ldGFkYXRhLCBbXG4gICAgICAgICAgICAncG9zaXRpb25zJyxcbiAgICAgICAgICAgICdzaGFyZWRfbGFiZWxfY29sb3JzJyxcbiAgICAgICAgICAgICdtYXBfbGFiZWxfY29sb3JzJyxcbiAgICAgICAgICAgICdjb2xvcl9zY2hlbWVfZG9tYWluJyxcbiAgICAgICAgXSk7XG4gICAgICAgIHNldEpzb25NZXRhZGF0YShtZXRhRGF0YUNvcHkgPyBqc29uU3RyaW5naWZ5KG1ldGFEYXRhQ29weSkgOiAnJyk7XG4gICAgICAgIG9yaWdpbmFsRGFzaGJvYXJkTWV0YWRhdGEuY3VycmVudCA9IG1ldGFkYXRhO1xuICAgIH0sIFtmb3JtXSk7XG4gICAgY29uc3QgZmV0Y2hEYXNoYm9hcmREZXRhaWxzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG4gICAgICAgIC8vIFdlIGZldGNoIHRoZSBkYXNoYm9hcmQgZGV0YWlscyBiZWNhdXNlIG5vdCBhbGwgY29kZVxuICAgICAgICAvLyB0aGF0IHJlbmRlcnMgdGhpcyBjb21wb25lbnQgaGF2ZSBhbGwgdGhlIHZhbHVlcyB3ZSBuZWVkLlxuICAgICAgICAvLyBBdCBzb21lIHBvaW50IHdoZW4gd2UgaGF2ZSBhIG1vcmUgY29uc2lzdGVudCBmcm9udGVuZFxuICAgICAgICAvLyBkYXRhbW9kZWwsIHRoZSBkYXNoYm9hcmQgY291bGQgcHJvYmFibHkganVzdCBiZSBwYXNzZWQgYXMgYSBwcm9wLlxuICAgICAgICBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL2Rhc2hib2FyZC8ke2Rhc2hib2FyZElkfWAsXG4gICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGFzaGJvYXJkID0gcmVzcG9uc2UuanNvbi5yZXN1bHQ7XG4gICAgICAgICAgICBjb25zdCBqc29uTWV0YWRhdGFPYmogPSBkYXNoYm9hcmQuanNvbl9tZXRhZGF0YT8ubGVuZ3RoXG4gICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKGRhc2hib2FyZC5qc29uX21ldGFkYXRhKVxuICAgICAgICAgICAgICAgIDoge307XG4gICAgICAgICAgICBoYW5kbGVEYXNoYm9hcmREYXRhKHtcbiAgICAgICAgICAgICAgICAuLi5kYXNoYm9hcmQsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IGpzb25NZXRhZGF0YU9iaixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfSwgaGFuZGxlRXJyb3JSZXNwb25zZSk7XG4gICAgfSwgW2Rhc2hib2FyZElkLCBoYW5kbGVEYXNoYm9hcmREYXRhXSk7XG4gICAgY29uc3QgZ2V0SnNvbk1ldGFkYXRhID0gKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QganNvbk1ldGFkYXRhT2JqID0ganNvbk1ldGFkYXRhPy5sZW5ndGhcbiAgICAgICAgICAgICAgICA/IEpTT04ucGFyc2UoanNvbk1ldGFkYXRhKVxuICAgICAgICAgICAgICAgIDoge307XG4gICAgICAgICAgICByZXR1cm4ganNvbk1ldGFkYXRhT2JqO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChfKSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZU9uQ2hhbmdlT3duZXJzID0gKG93bmVycykgPT4ge1xuICAgICAgICBjb25zdCBwYXJzZWRPd25lcnMgPSBlbnN1cmVJc0FycmF5KG93bmVycykubWFwKG8gPT4gKHtcbiAgICAgICAgICAgIGlkOiBvLnZhbHVlLFxuICAgICAgICAgICAgZnVsbF9uYW1lOiBvLmxhYmVsLFxuICAgICAgICB9KSk7XG4gICAgICAgIHNldE93bmVycyhwYXJzZWRPd25lcnMpO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlT25DaGFuZ2VSb2xlcyA9IChyb2xlcykgPT4ge1xuICAgICAgICBjb25zdCBwYXJzZWRSb2xlcyA9IGVuc3VyZUlzQXJyYXkocm9sZXMpLm1hcChyID0+ICh7XG4gICAgICAgICAgICBpZDogci52YWx1ZSxcbiAgICAgICAgICAgIG5hbWU6IHIubGFiZWwsXG4gICAgICAgIH0pKTtcbiAgICAgICAgc2V0Um9sZXMocGFyc2VkUm9sZXMpO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlT3duZXJzU2VsZWN0VmFsdWUgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhcnNlZE93bmVycyA9IChvd25lcnMgfHwgW10pLm1hcCgob3duZXIpID0+ICh7XG4gICAgICAgICAgICB2YWx1ZTogb3duZXIuaWQsXG4gICAgICAgICAgICBsYWJlbDogZ2V0T3duZXJOYW1lKG93bmVyKSxcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gcGFyc2VkT3duZXJzO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlUm9sZXNTZWxlY3RWYWx1ZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkUm9sZXMgPSAocm9sZXMgfHwgW10pLm1hcCgocm9sZSkgPT4gKHtcbiAgICAgICAgICAgIHZhbHVlOiByb2xlLmlkLFxuICAgICAgICAgICAgbGFiZWw6IGAke3JvbGUubmFtZX1gLFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBwYXJzZWRSb2xlcztcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZU9uQ2FuY2VsID0gKCkgPT4gb25IaWRlKCk7XG4gICAgY29uc3Qgb25Db2xvclNjaGVtZUNoYW5nZSA9IChjb2xvclNjaGVtZSA9ICcnLCB7IHVwZGF0ZU1ldGFkYXRhID0gdHJ1ZSB9ID0ge30pID0+IHtcbiAgICAgICAgLy8gY2hlY2sgdGhhdCBjb2xvcl9zY2hlbWUgaXMgdmFsaWRcbiAgICAgICAgY29uc3QgY29sb3JDaG9pY2VzID0gY2F0ZWdvcmljYWxTY2hlbWVSZWdpc3RyeS5rZXlzKCk7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICAvLyBvbmx5IGZpcmUgaWYgdGhlIGNvbG9yX3NjaGVtZSBpcyBwcmVzZW50IGFuZCBpbnZhbGlkXG4gICAgICAgIGlmIChjb2xvclNjaGVtZSAmJiAhY29sb3JDaG9pY2VzLmluY2x1ZGVzKGNvbG9yU2NoZW1lKSkge1xuICAgICAgICAgICAgTW9kYWwuZXJyb3Ioe1xuICAgICAgICAgICAgICAgIHRpdGxlOiB0KCdFcnJvcicpLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHQoJ0EgdmFsaWQgY29sb3Igc2NoZW1lIGlzIHJlcXVpcmVkJyksXG4gICAgICAgICAgICAgICAgb2tCdXR0b25Qcm9wczogeyBkYW5nZXI6IHRydWUsIGNsYXNzTmFtZTogJ2J0bi1kYW5nZXInIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG9uSGlkZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBIHZhbGlkIGNvbG9yIHNjaGVtZSBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGpzb25NZXRhZGF0YU9iai5jb2xvcl9zY2hlbWUgPSBjb2xvclNjaGVtZTtcbiAgICAgICAganNvbk1ldGFkYXRhT2JqLmxhYmVsX2NvbG9ycyA9IGpzb25NZXRhZGF0YU9iai5sYWJlbF9jb2xvcnMgfHwge307XG4gICAgICAgIHNldEN1cnJlbnRDb2xvclNjaGVtZShjb2xvclNjaGVtZSk7XG4gICAgICAgIGRpc3BhdGNoKHNldENvbG9yU2NoZW1lKGNvbG9yU2NoZW1lKSk7XG4gICAgICAgIC8vIHVwZGF0ZSBtZXRhZGF0YSB0byBtYXRjaCBzZWxlY3Rpb25cbiAgICAgICAgaWYgKHVwZGF0ZU1ldGFkYXRhKSB7XG4gICAgICAgICAgICBzZXRKc29uTWV0YWRhdGEoanNvblN0cmluZ2lmeShqc29uTWV0YWRhdGFPYmopKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgb25GaW5pc2ggPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGl0bGUsIHNsdWcsIGNlcnRpZmllZEJ5LCBjZXJ0aWZpY2F0aW9uRGV0YWlscyB9ID0gZm9ybS5nZXRGaWVsZHNWYWx1ZSgpO1xuICAgICAgICBsZXQgY3VycmVudEpzb25NZXRhZGF0YSA9IGpzb25NZXRhZGF0YTtcbiAgICAgICAgLy8gdmFsaWRhdGUgY3VycmVudEpzb25NZXRhZGF0YVxuICAgICAgICBsZXQgbWV0YWRhdGE7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRKc29uTWV0YWRhdGEuc3RhcnRzV2l0aCgneycpIHx8XG4gICAgICAgICAgICAgICAgIWN1cnJlbnRKc29uTWV0YWRhdGEuZW5kc1dpdGgoJ30nKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWV0YWRhdGEgPSBKU09OLnBhcnNlKGN1cnJlbnRKc29uTWV0YWRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgYWRkRGFuZ2VyVG9hc3QodCgnSlNPTiBtZXRhZGF0YSBpcyBpbnZhbGlkIScpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb2xvck5hbWVzcGFjZSA9IGdldENvbG9yTmFtZXNwYWNlKG1ldGFkYXRhPy5jb2xvcl9uYW1lc3BhY2UpO1xuICAgICAgICAvLyBjb2xvciBzY2hlbWUgaW4ganNvbiBtZXRhZGF0YSBoYXMgcHJlY2VkZW5jZSBvdmVyIHNlbGVjdGlvblxuICAgICAgICBjb25zdCB1cGRhdGVkQ29sb3JTY2hlbWUgPSBtZXRhZGF0YT8uY29sb3Jfc2NoZW1lIHx8IGNvbG9yU2NoZW1lO1xuICAgICAgICBjb25zdCBzaG91bGRHb0ZyZXNoID0gdXBkYXRlZENvbG9yU2NoZW1lICE9PSBvcmlnaW5hbERhc2hib2FyZE1ldGFkYXRhLmN1cnJlbnQuY29sb3Jfc2NoZW1lO1xuICAgICAgICBjb25zdCBzaG91bGRSZXNldEN1c3RvbUxhYmVscyA9ICFhcmVPYmplY3RzRXF1YWwob3JpZ2luYWxEYXNoYm9hcmRNZXRhZGF0YS5jdXJyZW50LmxhYmVsX2NvbG9ycyB8fCB7fSwgbWV0YWRhdGE/LmxhYmVsX2NvbG9ycyB8fCB7fSk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRDdXN0b21MYWJlbHMgPSBPYmplY3Qua2V5cyhtZXRhZGF0YT8ubGFiZWxfY29sb3JzIHx8IHt9KTtcbiAgICAgICAgY29uc3QgcHJldkN1c3RvbUxhYmVscyA9IE9iamVjdC5rZXlzKG9yaWdpbmFsRGFzaGJvYXJkTWV0YWRhdGEuY3VycmVudC5sYWJlbF9jb2xvcnMgfHwge30pO1xuICAgICAgICBjb25zdCByZXNldHRhYmxlQ3VzdG9tTGFiZWxzID0gY3VycmVudEN1c3RvbUxhYmVscy5sZW5ndGggPiAwID8gY3VycmVudEN1c3RvbUxhYmVscyA6IHByZXZDdXN0b21MYWJlbHM7XG4gICAgICAgIGNvbnN0IGZyZXNoQ3VzdG9tTGFiZWxzID0gc2hvdWxkUmVzZXRDdXN0b21MYWJlbHMgJiYgcmVzZXR0YWJsZUN1c3RvbUxhYmVscy5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IHJlc2V0dGFibGVDdXN0b21MYWJlbHNcbiAgICAgICAgICAgIDogZmFsc2U7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICBjb25zdCBjdXN0b21MYWJlbENvbG9ycyA9IGpzb25NZXRhZGF0YU9iai5sYWJlbF9jb2xvcnMgfHwge307XG4gICAgICAgIGNvbnN0IHVwZGF0ZWREYXNoYm9hcmRNZXRhZGF0YSA9IHtcbiAgICAgICAgICAgIC4uLm9yaWdpbmFsRGFzaGJvYXJkTWV0YWRhdGEuY3VycmVudCxcbiAgICAgICAgICAgIGxhYmVsX2NvbG9yczogY3VzdG9tTGFiZWxDb2xvcnMsXG4gICAgICAgICAgICBjb2xvcl9zY2hlbWU6IHVwZGF0ZWRDb2xvclNjaGVtZSxcbiAgICAgICAgfTtcbiAgICAgICAgb3JpZ2luYWxEYXNoYm9hcmRNZXRhZGF0YS5jdXJyZW50ID0gdXBkYXRlZERhc2hib2FyZE1ldGFkYXRhO1xuICAgICAgICBhcHBseUNvbG9ycyh1cGRhdGVkRGFzaGJvYXJkTWV0YWRhdGEsIHNob3VsZEdvRnJlc2ggfHwgZnJlc2hDdXN0b21MYWJlbHMpO1xuICAgICAgICBkaXNwYXRjaChzZXREYXNoYm9hcmRNZXRhZGF0YSh7XG4gICAgICAgICAgICAuLi51cGRhdGVkRGFzaGJvYXJkTWV0YWRhdGEsXG4gICAgICAgICAgICBtYXBfbGFiZWxfY29sb3JzOiBnZXRGcmVzaExhYmVsc0NvbG9yTWFwRW50cmllcyhjdXN0b21MYWJlbENvbG9ycyksXG4gICAgICAgIH0pKTtcbiAgICAgICAgb25Db2xvclNjaGVtZUNoYW5nZSh1cGRhdGVkQ29sb3JTY2hlbWUsIHtcbiAgICAgICAgICAgIHVwZGF0ZU1ldGFkYXRhOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGN1cnJlbnRKc29uTWV0YWRhdGEgPSBqc29uU3RyaW5naWZ5KG1ldGFkYXRhKTtcbiAgICAgICAgY29uc3QgbW9yZU9uU3VibWl0UHJvcHMgPSB7fTtcbiAgICAgICAgY29uc3QgbW9yZVB1dFByb3BzID0ge307XG4gICAgICAgIGlmIChpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkRhc2hib2FyZFJiYWMpKSB7XG4gICAgICAgICAgICBtb3JlT25TdWJtaXRQcm9wcy5yb2xlcyA9IHJvbGVzO1xuICAgICAgICAgICAgbW9yZVB1dFByb3BzLnJvbGVzID0gKHJvbGVzIHx8IFtdKS5tYXAociA9PiByLmlkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5UYWdnaW5nU3lzdGVtKSkge1xuICAgICAgICAgICAgbW9yZVB1dFByb3BzLnRhZ3MgPSB0YWdzLm1hcCh0YWcgPT4gdGFnLmlkKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBvblN1Ym1pdFByb3BzID0ge1xuICAgICAgICAgICAgaWQ6IGRhc2hib2FyZElkLFxuICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICBzbHVnLFxuICAgICAgICAgICAganNvbk1ldGFkYXRhOiBjdXJyZW50SnNvbk1ldGFkYXRhLFxuICAgICAgICAgICAgb3duZXJzLFxuICAgICAgICAgICAgY29sb3JTY2hlbWU6IGN1cnJlbnRDb2xvclNjaGVtZSxcbiAgICAgICAgICAgIGNvbG9yTmFtZXNwYWNlLFxuICAgICAgICAgICAgY2VydGlmaWVkQnksXG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uRGV0YWlscyxcbiAgICAgICAgICAgIC4uLm1vcmVPblN1Ym1pdFByb3BzLFxuICAgICAgICB9O1xuICAgICAgICBpZiAob25seUFwcGx5KSB7XG4gICAgICAgICAgICBvblN1Ym1pdChvblN1Ym1pdFByb3BzKTtcbiAgICAgICAgICAgIG9uSGlkZSgpO1xuICAgICAgICAgICAgYWRkU3VjY2Vzc1RvYXN0KHQoJ0Rhc2hib2FyZCBwcm9wZXJ0aWVzIHVwZGF0ZWQnKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBTdXBlcnNldENsaWVudC5wdXQoe1xuICAgICAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXNoYm9hcmQvJHtkYXNoYm9hcmRJZH1gLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgZGFzaGJvYXJkX3RpdGxlOiB0aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgc2x1Zzogc2x1ZyB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBqc29uX21ldGFkYXRhOiBjdXJyZW50SnNvbk1ldGFkYXRhIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG93bmVyczogKG93bmVycyB8fCBbXSkubWFwKG8gPT4gby5pZCksXG4gICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZF9ieTogY2VydGlmaWVkQnkgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpZWRCeSAmJiBjZXJ0aWZpY2F0aW9uRGV0YWlscyA/IGNlcnRpZmljYXRpb25EZXRhaWxzIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgLi4ubW9yZVB1dFByb3BzLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgb25TdWJtaXQob25TdWJtaXRQcm9wcyk7XG4gICAgICAgICAgICAgICAgb25IaWRlKCk7XG4gICAgICAgICAgICAgICAgYWRkU3VjY2Vzc1RvYXN0KHQoJ1RoZSBkYXNoYm9hcmQgaGFzIGJlZW4gc2F2ZWQnKSk7XG4gICAgICAgICAgICB9LCBoYW5kbGVFcnJvclJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgZ2V0Um93c1dpdGhvdXRSb2xlcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3QganNvbk1ldGFkYXRhT2JqID0gZ2V0SnNvbk1ldGFkYXRhKCk7XG4gICAgICAgIGNvbnN0IGhhc0N1c3RvbUxhYmVsc0NvbG9yID0gISFPYmplY3Qua2V5cyhqc29uTWV0YWRhdGFPYmo/LmxhYmVsX2NvbG9ycyB8fCB7fSkubGVuZ3RoO1xuICAgICAgICByZXR1cm4gKDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgIDxoMyBzdHlsZT17eyBtYXJnaW5Ub3A6ICcxZW0nIH19Pnt0KCdBY2Nlc3MnKX08L2gzPlxuICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnT3duZXJzJyl9PlxuICAgICAgICAgICAgPEFzeW5jU2VsZWN0IGFsbG93Q2xlYXIgYXJpYUxhYmVsPXt0KCdPd25lcnMnKX0gZGlzYWJsZWQ9e2lzTG9hZGluZ30gbW9kZT1cIm11bHRpcGxlXCIgb25DaGFuZ2U9e2hhbmRsZU9uQ2hhbmdlT3duZXJzfSBvcHRpb25zPXsoaW5wdXQsIHBhZ2UsIHBhZ2VTaXplKSA9PiBsb2FkQWNjZXNzT3B0aW9ucygnb3duZXJzJywgaW5wdXQsIHBhZ2UsIHBhZ2VTaXplKX0gdmFsdWU9e2hhbmRsZU93bmVyc1NlbGVjdFZhbHVlKCl9Lz5cbiAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgIHt0KCdPd25lcnMgaXMgYSBsaXN0IG9mIHVzZXJzIHdobyBjYW4gYWx0ZXIgdGhlIGRhc2hib2FyZC4gU2VhcmNoYWJsZSBieSBuYW1lIG9yIHVzZXJuYW1lLicpfVxuICAgICAgICAgIDwvcD5cbiAgICAgICAgPC9Db2w+XG4gICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgIDxoMyBzdHlsZT17eyBtYXJnaW5Ub3A6ICcxZW0nIH19Pnt0KCdDb2xvcnMnKX08L2gzPlxuICAgICAgICAgIDxDb2xvclNjaGVtZUNvbnRyb2xXcmFwcGVyIGhhc0N1c3RvbUxhYmVsc0NvbG9yPXtoYXNDdXN0b21MYWJlbHNDb2xvcn0gb25DaGFuZ2U9e29uQ29sb3JTY2hlbWVDaGFuZ2V9IGNvbG9yU2NoZW1lPXtjb2xvclNjaGVtZX0vPlxuICAgICAgICA8L0NvbD5cbiAgICAgIDwvUm93Pik7XG4gICAgfTtcbiAgICBjb25zdCBnZXRSb3dzV2l0aFJvbGVzID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBqc29uTWV0YWRhdGFPYmogPSBnZXRKc29uTWV0YWRhdGEoKTtcbiAgICAgICAgY29uc3QgaGFzQ3VzdG9tTGFiZWxzQ29sb3IgPSAhIU9iamVjdC5rZXlzKGpzb25NZXRhZGF0YU9iaj8ubGFiZWxfY29sb3JzIHx8IHt9KS5sZW5ndGg7XG4gICAgICAgIHJldHVybiAoPD5cbiAgICAgICAgPFJvdz5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezI0fT5cbiAgICAgICAgICAgIDxoMyBzdHlsZT17eyBtYXJnaW5Ub3A6ICcxZW0nIH19Pnt0KCdBY2Nlc3MnKX08L2gzPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgICAgPFJvdyBndXR0ZXI9ezE2fT5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnT3duZXJzJyl9PlxuICAgICAgICAgICAgICA8QXN5bmNTZWxlY3QgYWxsb3dDbGVhciBhbGxvd05ld09wdGlvbnMgYXJpYUxhYmVsPXt0KCdPd25lcnMnKX0gZGlzYWJsZWQ9e2lzTG9hZGluZ30gbW9kZT1cIm11bHRpcGxlXCIgb25DaGFuZ2U9e2hhbmRsZU9uQ2hhbmdlT3duZXJzfSBvcHRpb25zPXsoaW5wdXQsIHBhZ2UsIHBhZ2VTaXplKSA9PiBsb2FkQWNjZXNzT3B0aW9ucygnb3duZXJzJywgaW5wdXQsIHBhZ2UsIHBhZ2VTaXplKX0gdmFsdWU9e2hhbmRsZU93bmVyc1NlbGVjdFZhbHVlKCl9Lz5cbiAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgIHt0KCdPd25lcnMgaXMgYSBsaXN0IG9mIHVzZXJzIHdobyBjYW4gYWx0ZXIgdGhlIGRhc2hib2FyZC4gU2VhcmNoYWJsZSBieSBuYW1lIG9yIHVzZXJuYW1lLicpfVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtIGxhYmVsPXt0KCdSb2xlcycpfT5cbiAgICAgICAgICAgICAgPEFzeW5jU2VsZWN0IGFsbG93Q2xlYXIgYXJpYUxhYmVsPXt0KCdSb2xlcycpfSBkaXNhYmxlZD17aXNMb2FkaW5nfSBtb2RlPVwibXVsdGlwbGVcIiBvbkNoYW5nZT17aGFuZGxlT25DaGFuZ2VSb2xlc30gb3B0aW9ucz17KGlucHV0LCBwYWdlLCBwYWdlU2l6ZSkgPT4gbG9hZEFjY2Vzc09wdGlvbnMoJ3JvbGVzJywgaW5wdXQsIHBhZ2UsIHBhZ2VTaXplKX0gdmFsdWU9e2hhbmRsZVJvbGVzU2VsZWN0VmFsdWUoKX0vPlxuICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAge3QoJ1JvbGVzIGlzIGEgbGlzdCB3aGljaCBkZWZpbmVzIGFjY2VzcyB0byB0aGUgZGFzaGJvYXJkLiBHcmFudGluZyBhIHJvbGUgYWNjZXNzIHRvIGEgZGFzaGJvYXJkIHdpbGwgYnlwYXNzIGRhdGFzZXQgbGV2ZWwgY2hlY2tzLiBJZiBubyByb2xlcyBhcmUgZGVmaW5lZCwgcmVndWxhciBhY2Nlc3MgcGVybWlzc2lvbnMgYXBwbHkuJyl9XG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgICA8Um93PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPENvbG9yU2NoZW1lQ29udHJvbFdyYXBwZXIgaGFzQ3VzdG9tTGFiZWxzQ29sb3I9e2hhc0N1c3RvbUxhYmVsc0NvbG9yfSBvbkNoYW5nZT17b25Db2xvclNjaGVtZUNoYW5nZX0gY29sb3JTY2hlbWU9e2NvbG9yU2NoZW1lfS8+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgPC8+KTtcbiAgICB9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChzaG93KSB7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnREYXNoYm9hcmRJbmZvKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2hEYXNoYm9hcmREZXRhaWxzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVEYXNoYm9hcmREYXRhKGN1cnJlbnREYXNoYm9hcmRJbmZvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBKc29uRWRpdG9yLnByZWxvYWQoKTtcbiAgICB9LCBbY3VycmVudERhc2hib2FyZEluZm8sIGZldGNoRGFzaGJvYXJkRGV0YWlscywgaGFuZGxlRGFzaGJvYXJkRGF0YSwgc2hvd10pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIHRoZSB0aXRsZSBjYW4gYmUgY2hhbmdlZCBpbmxpbmUgaW4gdGhlIGRhc2hib2FyZCwgdGhpcyBjYXRjaGVzIGl0XG4gICAgICAgIGlmIChkYXNoYm9hcmRUaXRsZSAmJlxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mbyAmJlxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mby50aXRsZSAhPT0gZGFzaGJvYXJkVGl0bGUpIHtcbiAgICAgICAgICAgIGZvcm0uc2V0RmllbGRzVmFsdWUoe1xuICAgICAgICAgICAgICAgIC4uLmRhc2hib2FyZEluZm8sXG4gICAgICAgICAgICAgICAgdGl0bGU6IGRhc2hib2FyZFRpdGxlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCBbZGFzaGJvYXJkSW5mbywgZGFzaGJvYXJkVGl0bGUsIGZvcm1dKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIWlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmZXRjaFRhZ3Moe1xuICAgICAgICAgICAgICAgIG9iamVjdFR5cGU6IE9CSkVDVF9UWVBFUy5EQVNIQk9BUkQsXG4gICAgICAgICAgICAgICAgb2JqZWN0SWQ6IGRhc2hib2FyZElkLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVUeXBlczogZmFsc2UsXG4gICAgICAgICAgICB9LCAodGFncykgPT4gc2V0VGFncyh0YWdzKSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgYWRkRGFuZ2VyVG9hc3QoYEVycm9yIGZldGNoaW5nIHRhZ3M6ICR7ZXJyb3IudGV4dH1gKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaGFuZGxlRXJyb3JSZXNwb25zZShlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LCBbZGFzaGJvYXJkSWRdKTtcbiAgICBjb25zdCBoYW5kbGVDaGFuZ2VUYWdzID0gKHRhZ3MpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkVGFncyA9IGVuc3VyZUlzQXJyYXkodGFncykubWFwKHIgPT4gKHtcbiAgICAgICAgICAgIGlkOiByLnZhbHVlLFxuICAgICAgICAgICAgbmFtZTogci5sYWJlbCxcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRUYWdzKHBhcnNlZFRhZ3MpO1xuICAgIH07XG4gICAgcmV0dXJuICg8TW9kYWwgc2hvdz17c2hvd30gb25IaWRlPXtoYW5kbGVPbkNhbmNlbH0gdGl0bGU9e3QoJ0Rhc2hib2FyZCBwcm9wZXJ0aWVzJyl9IGZvb3Rlcj17PD5cbiAgICAgICAgICA8QnV0dG9uIGh0bWxUeXBlPVwiYnV0dG9uXCIgYnV0dG9uU2l6ZT1cInNtYWxsXCIgb25DbGljaz17aGFuZGxlT25DYW5jZWx9IGRhdGEtdGVzdD1cInByb3BlcnRpZXMtbW9kYWwtY2FuY2VsLWJ1dHRvblwiIGN0YT5cbiAgICAgICAgICAgIHt0KCdDYW5jZWwnKX1cbiAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8QnV0dG9uIGRhdGEtdGVzdD1cInByb3BlcnRpZXMtbW9kYWwtYXBwbHktYnV0dG9uXCIgb25DbGljaz17Zm9ybS5zdWJtaXR9IGJ1dHRvblNpemU9XCJzbWFsbFwiIGJ1dHRvblN0eWxlPVwicHJpbWFyeVwiIGNsYXNzTmFtZT1cIm0tci01XCIgY3RhIGRpc2FibGVkPXtkYXNoYm9hcmRJbmZvPy5pc01hbmFnZWRFeHRlcm5hbGx5fSB0b29sdGlwPXtkYXNoYm9hcmRJbmZvPy5pc01hbmFnZWRFeHRlcm5hbGx5XG4gICAgICAgICAgICAgICAgPyB0KFwiVGhpcyBkYXNoYm9hcmQgaXMgbWFuYWdlZCBleHRlcm5hbGx5LCBhbmQgY2FuJ3QgYmUgZWRpdGVkIGluIFN1cGVyc2V0XCIpXG4gICAgICAgICAgICAgICAgOiAnJ30+XG4gICAgICAgICAgICB7c2F2ZUxhYmVsfVxuICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICA8Lz59IHJlc3BvbnNpdmU+XG4gICAgICA8QW50ZEZvcm0gZm9ybT17Zm9ybX0gb25GaW5pc2g9e29uRmluaXNofSBkYXRhLXRlc3Q9XCJkYXNoYm9hcmQtZWRpdC1wcm9wZXJ0aWVzLWZvcm1cIiBsYXlvdXQ9XCJ2ZXJ0aWNhbFwiIGluaXRpYWxWYWx1ZXM9e2Rhc2hib2FyZEluZm99PlxuICAgICAgICA8Um93PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MjR9PlxuICAgICAgICAgICAgPGgzPnt0KCdCYXNpYyBpbmZvcm1hdGlvbicpfTwvaDM+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPEZvcm1JdGVtIGxhYmVsPXt0KCdOYW1lJyl9IG5hbWU9XCJ0aXRsZVwiPlxuICAgICAgICAgICAgICA8SW5wdXQgZGF0YS10ZXN0PVwiZGFzaGJvYXJkLXRpdGxlLWlucHV0XCIgdHlwZT1cInRleHRcIiBkaXNhYmxlZD17aXNMb2FkaW5nfS8+XG4gICAgICAgICAgICA8L0Zvcm1JdGVtPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtIGxhYmVsPXt0KCdVUkwgc2x1ZycpfSBuYW1lPVwic2x1Z1wiPlxuICAgICAgICAgICAgICA8SW5wdXQgdHlwZT1cInRleHRcIiBkaXNhYmxlZD17aXNMb2FkaW5nfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnQSByZWFkYWJsZSBVUkwgZm9yIHlvdXIgZGFzaGJvYXJkJyl9XG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5EYXNoYm9hcmRSYmFjKVxuICAgICAgICAgICAgPyBnZXRSb3dzV2l0aFJvbGVzKClcbiAgICAgICAgICAgIDogZ2V0Um93c1dpdGhvdXRSb2xlcygpfVxuICAgICAgICA8Um93PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MjR9PlxuICAgICAgICAgICAgPGgzPnt0KCdDZXJ0aWZpY2F0aW9uJyl9PC9oMz5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ0NlcnRpZmllZCBieScpfSBuYW1lPVwiY2VydGlmaWVkQnlcIj5cbiAgICAgICAgICAgICAgPElucHV0IHR5cGU9XCJ0ZXh0XCIgZGlzYWJsZWQ9e2lzTG9hZGluZ30vPlxuICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAge3QoJ1BlcnNvbiBvciBncm91cCB0aGF0IGhhcyBjZXJ0aWZpZWQgdGhpcyBkYXNoYm9hcmQuJyl9XG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfSBuYW1lPVwiY2VydGlmaWNhdGlvbkRldGFpbHNcIj5cbiAgICAgICAgICAgICAgPElucHV0IHR5cGU9XCJ0ZXh0XCIgZGlzYWJsZWQ9e2lzTG9hZGluZ30vPlxuICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAge3QoJ0FueSBhZGRpdGlvbmFsIGRldGFpbCB0byBzaG93IGluIHRoZSBjZXJ0aWZpY2F0aW9uIHRvb2x0aXAuJyl9XG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5UYWdnaW5nU3lzdGVtKSA/ICg8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgIDxoMyBjc3M9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnVGFncycpfTwvaDM+XG4gICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICA8L1Jvdz4pIDogbnVsbH1cbiAgICAgICAge2lzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkgPyAoPFJvdyBndXR0ZXI9ezE2fT5cbiAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICAgICAgPEFzeW5jU2VsZWN0IGFyaWFMYWJlbD1cIlRhZ3NcIiBtb2RlPVwibXVsdGlwbGVcIiB2YWx1ZT17dGFnc0FzU2VsZWN0VmFsdWVzfSBvcHRpb25zPXtsb2FkVGFnc30gb25DaGFuZ2U9e2hhbmRsZUNoYW5nZVRhZ3N9IGFsbG93Q2xlYXIvPlxuICAgICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgICAge3QoJ0EgbGlzdCBvZiB0YWdzIHRoYXQgaGF2ZSBiZWVuIGFwcGxpZWQgdG8gdGhpcyBjaGFydC4nKX1cbiAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgPC9Sb3c+KSA6IG51bGx9XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsyNH0+XG4gICAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT5cbiAgICAgICAgICAgICAgPEJ1dHRvbiBidXR0b25TdHlsZT1cImxpbmtcIiBvbkNsaWNrPXsoKSA9PiBzZXRJc0FkdmFuY2VkT3BlbighaXNBZHZhbmNlZE9wZW4pfSBjc3M9e2NzcyBgXG4gICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICAgICAgICAgIGB9PlxuICAgICAgICAgICAgICAgIHsvKiBUT0RPOiBSZW1vdmUgZmEtaWNvbiAqL31cbiAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9e2BmYSBmYS1hbmdsZS0ke2lzQWR2YW5jZWRPcGVuID8gJ2Rvd24nIDogJ3JpZ2h0J31gfSBzdHlsZT17eyBtaW5XaWR0aDogJzFlbScgfX0vPlxuICAgICAgICAgICAgICAgIHt0KCdBZHZhbmNlZCcpfVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDwvaDM+XG4gICAgICAgICAgICB7aXNBZHZhbmNlZE9wZW4gJiYgKDw+XG4gICAgICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtIGxhYmVsPXt0KCdKU09OIG1ldGFkYXRhJyl9PlxuICAgICAgICAgICAgICAgICAgPFN0eWxlZEpzb25FZGl0b3Igc2hvd0xvYWRpbmdGb3JJbXBvcnQgbmFtZT1cImpzb25fbWV0YWRhdGFcIiB2YWx1ZT17anNvbk1ldGFkYXRhfSBvbkNoYW5nZT17c2V0SnNvbk1ldGFkYXRhfSB0YWJTaXplPXsyfSB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIyMDBweFwiIHdyYXBFbmFibGVkLz5cbiAgICAgICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICAgIHt0KCdUaGlzIEpTT04gb2JqZWN0IGlzIGdlbmVyYXRlZCBkeW5hbWljYWxseSB3aGVuIGNsaWNraW5nIHRoZSBzYXZlIG9yIG92ZXJ3cml0ZSBidXR0b24gaW4gdGhlIGRhc2hib2FyZCB2aWV3LiBJdCBpcyBleHBvc2VkIGhlcmUgZm9yIHJlZmVyZW5jZSBhbmQgZm9yIHBvd2VyIHVzZXJzIHdobyBtYXkgd2FudCB0byBhbHRlciBzcGVjaWZpYyBwYXJhbWV0ZXJzLicpfVxuICAgICAgICAgICAgICAgICAge29ubHlBcHBseSAmJiAoPD5cbiAgICAgICAgICAgICAgICAgICAgICB7JyAnfVxuICAgICAgICAgICAgICAgICAgICAgIHt0KCdQbGVhc2UgRE8gTk9UIG92ZXJ3cml0ZSB0aGUgXCJmaWx0ZXJfc2NvcGVzXCIga2V5LicpfXsnICd9XG4gICAgICAgICAgICAgICAgICAgICAgPEZpbHRlclNjb3BlTW9kYWwgdHJpZ2dlck5vZGU9ezxzcGFuIGNsYXNzTmFtZT1cImFsZXJ0LWxpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dCgnVXNlIFwiJShtZW51TmFtZSlzXCIgbWVudSBpbnN0ZWFkLicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnVOYW1lOiB0KCdTZXQgZmlsdGVyIG1hcHBpbmcnKSxcbiAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj59Lz5cbiAgICAgICAgICAgICAgICAgICAgPC8+KX1cbiAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgIDwvPil9XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgPC9BbnRkRm9ybT5cbiAgICA8L01vZGFsPik7XG59O1xuZXhwb3J0IGRlZmF1bHQgd2l0aFRvYXN0cyhQcm9wZXJ0aWVzTW9kYWwpO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst PropertiesModal = ({ addSuccessToast, addDangerToast, colorScheme: currentColorScheme, dashboardId, dashboardInfo: currentDashboardInfo, dashboardTitle, onHide = () => {}, onlyApply = false, onSubmit = () => {}, show = false }) => {\n  const dispatch = useDispatch();\n  const [form] = AntdForm.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false);\n  const [colorScheme, setCurrentColorScheme] = useState(currentColorScheme);\n  const [jsonMetadata, setJsonMetadata] = useState('');\n  const [dashboardInfo, setDashboardInfo] = useState();\n  const [owners, setOwners] = useState([]);\n  const [roles, setRoles] = useState([]);\n  const saveLabel = onlyApply ? t('Apply') : t('Save');\n  const [tags, setTags] = useState([]);\n  const categoricalSchemeRegistry = getCategoricalSchemeRegistry();\n  const originalDashboardMetadata = useRef({});\n  const tagsAsSelectValues = useMemo(() => {\n    const selectTags = tags.map((tag) => ({\n      value: tag.id,\n      label: tag.name\n    }));\n    return selectTags;\n  }, [tags.length]);\n  const handleErrorResponse = async (response) => {\n    const { error, statusText, message } = await getClientErrorObject(response);\n    let errorText = error || statusText || t('An error has occurred');\n    if (typeof message === 'object' && 'json_metadata' in message) {\n      errorText = message.json_metadata;\n    } else\n    if (typeof message === 'string') {\n      errorText = message;\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n    }\n    Modal.error({\n      title: t('Error'),\n      content: errorText,\n      okButtonProps: { danger: true, className: 'btn-danger' }\n    });\n  };\n  const loadAccessOptions = useCallback((accessType = 'owners', input = '', page, pageSize) => {\n    const query = rison.encode({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dashboard/related/${accessType}?q=${query}`\n    }).then((response) => ({\n      data: response.json.result.\n      filter((item) => item.extra.active !== undefined ? item.extra.active : true).\n      map((item) => ({\n        value: item.value,\n        label: item.text\n      })),\n      totalCount: response.json.count\n    }));\n  }, []);\n  const handleDashboardData = useCallback((dashboardData) => {\n    const { id, dashboard_title, slug, certified_by, certification_details, owners, roles, metadata, is_managed_externally } = dashboardData;\n    const dashboardInfo = {\n      id,\n      title: dashboard_title,\n      slug: slug || '',\n      certifiedBy: certified_by || '',\n      certificationDetails: certification_details || '',\n      isManagedExternally: is_managed_externally || false,\n      metadata\n    };\n    form.setFieldsValue(dashboardInfo);\n    setDashboardInfo(dashboardInfo);\n    setOwners(owners);\n    setRoles(roles);\n    setCurrentColorScheme(metadata.color_scheme);\n    const metaDataCopy = _omit(metadata, [\n    'positions',\n    'shared_label_colors',\n    'map_label_colors',\n    'color_scheme_domain']\n    );\n    setJsonMetadata(metaDataCopy ? jsonStringify(metaDataCopy) : '');\n    originalDashboardMetadata.current = metadata;\n  }, [form]);\n  const fetchDashboardDetails = useCallback(() => {\n    setIsLoading(true);\n    // We fetch the dashboard details because not all code\n    // that renders this component have all the values we need.\n    // At some point when we have a more consistent frontend\n    // datamodel, the dashboard could probably just be passed as a prop.\n    SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${dashboardId}`\n    }).then((response) => {var _dashboard$json_metad;\n      const dashboard = response.json.result;\n      const jsonMetadataObj = (_dashboard$json_metad = dashboard.json_metadata) != null && _dashboard$json_metad.length ?\n      JSON.parse(dashboard.json_metadata) :\n      {};\n      handleDashboardData({\n        ...dashboard,\n        metadata: jsonMetadataObj\n      });\n      setIsLoading(false);\n    }, handleErrorResponse);\n  }, [dashboardId, handleDashboardData]);\n  const getJsonMetadata = () => {\n    try {\n      const jsonMetadataObj = jsonMetadata != null && jsonMetadata.length ?\n      JSON.parse(jsonMetadata) :\n      {};\n      return jsonMetadataObj;\n    }\n    catch (_) {\n      return {};\n    }\n  };\n  const handleOnChangeOwners = (owners) => {\n    const parsedOwners = ensureIsArray(owners).map((o) => ({\n      id: o.value,\n      full_name: o.label\n    }));\n    setOwners(parsedOwners);\n  };\n  const handleOnChangeRoles = (roles) => {\n    const parsedRoles = ensureIsArray(roles).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setRoles(parsedRoles);\n  };\n  const handleOwnersSelectValue = () => {\n    const parsedOwners = (owners || []).map((owner) => ({\n      value: owner.id,\n      label: getOwnerName(owner)\n    }));\n    return parsedOwners;\n  };\n  const handleRolesSelectValue = () => {\n    const parsedRoles = (roles || []).map((role) => ({\n      value: role.id,\n      label: `${role.name}`\n    }));\n    return parsedRoles;\n  };\n  const handleOnCancel = () => onHide();\n  const onColorSchemeChange = (colorScheme = '', { updateMetadata = true } = {}) => {\n    // check that color_scheme is valid\n    const colorChoices = categoricalSchemeRegistry.keys();\n    const jsonMetadataObj = getJsonMetadata();\n    // only fire if the color_scheme is present and invalid\n    if (colorScheme && !colorChoices.includes(colorScheme)) {\n      Modal.error({\n        title: t('Error'),\n        content: t('A valid color scheme is required'),\n        okButtonProps: { danger: true, className: 'btn-danger' }\n      });\n      onHide();\n      throw new Error('A valid color scheme is required');\n    }\n    jsonMetadataObj.color_scheme = colorScheme;\n    jsonMetadataObj.label_colors = jsonMetadataObj.label_colors || {};\n    setCurrentColorScheme(colorScheme);\n    dispatch(setColorScheme(colorScheme));\n    // update metadata to match selection\n    if (updateMetadata) {\n      setJsonMetadata(jsonStringify(jsonMetadataObj));\n    }\n  };\n  const onFinish = () => {var _metadata, _metadata2, _metadata3, _metadata4;\n    const { title, slug, certifiedBy, certificationDetails } = form.getFieldsValue();\n    let currentJsonMetadata = jsonMetadata;\n    // validate currentJsonMetadata\n    let metadata;\n    try {\n      if (!currentJsonMetadata.startsWith('{') ||\n      !currentJsonMetadata.endsWith('}')) {\n        throw new Error();\n      }\n      metadata = JSON.parse(currentJsonMetadata);\n    }\n    catch (error) {\n      addDangerToast(t('JSON metadata is invalid!'));\n      return;\n    }\n    const colorNamespace = getColorNamespace((_metadata = metadata) == null ? void 0 : _metadata.color_namespace);\n    // color scheme in json metadata has precedence over selection\n    const updatedColorScheme = ((_metadata2 = metadata) == null ? void 0 : _metadata2.color_scheme) || colorScheme;\n    const shouldGoFresh = updatedColorScheme !== originalDashboardMetadata.current.color_scheme;\n    const shouldResetCustomLabels = !areObjectsEqual(originalDashboardMetadata.current.label_colors || {}, ((_metadata3 = metadata) == null ? void 0 : _metadata3.label_colors) || {});\n    const currentCustomLabels = Object.keys(((_metadata4 = metadata) == null ? void 0 : _metadata4.label_colors) || {});\n    const prevCustomLabels = Object.keys(originalDashboardMetadata.current.label_colors || {});\n    const resettableCustomLabels = currentCustomLabels.length > 0 ? currentCustomLabels : prevCustomLabels;\n    const freshCustomLabels = shouldResetCustomLabels && resettableCustomLabels.length > 0 ?\n    resettableCustomLabels :\n    false;\n    const jsonMetadataObj = getJsonMetadata();\n    const customLabelColors = jsonMetadataObj.label_colors || {};\n    const updatedDashboardMetadata = {\n      ...originalDashboardMetadata.current,\n      label_colors: customLabelColors,\n      color_scheme: updatedColorScheme\n    };\n    originalDashboardMetadata.current = updatedDashboardMetadata;\n    applyColors(updatedDashboardMetadata, shouldGoFresh || freshCustomLabels);\n    dispatch(setDashboardMetadata({\n      ...updatedDashboardMetadata,\n      map_label_colors: getFreshLabelsColorMapEntries(customLabelColors)\n    }));\n    onColorSchemeChange(updatedColorScheme, {\n      updateMetadata: false\n    });\n    currentJsonMetadata = jsonStringify(metadata);\n    const moreOnSubmitProps = {};\n    const morePutProps = {};\n    if (isFeatureEnabled(FeatureFlag.DashboardRbac)) {\n      moreOnSubmitProps.roles = roles;\n      morePutProps.roles = (roles || []).map((r) => r.id);\n    }\n    if (isFeatureEnabled(FeatureFlag.TaggingSystem)) {\n      morePutProps.tags = tags.map((tag) => tag.id);\n    }\n    const onSubmitProps = {\n      id: dashboardId,\n      title,\n      slug,\n      jsonMetadata: currentJsonMetadata,\n      owners,\n      colorScheme: currentColorScheme,\n      colorNamespace,\n      certifiedBy,\n      certificationDetails,\n      ...moreOnSubmitProps\n    };\n    if (onlyApply) {\n      onSubmit(onSubmitProps);\n      onHide();\n      addSuccessToast(t('Dashboard properties updated'));\n    } else\n    {\n      SupersetClient.put({\n        endpoint: `/api/v1/dashboard/${dashboardId}`,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dashboard_title: title,\n          slug: slug || null,\n          json_metadata: currentJsonMetadata || null,\n          owners: (owners || []).map((o) => o.id),\n          certified_by: certifiedBy || null,\n          certification_details: certifiedBy && certificationDetails ? certificationDetails : null,\n          ...morePutProps\n        })\n      }).then(() => {\n        onSubmit(onSubmitProps);\n        onHide();\n        addSuccessToast(t('The dashboard has been saved'));\n      }, handleErrorResponse);\n    }\n  };\n  const getRowsWithoutRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return _jsxs(Row, { gutter: 16, children: [\n      _jsxs(Col, { xs: 24, md: 12, children: [\n        _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Access') }),\n        _jsx(StyledFormItem, { label: t('Owners'), children:\n          _jsx(AsyncSelect, { allowClear: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() }) }\n        ),\n        _jsx(\"p\", { className: \"help-block\", children:\n          t('Owners is a list of users who can alter the dashboard. Searchable by name or username.') }\n        )] }\n      ),\n      _jsxs(Col, { xs: 24, md: 12, children: [\n        _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Colors') }),\n        _jsx(ColorSchemeControlWrapper, { hasCustomLabelsColor: hasCustomLabelsColor, onChange: onColorSchemeChange, colorScheme: colorScheme })] }\n      )] }\n    );\n  };\n  const getRowsWithRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return _jsxs(_Fragment, { children: [\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Access') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Owners'), children:\n            _jsx(AsyncSelect, { allowClear: true, allowNewOptions: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Owners is a list of users who can alter the dashboard. Searchable by name or username.') }\n          )] }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Roles'), children:\n            _jsx(AsyncSelect, { allowClear: true, ariaLabel: t('Roles'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeRoles, options: (input, page, pageSize) => loadAccessOptions('roles', input, page, pageSize), value: handleRolesSelectValue() }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, regular access permissions apply.') }\n          )] }\n        )] }\n      ),\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(ColorSchemeControlWrapper, { hasCustomLabelsColor: hasCustomLabelsColor, onChange: onColorSchemeChange, colorScheme: colorScheme }) }\n        ) }\n      )] }\n    );\n  };\n  useEffect(() => {\n    if (show) {\n      if (!currentDashboardInfo) {\n        fetchDashboardDetails();\n      } else\n      {\n        handleDashboardData(currentDashboardInfo);\n      }\n    }\n    JsonEditor.preload();\n  }, [currentDashboardInfo, fetchDashboardDetails, handleDashboardData, show]);\n  useEffect(() => {\n    // the title can be changed inline in the dashboard, this catches it\n    if (dashboardTitle &&\n    dashboardInfo &&\n    dashboardInfo.title !== dashboardTitle) {\n      form.setFieldsValue({\n        ...dashboardInfo,\n        title: dashboardTitle\n      });\n    }\n  }, [dashboardInfo, dashboardTitle, form]);\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.TaggingSystem))\n    return;\n    try {\n      fetchTags({\n        objectType: OBJECT_TYPES.DASHBOARD,\n        objectId: dashboardId,\n        includeTypes: false\n      }, (tags) => setTags(tags), (error) => {\n        addDangerToast(`Error fetching tags: ${error.text}`);\n      });\n    }\n    catch (error) {\n      handleErrorResponse(error);\n    }\n  }, [dashboardId]);\n  const handleChangeTags = (tags) => {\n    const parsedTags = ensureIsArray(tags).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setTags(parsedTags);\n  };\n  return _jsx(Modal, { show: show, onHide: handleOnCancel, title: t('Dashboard properties'), footer: _jsxs(_Fragment, { children: [\n      _jsx(Button, { htmlType: \"button\", buttonSize: \"small\", onClick: handleOnCancel, cta: true, children:\n        t('Cancel') }\n      ),\n      _jsx(Button, { onClick: form.submit, buttonSize: \"small\", buttonStyle: \"primary\", className: \"m-r-5\", cta: true, disabled: dashboardInfo == null ? void 0 : dashboardInfo.isManagedExternally, tooltip: dashboardInfo != null && dashboardInfo.isManagedExternally ?\n        t(\"This dashboard is managed externally, and can't be edited in Superset\") :\n        '', children:\n        saveLabel }\n      )] }\n    ), responsive: true, children:\n    _jsxs(AntdForm, { form: form, onFinish: onFinish, layout: \"vertical\", initialValues: dashboardInfo, children: [\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { children: t('Basic information') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(FormItem, { label: t('Name'), name: \"title\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ) }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('URL slug'), name: \"slug\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('A readable URL for your dashboard') }\n          )] }\n        )] }\n      ),\n      isFeatureEnabled(FeatureFlag.DashboardRbac) ?\n      getRowsWithRoles() :\n      getRowsWithoutRoles(),\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { children: t('Certification') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Certified by'), name: \"certifiedBy\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Person or group that has certified this dashboard.') }\n          )] }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Certification details'), name: \"certificationDetails\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Any additional detail to show in the certification tooltip.') }\n          )] }\n        )] }\n      ),\n      isFeatureEnabled(FeatureFlag.TaggingSystem) ? _jsx(Row, { gutter: 16, children:\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(\"h3\", { css: _ref, children: t('Tags') }) }\n        ) }\n      ) : null,\n      isFeatureEnabled(FeatureFlag.TaggingSystem) ? _jsx(Row, { gutter: 16, children:\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { children:\n            _jsx(AsyncSelect, { ariaLabel: \"Tags\", mode: \"multiple\", value: tagsAsSelectValues, options: loadTags, onChange: handleChangeTags, allowClear: true }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('A list of tags that have been applied to this chart.') }\n          )] }\n        ) }\n      ) : null,\n      _jsx(Row, { children:\n        _jsxs(Col, { xs: 24, md: 24, children: [\n          _jsx(\"h3\", { style: { marginTop: '1em' }, children:\n            _jsxs(Button, { buttonStyle: \"link\", onClick: () => setIsAdvancedOpen(!isAdvancedOpen), css: css`\n                  padding: 0;\n                `, children: [\n\n              _jsx(\"i\", { className: `fa fa-angle-${isAdvancedOpen ? 'down' : 'right'}`, style: { minWidth: '1em' } }),\n              t('Advanced')] }\n            ) }\n          ),\n          isAdvancedOpen && _jsxs(_Fragment, { children: [\n            _jsx(StyledFormItem, { label: t('JSON metadata'), children:\n              _jsx(StyledJsonEditor, { showLoadingForImport: true, name: \"json_metadata\", value: jsonMetadata, onChange: setJsonMetadata, tabSize: 2, width: \"100%\", height: \"200px\", wrapEnabled: true }) }\n            ),\n            _jsxs(\"p\", { className: \"help-block\", children: [\n              t('This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.'),\n              onlyApply && _jsxs(_Fragment, { children: [\n                ' ',\n                t('Please DO NOT overwrite the \"filter_scopes\" key.'), ' ',\n                _jsx(FilterScopeModal, { triggerNode: _jsx(\"span\", { className: \"alert-link\", children:\n                    t('Use \"%(menuName)s\" menu instead.', {\n                      menuName: t('Set filter mapping')\n                    }) }\n                  ) })] }\n              )] }\n            )] }\n          )] }\n        ) }\n      )] }\n    ) }\n  );\n};\nexport default withToasts(PropertiesModal);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}