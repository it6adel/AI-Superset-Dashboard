{"ast":null,"code":"import _debounce from \"lodash/debounce\";function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";} /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useState, useEffect } from 'react';\nimport { t, styled } from '@superset-ui/core';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\n\nimport Badge from 'src/components/Badge';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport { ConfigEditor } from 'src/components/AsyncAceEditor';\nimport { FAST_DEBOUNCE } from 'src/constants';\nimport { Tooltip } from 'src/components/Tooltip';\nimport useQueryEditor from 'src/SqlLab/hooks/useQueryEditor';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst StyledConfigEditor = styled(ConfigEditor)`\n  &.ace_editor {\n    border: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  }\n`;var _ref = process.env.NODE_ENV === \"production\" ? { name: \"6n1ert\", styles: \"width:inherit\" } : { name: \"1uw7xs-TemplateParamsEditor\", styles: \"width:inherit;label:TemplateParamsEditor;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL1NxbExhYi9jb21wb25lbnRzL1RlbXBsYXRlUGFyYW1zRWRpdG9yL2luZGV4LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpRTZCIiwiZmlsZSI6Ii9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL1NxbExhYi9jb21wb25lbnRzL1RlbXBsYXRlUGFyYW1zRWRpdG9yL2luZGV4LnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB0LCBzdHlsZWQgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyBJbmZvVG9vbHRpcFdpdGhUcmlnZ2VyIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NoYXJ0LWNvbnRyb2xzJztcbmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBCYWRnZSBmcm9tICdzcmMvY29tcG9uZW50cy9CYWRnZSc7XG5pbXBvcnQgTW9kYWxUcmlnZ2VyIGZyb20gJ3NyYy9jb21wb25lbnRzL01vZGFsVHJpZ2dlcic7XG5pbXBvcnQgeyBDb25maWdFZGl0b3IgfSBmcm9tICdzcmMvY29tcG9uZW50cy9Bc3luY0FjZUVkaXRvcic7XG5pbXBvcnQgeyBGQVNUX0RFQk9VTkNFIH0gZnJvbSAnc3JjL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBUb29sdGlwIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvVG9vbHRpcCc7XG5pbXBvcnQgdXNlUXVlcnlFZGl0b3IgZnJvbSAnc3JjL1NxbExhYi9ob29rcy91c2VRdWVyeUVkaXRvcic7XG5jb25zdCBTdHlsZWRDb25maWdFZGl0b3IgPSBzdHlsZWQoQ29uZmlnRWRpdG9yKSBgXG4gICYuYWNlX2VkaXRvciB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gIH1cbmA7XG5jb25zdCBUZW1wbGF0ZVBhcmFtc0VkaXRvciA9ICh7IHF1ZXJ5RWRpdG9ySWQsIGxhbmd1YWdlLCBvbkNoYW5nZSA9ICgpID0+IHsgfSwgfSkgPT4ge1xuICAgIGNvbnN0IFtwYXJzZWRKU09OLCBzZXRQYXJzZWRKU09OXSA9IHVzZVN0YXRlKHt9KTtcbiAgICBjb25zdCBbaXNWYWxpZCwgc2V0SXNWYWxpZF0gPSB1c2VTdGF0ZSh0cnVlKTtcbiAgICBjb25zdCB7IHRlbXBsYXRlUGFyYW1zIH0gPSB1c2VRdWVyeUVkaXRvcihxdWVyeUVkaXRvcklkLCBbJ3RlbXBsYXRlUGFyYW1zJ10pO1xuICAgIGNvbnN0IGNvZGUgPSB0ZW1wbGF0ZVBhcmFtcyA/PyAne30nO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzZXRQYXJzZWRKU09OKEpTT04ucGFyc2UoY29kZSkpO1xuICAgICAgICAgICAgc2V0SXNWYWxpZCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICBzZXRQYXJzZWRKU09OKHt9KTtcbiAgICAgICAgICAgIHNldElzVmFsaWQoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfSwgW2NvZGVdKTtcbiAgICBjb25zdCBtb2RhbEJvZHkgPSAoPGRpdj5cbiAgICAgIDxwPlxuICAgICAgICB7dCgnQXNzaWduIGEgc2V0IG9mIHBhcmFtZXRlcnMgYXMnKX1cbiAgICAgICAgPGNvZGU+SlNPTjwvY29kZT5cbiAgICAgICAge3QoJ2JlbG93IChleGFtcGxlOicpfVxuICAgICAgICA8Y29kZT57J3tcIm15X3RhYmxlXCI6IFwiZm9vXCJ9J308L2NvZGU+XG4gICAgICAgIHt0KCcpLCBhbmQgdGhleSBiZWNvbWUgYXZhaWxhYmxlIGluIHlvdXIgU1FMIChleGFtcGxlOicpfVxuICAgICAgICA8Y29kZT5TRUxFQ1QgKiBGUk9NIHsne3sgbXlfdGFibGUgfX0nfSA8L2NvZGU+KSB7dCgnYnkgdXNpbmcnKX0mbmJzcDtcbiAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vc3VwZXJzZXQuYXBhY2hlLm9yZy9zcWxsYWIuaHRtbCN0ZW1wbGF0aW5nLXdpdGgtamluamFcIiB0YXJnZXQ9XCJfYmxhbmtcIiByZWw9XCJub29wZW5lciBub3JlZmVycmVyXCI+XG4gICAgICAgICAge3QoJ0ppbmphIHRlbXBsYXRpbmcnKX1cbiAgICAgICAgPC9hPnsnICd9XG4gICAgICAgIHt0KCdzeW50YXguJyl9XG4gICAgICA8L3A+XG4gICAgICA8U3R5bGVkQ29uZmlnRWRpdG9yIG1vZGU9e2xhbmd1YWdlfSBtaW5MaW5lcz17MjV9IG1heExpbmVzPXs1MH0gb25DaGFuZ2U9e2RlYm91bmNlKG9uQ2hhbmdlLCBGQVNUX0RFQk9VTkNFKX0gd2lkdGg9XCIxMDAlXCIgZWRpdG9yUHJvcHM9e3sgJGJsb2NrU2Nyb2xsaW5nOiB0cnVlIH19IGVuYWJsZUxpdmVBdXRvY29tcGxldGlvbiB2YWx1ZT17Y29kZX0vPlxuICAgIDwvZGl2Pik7XG4gICAgY29uc3QgcGFyYW1Db3VudCA9IHBhcnNlZEpTT04gPyBPYmplY3Qua2V5cyhwYXJzZWRKU09OKS5sZW5ndGggOiAwO1xuICAgIHJldHVybiAoPE1vZGFsVHJpZ2dlciBtb2RhbFRpdGxlPXt0KCdUZW1wbGF0ZSBwYXJhbWV0ZXJzJyl9IHRyaWdnZXJOb2RlPXs8VG9vbHRpcCBpZD1cInBhcmFtZXRlcnMtdG9vbHRpcFwiIHBsYWNlbWVudD1cInRvcFwiIHRpdGxlPXt0KCdFZGl0IHRlbXBsYXRlIHBhcmFtZXRlcnMnKX0gdHJpZ2dlcj17Wydob3ZlciddfT5cbiAgICAgICAgICA8ZGl2IHJvbGU9XCJidXR0b25cIiBjc3M9e3sgd2lkdGg6ICdpbmhlcml0JyB9fT5cbiAgICAgICAgICAgIHt0KCdQYXJhbWV0ZXJzICcpfVxuICAgICAgICAgICAgPEJhZGdlIGNvdW50PXtwYXJhbUNvdW50fS8+XG4gICAgICAgICAgICB7IWlzVmFsaWQgJiYgKDxJbmZvVG9vbHRpcFdpdGhUcmlnZ2VyIGljb249XCJleGNsYW1hdGlvbi10cmlhbmdsZVwiIGJzU3R5bGU9XCJkYW5nZXJcIiB0b29sdGlwPXt0KCdJbnZhbGlkIEpTT04nKX0gbGFiZWw9XCJpbnZhbGlkLWpzb25cIi8+KX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9Ub29sdGlwPn0gbW9kYWxCb2R5PXttb2RhbEJvZHl9Lz4pO1xufTtcbmV4cG9ydCBkZWZhdWx0IFRlbXBsYXRlUGFyYW1zRWRpdG9yO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst TemplateParamsEditor = ({ queryEditorId, language, onChange = () => {} }) => {\n  const [parsedJSON, setParsedJSON] = useState({});\n  const [isValid, setIsValid] = useState(true);\n  const { templateParams } = useQueryEditor(queryEditorId, ['templateParams']);\n  const code = templateParams != null ? templateParams : '{}';\n  useEffect(() => {\n    try {\n      setParsedJSON(JSON.parse(code));\n      setIsValid(true);\n    }\n    catch {\n      setParsedJSON({});\n      setIsValid(false);\n    }\n  }, [code]);\n  const modalBody = _jsxs(\"div\", { children: [\n    _jsxs(\"p\", { children: [\n      t('Assign a set of parameters as'),\n      _jsx(\"code\", { children: \"JSON\" }),\n      t('below (example:'),\n      _jsx(\"code\", { children: '{\"my_table\": \"foo\"}' }),\n      t('), and they become available in your SQL (example:'),\n      _jsxs(\"code\", { children: [\"SELECT * FROM \", '{{ my_table }}', \" \"] }), \") \", t('by using'), \"\\xA0\",\n      _jsx(\"a\", { href: \"https://superset.apache.org/sqllab.html#templating-with-jinja\", target: \"_blank\", rel: \"noopener noreferrer\", children:\n        t('Jinja templating') }\n      ), ' ',\n      t('syntax.')] }\n    ),\n    _jsx(StyledConfigEditor, { mode: language, minLines: 25, maxLines: 50, onChange: _debounce(onChange, FAST_DEBOUNCE), width: \"100%\", editorProps: { $blockScrolling: true }, enableLiveAutocompletion: true, value: code })] }\n  );\n  const paramCount = parsedJSON ? Object.keys(parsedJSON).length : 0;\n  return _jsx(ModalTrigger, { modalTitle: t('Template parameters'), triggerNode: _jsx(Tooltip, { id: \"parameters-tooltip\", placement: \"top\", title: t('Edit template parameters'), trigger: ['hover'], children:\n      _jsxs(\"div\", { role: \"button\", css: _ref, children: [\n        t('Parameters '),\n        _jsx(Badge, { count: paramCount }),\n        !isValid && _jsx(InfoTooltipWithTrigger, { icon: \"exclamation-triangle\", bsStyle: \"danger\", tooltip: t('Invalid JSON'), label: \"invalid-json\" })] }\n      ) }\n    ), modalBody: modalBody });\n};\nexport default TemplateParamsEditor;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}