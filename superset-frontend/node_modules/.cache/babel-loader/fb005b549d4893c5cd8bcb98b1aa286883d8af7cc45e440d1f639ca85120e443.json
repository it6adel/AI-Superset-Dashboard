{"ast":null,"code":"function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";} /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { cloneElement, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { css, ensureIsArray, GenericDataType, t, useTheme } from '@superset-ui/core';\nimport { useResizeDetector } from 'react-resize-detector';\nimport Loading from 'src/components/Loading';\nimport BooleanCell from 'src/components/Table/cell-renderers/BooleanCell';\nimport NullCell from 'src/components/Table/cell-renderers/NullCell';\nimport TimeCell from 'src/components/Table/cell-renderers/TimeCell';\nimport { EmptyState } from 'src/components/EmptyState';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport Table, { TableSize } from 'src/components/Table';\nimport HeaderWithRadioGroup from 'src/components/Table/header-renderers/HeaderWithRadioGroup';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { useDatasetMetadataBar } from 'src/features/datasets/metadataBar/useDatasetMetadataBar';\nimport TableControls from './DrillDetailTableControls';\nimport { getDrillPayload } from './utils';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst PAGE_SIZE = 50;\n// Must be outside of the main component due to problems in\n// react-resize-detector with conditional rendering\n// https://github.com/maslianok/react-resize-detector/issues/178\nvar _ref = process.env.NODE_ENV === \"production\" ? { name: \"82a6rk\", styles: \"flex:1\" } : { name: \"1715jyj-Resizable\", styles: \"flex:1;label:Resizable;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvQ2hhcnQvRHJpbGxEZXRhaWwvRHJpbGxEZXRhaWxQYW5lLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF3QzJCIiwiZmlsZSI6Ii9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvQ2hhcnQvRHJpbGxEZXRhaWwvRHJpbGxEZXRhaWxQYW5lLnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IGNsb25lRWxlbWVudCwgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlUmVmLCB1c2VTdGF0ZSwgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VTZWxlY3RvciB9IGZyb20gJ3JlYWN0LXJlZHV4JztcbmltcG9ydCB7IGNzcywgZW5zdXJlSXNBcnJheSwgR2VuZXJpY0RhdGFUeXBlLCB0LCB1c2VUaGVtZSwgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyB1c2VSZXNpemVEZXRlY3RvciB9IGZyb20gJ3JlYWN0LXJlc2l6ZS1kZXRlY3Rvcic7XG5pbXBvcnQgTG9hZGluZyBmcm9tICdzcmMvY29tcG9uZW50cy9Mb2FkaW5nJztcbmltcG9ydCBCb29sZWFuQ2VsbCBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJsZS9jZWxsLXJlbmRlcmVycy9Cb29sZWFuQ2VsbCc7XG5pbXBvcnQgTnVsbENlbGwgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFibGUvY2VsbC1yZW5kZXJlcnMvTnVsbENlbGwnO1xuaW1wb3J0IFRpbWVDZWxsIGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYmxlL2NlbGwtcmVuZGVyZXJzL1RpbWVDZWxsJztcbmltcG9ydCB7IEVtcHR5U3RhdGUgfSBmcm9tICdzcmMvY29tcG9uZW50cy9FbXB0eVN0YXRlJztcbmltcG9ydCB7IGdldERhdGFzb3VyY2VTYW1wbGVzIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvQ2hhcnQvY2hhcnRBY3Rpb24nO1xuaW1wb3J0IFRhYmxlLCB7IFRhYmxlU2l6ZSB9IGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYmxlJztcbmltcG9ydCBIZWFkZXJXaXRoUmFkaW9Hcm91cCBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJsZS9oZWFkZXItcmVuZGVyZXJzL0hlYWRlcldpdGhSYWRpb0dyb3VwJztcbmltcG9ydCB7IFJlc291cmNlU3RhdHVzIH0gZnJvbSAnc3JjL2hvb2tzL2FwaVJlc291cmNlcy9hcGlSZXNvdXJjZXMnO1xuaW1wb3J0IHsgdXNlRGF0YXNldE1ldGFkYXRhQmFyIH0gZnJvbSAnc3JjL2ZlYXR1cmVzL2RhdGFzZXRzL21ldGFkYXRhQmFyL3VzZURhdGFzZXRNZXRhZGF0YUJhcic7XG5pbXBvcnQgVGFibGVDb250cm9scyBmcm9tICcuL0RyaWxsRGV0YWlsVGFibGVDb250cm9scyc7XG5pbXBvcnQgeyBnZXREcmlsbFBheWxvYWQgfSBmcm9tICcuL3V0aWxzJztcbmNvbnN0IFBBR0VfU0laRSA9IDUwO1xuLy8gTXVzdCBiZSBvdXRzaWRlIG9mIHRoZSBtYWluIGNvbXBvbmVudCBkdWUgdG8gcHJvYmxlbXMgaW5cbi8vIHJlYWN0LXJlc2l6ZS1kZXRlY3RvciB3aXRoIGNvbmRpdGlvbmFsIHJlbmRlcmluZ1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL21hc2xpYW5vay9yZWFjdC1yZXNpemUtZGV0ZWN0b3IvaXNzdWVzLzE3OFxuZnVuY3Rpb24gUmVzaXphYmxlKHsgY2hpbGRyZW4gfSkge1xuICAgIGNvbnN0IHsgcmVmLCBoZWlnaHQgfSA9IHVzZVJlc2l6ZURldGVjdG9yKCk7XG4gICAgcmV0dXJuICg8ZGl2IHJlZj17cmVmfSBjc3M9e3sgZmxleDogMSB9fT5cbiAgICAgIHtjbG9uZUVsZW1lbnQoY2hpbGRyZW4sIHsgaGVpZ2h0IH0pfVxuICAgIDwvZGl2Pik7XG59XG52YXIgVGltZUZvcm1hdHRpbmc7XG4oZnVuY3Rpb24gKFRpbWVGb3JtYXR0aW5nKSB7XG4gICAgVGltZUZvcm1hdHRpbmdbVGltZUZvcm1hdHRpbmdbXCJPcmlnaW5hbFwiXSA9IDBdID0gXCJPcmlnaW5hbFwiO1xuICAgIFRpbWVGb3JtYXR0aW5nW1RpbWVGb3JtYXR0aW5nW1wiRm9ybWF0dGVkXCJdID0gMV0gPSBcIkZvcm1hdHRlZFwiO1xufSkoVGltZUZvcm1hdHRpbmcgfHwgKFRpbWVGb3JtYXR0aW5nID0ge30pKTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIERyaWxsRGV0YWlsUGFuZSh7IGZvcm1EYXRhLCBpbml0aWFsRmlsdGVycywgfSkge1xuICAgIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKTtcbiAgICBjb25zdCBbcGFnZUluZGV4LCBzZXRQYWdlSW5kZXhdID0gdXNlU3RhdGUoMCk7XG4gICAgY29uc3QgbGFzdFBhZ2VJbmRleCA9IHVzZVJlZihwYWdlSW5kZXgpO1xuICAgIGNvbnN0IFtmaWx0ZXJzLCBzZXRGaWx0ZXJzXSA9IHVzZVN0YXRlKGluaXRpYWxGaWx0ZXJzKTtcbiAgICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtyZXNwb25zZUVycm9yLCBzZXRSZXNwb25zZUVycm9yXSA9IHVzZVN0YXRlKCcnKTtcbiAgICBjb25zdCBbcmVzdWx0c1BhZ2VzLCBzZXRSZXN1bHRzUGFnZXNdID0gdXNlU3RhdGUobmV3IE1hcCgpKTtcbiAgICBjb25zdCBbdGltZUZvcm1hdHRpbmcsIHNldFRpbWVGb3JtYXR0aW5nXSA9IHVzZVN0YXRlKHt9KTtcbiAgICBjb25zdCBTQU1QTEVTX1JPV19MSU1JVCA9IHVzZVNlbGVjdG9yKChzdGF0ZSkgPT4gc3RhdGUuY29tbW9uLmNvbmYuU0FNUExFU19ST1dfTElNSVQpO1xuICAgIC8vIEV4dHJhY3QgZGF0YXNvdXJjZSBJRC90eXBlIGZyb20gc3RyaW5nIElEXG4gICAgY29uc3QgW2RhdGFzb3VyY2VJZCwgZGF0YXNvdXJjZVR5cGVdID0gdXNlTWVtbygoKSA9PiBmb3JtRGF0YS5kYXRhc291cmNlLnNwbGl0KCdfXycpLCBbZm9ybURhdGEuZGF0YXNvdXJjZV0pO1xuICAgIGNvbnN0IHsgbWV0YWRhdGFCYXIsIHN0YXR1czogbWV0YWRhdGFCYXJTdGF0dXMgfSA9IHVzZURhdGFzZXRNZXRhZGF0YUJhcih7XG4gICAgICAgIGRhdGFzZXRJZDogZGF0YXNvdXJjZUlkLFxuICAgIH0pO1xuICAgIC8vIEdldCBwYWdlIG9mIHJlc3VsdHNcbiAgICBjb25zdCByZXN1bHRzUGFnZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXh0UmVzdWx0c1BhZ2UgPSByZXN1bHRzUGFnZXMuZ2V0KHBhZ2VJbmRleCk7XG4gICAgICAgIGlmIChuZXh0UmVzdWx0c1BhZ2UpIHtcbiAgICAgICAgICAgIGxhc3RQYWdlSW5kZXguY3VycmVudCA9IHBhZ2VJbmRleDtcbiAgICAgICAgICAgIHJldHVybiBuZXh0UmVzdWx0c1BhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHNQYWdlcy5nZXQobGFzdFBhZ2VJbmRleC5jdXJyZW50KTtcbiAgICB9LCBbcGFnZUluZGV4LCByZXN1bHRzUGFnZXNdKTtcbiAgICBjb25zdCBtYXBwZWRDb2x1bW5zID0gdXNlTWVtbygoKSA9PiByZXN1bHRzUGFnZT8uY29sTmFtZXMubWFwKChjb2x1bW4sIGluZGV4KSA9PiAoe1xuICAgICAgICBrZXk6IGNvbHVtbixcbiAgICAgICAgZGF0YUluZGV4OiBjb2x1bW4sXG4gICAgICAgIHRpdGxlOiByZXN1bHRzUGFnZT8uY29sVHlwZXNbaW5kZXhdID09PSBHZW5lcmljRGF0YVR5cGUuVGVtcG9yYWwgPyAoPEhlYWRlcldpdGhSYWRpb0dyb3VwIGhlYWRlclRpdGxlPXtjb2x1bW59IGdyb3VwVGl0bGU9e3QoJ0Zvcm1hdHRpbmcnKX0gZ3JvdXBPcHRpb25zPXtbXG4gICAgICAgICAgICAgICAgeyBsYWJlbDogdCgnT3JpZ2luYWwgdmFsdWUnKSwgdmFsdWU6IFRpbWVGb3JtYXR0aW5nLk9yaWdpbmFsIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogdCgnRm9ybWF0dGVkIHZhbHVlJyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBUaW1lRm9ybWF0dGluZy5Gb3JtYXR0ZWQsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF19IHZhbHVlPXt0aW1lRm9ybWF0dGluZ1tjb2x1bW5dID09PSBUaW1lRm9ybWF0dGluZy5PcmlnaW5hbFxuICAgICAgICAgICAgICAgID8gVGltZUZvcm1hdHRpbmcuT3JpZ2luYWxcbiAgICAgICAgICAgICAgICA6IFRpbWVGb3JtYXR0aW5nLkZvcm1hdHRlZH0gb25DaGFuZ2U9e3ZhbHVlID0+IHNldFRpbWVGb3JtYXR0aW5nKHN0YXRlID0+ICh7XG4gICAgICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICAgICAgW2NvbHVtbl06IHBhcnNlSW50KHZhbHVlLCAxMCksXG4gICAgICAgICAgICB9KSl9Lz4pIDogKGNvbHVtbiksXG4gICAgICAgIHJlbmRlcjogdmFsdWUgPT4ge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiA8Qm9vbGVhbkNlbGwgdmFsdWU9e3ZhbHVlfS8+O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxOdWxsQ2VsbCAvPjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHRzUGFnZT8uY29sVHlwZXNbaW5kZXhdID09PSBHZW5lcmljRGF0YVR5cGUuVGVtcG9yYWwgJiZcbiAgICAgICAgICAgICAgICB0aW1lRm9ybWF0dGluZ1tjb2x1bW5dICE9PSBUaW1lRm9ybWF0dGluZy5PcmlnaW5hbCAmJlxuICAgICAgICAgICAgICAgICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8IHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPFRpbWVDZWxsIHZhbHVlPXt2YWx1ZX0vPjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcodmFsdWUpO1xuICAgICAgICB9LFxuICAgICAgICB3aWR0aDogMTUwLFxuICAgIH0pKSB8fCBbXSwgW3Jlc3VsdHNQYWdlPy5jb2xOYW1lcywgcmVzdWx0c1BhZ2U/LmNvbFR5cGVzLCB0aW1lRm9ybWF0dGluZ10pO1xuICAgIGNvbnN0IGRhdGEgPSB1c2VNZW1vKCgpID0+IHJlc3VsdHNQYWdlPy5kYXRhLm1hcCgocm93LCBpbmRleCkgPT4gcmVzdWx0c1BhZ2U/LmNvbE5hbWVzLnJlZHVjZSgoYWNjLCBjdXJyKSA9PiAoeyAuLi5hY2MsIFtjdXJyXTogcm93W2N1cnJdIH0pLCB7XG4gICAgICAgIGtleTogaW5kZXgsXG4gICAgfSkpIHx8IFtdLCBbcmVzdWx0c1BhZ2U/LmNvbE5hbWVzLCByZXN1bHRzUGFnZT8uZGF0YV0pO1xuICAgIC8vIENsZWFyIGNhY2hlIG9uIHJlbG9hZCBidXR0b24gY2xpY2tcbiAgICBjb25zdCBoYW5kbGVSZWxvYWQgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIHNldFJlc3BvbnNlRXJyb3IoJycpO1xuICAgICAgICBzZXRSZXN1bHRzUGFnZXMobmV3IE1hcCgpKTtcbiAgICAgICAgc2V0UGFnZUluZGV4KDApO1xuICAgIH0sIFtdKTtcbiAgICAvLyBDbGVhciBjYWNoZSBhbmQgcmVzZXQgcGFnZSBpbmRleCBpZiBmaWx0ZXJzIGNoYW5nZVxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHNldFJlc3BvbnNlRXJyb3IoJycpO1xuICAgICAgICBzZXRSZXN1bHRzUGFnZXMobmV3IE1hcCgpKTtcbiAgICAgICAgc2V0UGFnZUluZGV4KDApO1xuICAgIH0sIFtmaWx0ZXJzXSk7XG4gICAgLy8gVXBkYXRlIGNhY2hlIG9yZGVyIGlmIHBhZ2UgaW4gY2FjaGVcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAocmVzdWx0c1BhZ2VzLmhhcyhwYWdlSW5kZXgpICYmXG4gICAgICAgICAgICBbLi4ucmVzdWx0c1BhZ2VzLmtleXMoKV0uYXQoLTEpICE9PSBwYWdlSW5kZXgpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHRSZXN1bHRzUGFnZXMgPSBuZXcgTWFwKHJlc3VsdHNQYWdlcyk7XG4gICAgICAgICAgICBuZXh0UmVzdWx0c1BhZ2VzLmRlbGV0ZShwYWdlSW5kZXgpO1xuICAgICAgICAgICAgc2V0UmVzdWx0c1BhZ2VzKG5leHRSZXN1bHRzUGFnZXMuc2V0KHBhZ2VJbmRleCwgcmVzdWx0c1BhZ2VzLmdldChwYWdlSW5kZXgpKSk7XG4gICAgICAgIH1cbiAgICB9LCBbcGFnZUluZGV4LCByZXN1bHRzUGFnZXNdKTtcbiAgICAvLyBEb3dubG9hZCBwYWdlIG9mIHJlc3VsdHMgJiB0cmltIGNhY2hlIGlmIHBhZ2Ugbm90IGluIGNhY2hlXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFyZXNwb25zZUVycm9yICYmICFpc0xvYWRpbmcgJiYgIXJlc3VsdHNQYWdlcy5oYXMocGFnZUluZGV4KSkge1xuICAgICAgICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgICAgICAgY29uc3QganNvblBheWxvYWQgPSBnZXREcmlsbFBheWxvYWQoZm9ybURhdGEsIGZpbHRlcnMpID8/IHt9O1xuICAgICAgICAgICAgY29uc3QgY2FjaGVQYWdlTGltaXQgPSBNYXRoLmNlaWwoU0FNUExFU19ST1dfTElNSVQgLyBQQUdFX1NJWkUpO1xuICAgICAgICAgICAgZ2V0RGF0YXNvdXJjZVNhbXBsZXMoZGF0YXNvdXJjZVR5cGUsIGRhdGFzb3VyY2VJZCwgZmFsc2UsIGpzb25QYXlsb2FkLCBQQUdFX1NJWkUsIHBhZ2VJbmRleCArIDEpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHNldFJlc3VsdHNQYWdlcyhuZXcgTWFwKFtcbiAgICAgICAgICAgICAgICAgICAgLi4uWy4uLnJlc3VsdHNQYWdlcy5lbnRyaWVzKCldLnNsaWNlKC1jYWNoZVBhZ2VMaW1pdCArIDEpLFxuICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IHJlc3BvbnNlLnRvdGFsX2NvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3BvbnNlLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sTmFtZXM6IGVuc3VyZUlzQXJyYXkocmVzcG9uc2UuY29sbmFtZXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbFR5cGVzOiBlbnN1cmVJc0FycmF5KHJlc3BvbnNlLmNvbHR5cGVzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgXSkpO1xuICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlRXJyb3IoJycpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlRXJyb3IoYCR7ZXJyb3IubmFtZX06ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIFtcbiAgICAgICAgU0FNUExFU19ST1dfTElNSVQsXG4gICAgICAgIGRhdGFzb3VyY2VJZCxcbiAgICAgICAgZGF0YXNvdXJjZVR5cGUsXG4gICAgICAgIGZpbHRlcnMsXG4gICAgICAgIGZvcm1EYXRhLFxuICAgICAgICBpc0xvYWRpbmcsXG4gICAgICAgIHBhZ2VJbmRleCxcbiAgICAgICAgcmVzcG9uc2VFcnJvcixcbiAgICAgICAgcmVzdWx0c1BhZ2VzLFxuICAgIF0pO1xuICAgIGNvbnN0IGJvb3RzdHJhcHBpbmcgPSAoIXJlc3BvbnNlRXJyb3IgJiYgIXJlc3VsdHNQYWdlcy5zaXplKSB8fFxuICAgICAgICBtZXRhZGF0YUJhclN0YXR1cyA9PT0gUmVzb3VyY2VTdGF0dXMuTG9hZGluZztcbiAgICBjb25zdCBhbGxvd0hUTUwgPSBmb3JtRGF0YS5hbGxvd19yZW5kZXJfaHRtbCA/PyB0cnVlO1xuICAgIGxldCB0YWJsZUNvbnRlbnQgPSBudWxsO1xuICAgIGlmIChyZXNwb25zZUVycm9yKSB7XG4gICAgICAgIC8vIFJlbmRlciBlcnJvciBpZiBwYWdlIGRvd25sb2FkIGZhaWxlZFxuICAgICAgICB0YWJsZUNvbnRlbnQgPSAoPHByZSBjc3M9e2NzcyBgXG4gICAgICAgICAgbWFyZ2luLXRvcDogJHt0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgICAgIGB9PlxuICAgICAgICB7cmVzcG9uc2VFcnJvcn1cbiAgICAgIDwvcHJlPik7XG4gICAgfVxuICAgIGVsc2UgaWYgKGJvb3RzdHJhcHBpbmcpIHtcbiAgICAgICAgLy8gUmVuZGVyIGxvYWRpbmcgaWYgZmlyc3QgcGFnZSBoYXNuJ3QgbG9hZGVkXG4gICAgICAgIHRhYmxlQ29udGVudCA9IDxMb2FkaW5nIC8+O1xuICAgIH1cbiAgICBlbHNlIGlmIChyZXN1bHRzUGFnZT8udG90YWwgPT09IDApIHtcbiAgICAgICAgLy8gUmVuZGVyIGVtcHR5IHN0YXRlIGlmIG5vIHJlc3VsdHMgYXJlIHJldHVybmVkIGZvciBwYWdlXG4gICAgICAgIGNvbnN0IHRpdGxlID0gdCgnTm8gcm93cyB3ZXJlIHJldHVybmVkIGZvciB0aGlzIGRhdGFzZXQnKTtcbiAgICAgICAgdGFibGVDb250ZW50ID0gPEVtcHR5U3RhdGUgaW1hZ2U9XCJkb2N1bWVudC5zdmdcIiB0aXRsZT17dGl0bGV9Lz47XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvLyBSZW5kZXIgdGFibGUgaWYgYXQgbGVhc3Qgb25lIHBhZ2UgaGFzIHN1Y2Nlc3NmdWxseSBsb2FkZWRcbiAgICAgICAgdGFibGVDb250ZW50ID0gKDxSZXNpemFibGU+XG4gICAgICAgIDxUYWJsZSBkYXRhPXtkYXRhfSBjb2x1bW5zPXttYXBwZWRDb2x1bW5zfSBzaXplPXtUYWJsZVNpemUuU21hbGx9IGRlZmF1bHRQYWdlU2l6ZT17UEFHRV9TSVpFfSByZWNvcmRDb3VudD17cmVzdWx0c1BhZ2U/LnRvdGFsfSB1c2VQYWdpbmF0aW9uIGxvYWRpbmc9e2lzTG9hZGluZ30gb25DaGFuZ2U9e3BhZ2luYXRpb24gPT4gc2V0UGFnZUluZGV4KHBhZ2luYXRpb24uY3VycmVudCA/IHBhZ2luYXRpb24uY3VycmVudCAtIDEgOiAwKX0gcmVzaXphYmxlIHZpcnR1YWxpemUgYWxsb3dIVE1MPXthbGxvd0hUTUx9Lz5cbiAgICAgIDwvUmVzaXphYmxlPik7XG4gICAgfVxuICAgIHJldHVybiAoPD5cbiAgICAgIHshYm9vdHN0cmFwcGluZyAmJiBtZXRhZGF0YUJhcn1cbiAgICAgIHshYm9vdHN0cmFwcGluZyAmJiAoPFRhYmxlQ29udHJvbHMgZmlsdGVycz17ZmlsdGVyc30gc2V0RmlsdGVycz17c2V0RmlsdGVyc30gdG90YWxDb3VudD17cmVzdWx0c1BhZ2U/LnRvdGFsfSBsb2FkaW5nPXtpc0xvYWRpbmd9IG9uUmVsb2FkPXtoYW5kbGVSZWxvYWR9Lz4pfVxuICAgICAge3RhYmxlQ29udGVudH1cbiAgICA8Lz4pO1xufVxuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };function Resizable({ children }) {\n  const { ref, height } = useResizeDetector();\n  return _jsx(\"div\", { ref: ref, css: _ref, children: /*#__PURE__*/\n    cloneElement(children, { height }) }\n  );\n}\nvar TimeFormatting;\n(function (TimeFormatting) {\n  TimeFormatting[TimeFormatting[\"Original\"] = 0] = \"Original\";\n  TimeFormatting[TimeFormatting[\"Formatted\"] = 1] = \"Formatted\";\n})(TimeFormatting || (TimeFormatting = {}));\nexport default function DrillDetailPane({ formData, initialFilters }) {var _formData$allow_rende;\n  const theme = useTheme();\n  const [pageIndex, setPageIndex] = useState(0);\n  const lastPageIndex = useRef(pageIndex);\n  const [filters, setFilters] = useState(initialFilters);\n  const [isLoading, setIsLoading] = useState(false);\n  const [responseError, setResponseError] = useState('');\n  const [resultsPages, setResultsPages] = useState(new Map());\n  const [timeFormatting, setTimeFormatting] = useState({});\n  const SAMPLES_ROW_LIMIT = useSelector((state) => state.common.conf.SAMPLES_ROW_LIMIT);\n  // Extract datasource ID/type from string ID\n  const [datasourceId, datasourceType] = useMemo(() => formData.datasource.split('__'), [formData.datasource]);\n  const { metadataBar, status: metadataBarStatus } = useDatasetMetadataBar({\n    datasetId: datasourceId\n  });\n  // Get page of results\n  const resultsPage = useMemo(() => {\n    const nextResultsPage = resultsPages.get(pageIndex);\n    if (nextResultsPage) {\n      lastPageIndex.current = pageIndex;\n      return nextResultsPage;\n    }\n    return resultsPages.get(lastPageIndex.current);\n  }, [pageIndex, resultsPages]);\n  const mappedColumns = useMemo(() => (resultsPage == null ? void 0 : resultsPage.colNames.map((column, index) => ({\n    key: column,\n    dataIndex: column,\n    title: (resultsPage == null ? void 0 : resultsPage.colTypes[index]) === GenericDataType.Temporal ? _jsx(HeaderWithRadioGroup, { headerTitle: column, groupTitle: t('Formatting'), groupOptions: [\n      { label: t('Original value'), value: TimeFormatting.Original },\n      {\n        label: t('Formatted value'),\n        value: TimeFormatting.Formatted\n      }],\n      value: timeFormatting[column] === TimeFormatting.Original ?\n      TimeFormatting.Original :\n      TimeFormatting.Formatted, onChange: (value) => setTimeFormatting((state) => ({\n        ...state,\n        [column]: parseInt(value, 10)\n      })) }) : column,\n    render: (value) => {\n      if (value === true || value === false) {\n        return _jsx(BooleanCell, { value: value });\n      }\n      if (value === null) {\n        return _jsx(NullCell, {});\n      }\n      if ((resultsPage == null ? void 0 : resultsPage.colTypes[index]) === GenericDataType.Temporal &&\n      timeFormatting[column] !== TimeFormatting.Original && (\n      typeof value === 'number' || value instanceof Date)) {\n        return _jsx(TimeCell, { value: value });\n      }\n      return String(value);\n    },\n    width: 150\n  }))) || [], [resultsPage == null ? void 0 : resultsPage.colNames, resultsPage == null ? void 0 : resultsPage.colTypes, timeFormatting]);\n  const data = useMemo(() => (resultsPage == null ? void 0 : resultsPage.data.map((row, index) => resultsPage == null ? void 0 : resultsPage.colNames.reduce((acc, curr) => ({ ...acc, [curr]: row[curr] }), {\n    key: index\n  }))) || [], [resultsPage == null ? void 0 : resultsPage.colNames, resultsPage == null ? void 0 : resultsPage.data]);\n  // Clear cache on reload button click\n  const handleReload = useCallback(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, []);\n  // Clear cache and reset page index if filters change\n  useEffect(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, [filters]);\n  // Update cache order if page in cache\n  useEffect(() => {\n    if (resultsPages.has(pageIndex) &&\n    [...resultsPages.keys()].at(-1) !== pageIndex) {\n      const nextResultsPages = new Map(resultsPages);\n      nextResultsPages.delete(pageIndex);\n      setResultsPages(nextResultsPages.set(pageIndex, resultsPages.get(pageIndex)));\n    }\n  }, [pageIndex, resultsPages]);\n  // Download page of results & trim cache if page not in cache\n  useEffect(() => {\n    if (!responseError && !isLoading && !resultsPages.has(pageIndex)) {var _getDrillPayload;\n      setIsLoading(true);\n      const jsonPayload = (_getDrillPayload = getDrillPayload(formData, filters)) != null ? _getDrillPayload : {};\n      const cachePageLimit = Math.ceil(SAMPLES_ROW_LIMIT / PAGE_SIZE);\n      getDatasourceSamples(datasourceType, datasourceId, false, jsonPayload, PAGE_SIZE, pageIndex + 1).\n      then((response) => {\n        setResultsPages(new Map([\n        ...[...resultsPages.entries()].slice(-cachePageLimit + 1),\n        [\n        pageIndex,\n        {\n          total: response.total_count,\n          data: response.data,\n          colNames: ensureIsArray(response.colnames),\n          colTypes: ensureIsArray(response.coltypes)\n        }]]\n\n        ));\n        setResponseError('');\n      }).\n      catch((error) => {\n        setResponseError(`${error.name}: ${error.message}`);\n      }).\n      finally(() => {\n        setIsLoading(false);\n      });\n    }\n  }, [\n  SAMPLES_ROW_LIMIT,\n  datasourceId,\n  datasourceType,\n  filters,\n  formData,\n  isLoading,\n  pageIndex,\n  responseError,\n  resultsPages]\n  );\n  const bootstrapping = !responseError && !resultsPages.size ||\n  metadataBarStatus === ResourceStatus.Loading;\n  const allowHTML = (_formData$allow_rende = formData.allow_render_html) != null ? _formData$allow_rende : true;\n  let tableContent = null;\n  if (responseError) {\n    // Render error if page download failed\n    tableContent = _jsx(\"pre\", { css: css`\n          margin-top: ${theme.gridUnit * 4}px;\n        `, children:\n      responseError }\n    );\n  } else\n  if (bootstrapping) {\n    // Render loading if first page hasn't loaded\n    tableContent = _jsx(Loading, {});\n  } else\n  if ((resultsPage == null ? void 0 : resultsPage.total) === 0) {\n    // Render empty state if no results are returned for page\n    const title = t('No rows were returned for this dataset');\n    tableContent = _jsx(EmptyState, { image: \"document.svg\", title: title });\n  } else\n  {\n    // Render table if at least one page has successfully loaded\n    tableContent = _jsx(Resizable, { children:\n      _jsx(Table, { data: data, columns: mappedColumns, size: TableSize.Small, defaultPageSize: PAGE_SIZE, recordCount: resultsPage == null ? void 0 : resultsPage.total, usePagination: true, loading: isLoading, onChange: (pagination) => setPageIndex(pagination.current ? pagination.current - 1 : 0), resizable: true, virtualize: true, allowHTML: allowHTML }) }\n    );\n  }\n  return _jsxs(_Fragment, { children: [\n    !bootstrapping && metadataBar,\n    !bootstrapping && _jsx(TableControls, { filters: filters, setFilters: setFilters, totalCount: resultsPage == null ? void 0 : resultsPage.total, loading: isLoading, onReload: handleReload }),\n    tableContent] }\n  );\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}