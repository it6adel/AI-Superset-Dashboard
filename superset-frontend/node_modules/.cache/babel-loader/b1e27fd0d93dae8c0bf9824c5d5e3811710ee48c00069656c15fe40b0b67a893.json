{"ast":null,"code":"import { css as _css } from \"@emotion/react\";function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";} /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport rison from 'rison';\nimport { PureComponent, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { Radio } from 'src/components/Radio';\nimport Card from 'src/components/Card';\nimport Alert from 'src/components/Alert';\nimport Badge from 'src/components/Badge';\nimport {\n  css,\n  isFeatureEnabled,\n  getCurrencySymbol,\n  ensureIsArray,\n  FeatureFlag,\n  styled,\n  SupersetClient,\n  t,\n  withTheme,\n  getClientErrorObject } from\n'@superset-ui/core';\nimport { Select, AsyncSelect, Row, Col } from 'src/components';\nimport { FormLabel } from 'src/components/Form';\nimport Button from 'src/components/Button';\nimport Tabs from 'src/components/Tabs';\nimport CertifiedBadge from 'src/components/CertifiedBadge';\nimport WarningIconWithTooltip from 'src/components/WarningIconWithTooltip';\nimport DatabaseSelector from 'src/components/DatabaseSelector';\nimport Label from 'src/components/Label';\nimport Loading from 'src/components/Loading';\nimport TableSelector from 'src/components/TableSelector';\nimport EditableTitle from 'src/components/EditableTitle';\nimport CheckboxControl from 'src/explore/components/controls/CheckboxControl';\nimport TextControl from 'src/explore/components/controls/TextControl';\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\nimport SpatialControl from 'src/explore/components/controls/SpatialControl';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport Icons from 'src/components/Icons';\nimport CurrencyControl from 'src/explore/components/controls/CurrencyControl';\nimport CollectionTable from './CollectionTable';\nimport Fieldset from './Fieldset';\nimport Field from './Field';\nimport { fetchSyncedColumns, updateColumns } from './utils';import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\n\nconst DatasourceContainer = styled.div`\n  .change-warning {\n    margin: 16px 10px 0;\n    color: ${({ theme }) => theme.colors.warning.base};\n  }\n\n  .change-warning .bold {\n    font-weight: ${({ theme }) => theme.typography.weights.bold};\n  }\n\n  .form-group.has-feedback > .help-block {\n    margin-top: 8px;\n  }\n\n  .form-group.form-group-md {\n    margin-bottom: 8px;\n  }\n`;\n\nconst FlexRowContainer = styled.div`\n  align-items: center;\n  display: flex;\n\n  svg {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledTableTabs = styled(Tabs)`\n  overflow: visible;\n  .ant-tabs-content-holder {\n    overflow: visible;\n  }\n`;\n\nconst StyledBadge = styled(Badge)`\n  .antd5-badge-count {\n    line-height: ${({ theme }) => theme.gridUnit * 4}px;\n    height: ${({ theme }) => theme.gridUnit * 4}px;\n    margin-left: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EditLockContainer = styled.div`\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  display: flex;\n  align-items: center;\n  a {\n    padding: 0 10px;\n  }\n`;\n\nconst ColumnButtonWrapper = styled.div`\n  text-align: right;\n  ${({ theme }) => `margin-bottom: ${theme.gridUnit * 2}px`}\n`;\n\nconst StyledLabelWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  span {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledColumnsTabWrapper = styled.div`\n  .table > tbody > tr > td {\n    vertical-align: middle;\n  }\n\n  .ant-tag {\n    margin-top: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledButtonWrapper = styled.span`\n  ${({ theme }) => `\n    margin-top: ${theme.gridUnit * 3}px;\n    margin-left: ${theme.gridUnit * 3}px;\n    button>span>:first-of-type {\n      margin-right: 0;\n    }\n  `}\n`;\n\nconst sqlTooltipOptions = {\n  placement: 'topRight',\n  title: t(\n    'If changes are made to your SQL query, ' +\n    'columns in your dataset will be synced when saving the dataset.'\n  )\n};\n\nconst checkboxGenerator = (d, onChange) =>\n_jsx(CheckboxControl, { value: d, onChange: onChange });\n\nconst DATA_TYPES = [\n{ value: 'STRING', label: t('STRING') },\n{ value: 'NUMERIC', label: t('NUMERIC') },\n{ value: 'DATETIME', label: t('DATETIME') },\n{ value: 'BOOLEAN', label: t('BOOLEAN') }];\n\n\nconst DATASOURCE_TYPES_ARR = [\n{ key: 'physical', label: t('Physical (table or view)') },\n{ key: 'virtual', label: t('Virtual (SQL)') }];\n\nconst DATASOURCE_TYPES = {};\nDATASOURCE_TYPES_ARR.forEach((o) => {\n  DATASOURCE_TYPES[o.key] = o;\n});var _ref = process.env.NODE_ENV === \"production\" ? { name: \"s5xdrg\", styles: \"display:flex;align-items:center\" } : { name: \"l0hchv-CollectionTabTitle\", styles: \"display:flex;align-items:center;label:CollectionTabTitle;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUErS00iLCJmaWxlIjoiL2hvbWUvYWRlbC9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvY29tcG9uZW50cy9EYXRhc291cmNlL0RhdGFzb3VyY2VFZGl0b3IuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHJpc29uIGZyb20gJ3Jpc29uJztcbmltcG9ydCB7IFB1cmVDb21wb25lbnQsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7IFJhZGlvIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvUmFkaW8nO1xuaW1wb3J0IENhcmQgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ2FyZCc7XG5pbXBvcnQgQWxlcnQgZnJvbSAnc3JjL2NvbXBvbmVudHMvQWxlcnQnO1xuaW1wb3J0IEJhZGdlIGZyb20gJ3NyYy9jb21wb25lbnRzL0JhZGdlJztcbmltcG9ydCB7XG4gIGNzcyxcbiAgaXNGZWF0dXJlRW5hYmxlZCxcbiAgZ2V0Q3VycmVuY3lTeW1ib2wsXG4gIGVuc3VyZUlzQXJyYXksXG4gIEZlYXR1cmVGbGFnLFxuICBzdHlsZWQsXG4gIFN1cGVyc2V0Q2xpZW50LFxuICB0LFxuICB3aXRoVGhlbWUsXG4gIGdldENsaWVudEVycm9yT2JqZWN0LFxufSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyBTZWxlY3QsIEFzeW5jU2VsZWN0LCBSb3csIENvbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCB7IEZvcm1MYWJlbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IFRhYnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFicyc7XG5pbXBvcnQgQ2VydGlmaWVkQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ2VydGlmaWVkQmFkZ2UnO1xuaW1wb3J0IFdhcm5pbmdJY29uV2l0aFRvb2x0aXAgZnJvbSAnc3JjL2NvbXBvbmVudHMvV2FybmluZ0ljb25XaXRoVG9vbHRpcCc7XG5pbXBvcnQgRGF0YWJhc2VTZWxlY3RvciBmcm9tICdzcmMvY29tcG9uZW50cy9EYXRhYmFzZVNlbGVjdG9yJztcbmltcG9ydCBMYWJlbCBmcm9tICdzcmMvY29tcG9uZW50cy9MYWJlbCc7XG5pbXBvcnQgTG9hZGluZyBmcm9tICdzcmMvY29tcG9uZW50cy9Mb2FkaW5nJztcbmltcG9ydCBUYWJsZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYmxlU2VsZWN0b3InO1xuaW1wb3J0IEVkaXRhYmxlVGl0bGUgZnJvbSAnc3JjL2NvbXBvbmVudHMvRWRpdGFibGVUaXRsZSc7XG5pbXBvcnQgQ2hlY2tib3hDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ2hlY2tib3hDb250cm9sJztcbmltcG9ydCBUZXh0Q29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1RleHRDb250cm9sJztcbmltcG9ydCBUZXh0QXJlYUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9UZXh0QXJlYUNvbnRyb2wnO1xuaW1wb3J0IFNwYXRpYWxDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvU3BhdGlhbENvbnRyb2wnO1xuaW1wb3J0IHdpdGhUb2FzdHMgZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVzc2FnZVRvYXN0cy93aXRoVG9hc3RzJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgQ3VycmVuY3lDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ3VycmVuY3lDb250cm9sJztcbmltcG9ydCBDb2xsZWN0aW9uVGFibGUgZnJvbSAnLi9Db2xsZWN0aW9uVGFibGUnO1xuaW1wb3J0IEZpZWxkc2V0IGZyb20gJy4vRmllbGRzZXQnO1xuaW1wb3J0IEZpZWxkIGZyb20gJy4vRmllbGQnO1xuaW1wb3J0IHsgZmV0Y2hTeW5jZWRDb2x1bW5zLCB1cGRhdGVDb2x1bW5zIH0gZnJvbSAnLi91dGlscyc7XG5cbmNvbnN0IERhdGFzb3VyY2VDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICAuY2hhbmdlLXdhcm5pbmcge1xuICAgIG1hcmdpbjogMTZweCAxMHB4IDA7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLndhcm5pbmcuYmFzZX07XG4gIH1cblxuICAuY2hhbmdlLXdhcm5pbmcgLmJvbGQge1xuICAgIGZvbnQtd2VpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLnR5cG9ncmFwaHkud2VpZ2h0cy5ib2xkfTtcbiAgfVxuXG4gIC5mb3JtLWdyb3VwLmhhcy1mZWVkYmFjayA+IC5oZWxwLWJsb2NrIHtcbiAgICBtYXJnaW4tdG9wOiA4cHg7XG4gIH1cblxuICAuZm9ybS1ncm91cC5mb3JtLWdyb3VwLW1kIHtcbiAgICBtYXJnaW4tYm90dG9tOiA4cHg7XG4gIH1cbmA7XG5cbmNvbnN0IEZsZXhSb3dDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBkaXNwbGF5OiBmbGV4O1xuXG4gIHN2ZyB7XG4gICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRUYWJsZVRhYnMgPSBzdHlsZWQoVGFicylgXG4gIG92ZXJmbG93OiB2aXNpYmxlO1xuICAuYW50LXRhYnMtY29udGVudC1ob2xkZXIge1xuICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRCYWRnZSA9IHN0eWxlZChCYWRnZSlgXG4gIC5hbnRkNS1iYWRnZS1jb3VudCB7XG4gICAgbGluZS1oZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA0fXB4O1xuICAgIGhlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgbWFyZ2luLWxlZnQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IEVkaXRMb2NrQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgZm9udC1zaXplOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLnR5cG9ncmFwaHkuc2l6ZXMuc31weDtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgYSB7XG4gICAgcGFkZGluZzogMCAxMHB4O1xuICB9XG5gO1xuXG5jb25zdCBDb2x1bW5CdXR0b25XcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gICR7KHsgdGhlbWUgfSkgPT4gYG1hcmdpbi1ib3R0b206ICR7dGhlbWUuZ3JpZFVuaXQgKiAyfXB4YH1cbmA7XG5cbmNvbnN0IFN0eWxlZExhYmVsV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIHNwYW4ge1xuICAgIG1hcmdpbi1yaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkQ29sdW1uc1RhYldyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICAudGFibGUgPiB0Ym9keSA+IHRyID4gdGQge1xuICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XG4gIH1cblxuICAuYW50LXRhZyB7XG4gICAgbWFyZ2luLXRvcDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkQnV0dG9uV3JhcHBlciA9IHN0eWxlZC5zcGFuYFxuICAkeyh7IHRoZW1lIH0pID0+IGBcbiAgICBtYXJnaW4tdG9wOiAke3RoZW1lLmdyaWRVbml0ICogM31weDtcbiAgICBtYXJnaW4tbGVmdDogJHt0aGVtZS5ncmlkVW5pdCAqIDN9cHg7XG4gICAgYnV0dG9uPnNwYW4+OmZpcnN0LW9mLXR5cGUge1xuICAgICAgbWFyZ2luLXJpZ2h0OiAwO1xuICAgIH1cbiAgYH1cbmA7XG5cbmNvbnN0IHNxbFRvb2x0aXBPcHRpb25zID0ge1xuICBwbGFjZW1lbnQ6ICd0b3BSaWdodCcsXG4gIHRpdGxlOiB0KFxuICAgICdJZiBjaGFuZ2VzIGFyZSBtYWRlIHRvIHlvdXIgU1FMIHF1ZXJ5LCAnICtcbiAgICAgICdjb2x1bW5zIGluIHlvdXIgZGF0YXNldCB3aWxsIGJlIHN5bmNlZCB3aGVuIHNhdmluZyB0aGUgZGF0YXNldC4nLFxuICApLFxufTtcblxuY29uc3QgY2hlY2tib3hHZW5lcmF0b3IgPSAoZCwgb25DaGFuZ2UpID0+IChcbiAgPENoZWNrYm94Q29udHJvbCB2YWx1ZT17ZH0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuKTtcbmNvbnN0IERBVEFfVFlQRVMgPSBbXG4gIHsgdmFsdWU6ICdTVFJJTkcnLCBsYWJlbDogdCgnU1RSSU5HJykgfSxcbiAgeyB2YWx1ZTogJ05VTUVSSUMnLCBsYWJlbDogdCgnTlVNRVJJQycpIH0sXG4gIHsgdmFsdWU6ICdEQVRFVElNRScsIGxhYmVsOiB0KCdEQVRFVElNRScpIH0sXG4gIHsgdmFsdWU6ICdCT09MRUFOJywgbGFiZWw6IHQoJ0JPT0xFQU4nKSB9LFxuXTtcblxuY29uc3QgREFUQVNPVVJDRV9UWVBFU19BUlIgPSBbXG4gIHsga2V5OiAncGh5c2ljYWwnLCBsYWJlbDogdCgnUGh5c2ljYWwgKHRhYmxlIG9yIHZpZXcpJykgfSxcbiAgeyBrZXk6ICd2aXJ0dWFsJywgbGFiZWw6IHQoJ1ZpcnR1YWwgKFNRTCknKSB9LFxuXTtcbmNvbnN0IERBVEFTT1VSQ0VfVFlQRVMgPSB7fTtcbkRBVEFTT1VSQ0VfVFlQRVNfQVJSLmZvckVhY2gobyA9PiB7XG4gIERBVEFTT1VSQ0VfVFlQRVNbby5rZXldID0gbztcbn0pO1xuXG5mdW5jdGlvbiBDb2xsZWN0aW9uVGFiVGl0bGUoeyB0aXRsZSwgY29sbGVjdGlvbiB9KSB7XG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY3NzPXt7IGRpc3BsYXk6ICdmbGV4JywgYWxpZ25JdGVtczogJ2NlbnRlcicgfX1cbiAgICAgIGRhdGEtdGVzdD17YGNvbGxlY3Rpb24tdGFiLSR7dGl0bGV9YH1cbiAgICA+XG4gICAgICB7dGl0bGV9eycgJ31cbiAgICAgIDxTdHlsZWRCYWRnZSBjb3VudD17Y29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMH0gc2hvd1plcm8gLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuQ29sbGVjdGlvblRhYlRpdGxlLnByb3BUeXBlcyA9IHtcbiAgdGl0bGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGNvbGxlY3Rpb246IFByb3BUeXBlcy5hcnJheSxcbn07XG5cbmZ1bmN0aW9uIENvbHVtbkNvbGxlY3Rpb25UYWJsZSh7XG4gIGNvbHVtbnMsXG4gIGRhdGFzb3VyY2UsXG4gIG9uQ29sdW1uc0NoYW5nZSxcbiAgb25EYXRhc291cmNlQ2hhbmdlLFxuICBlZGl0YWJsZUNvbHVtbk5hbWUsXG4gIHNob3dFeHByZXNzaW9uLFxuICBhbGxvd0FkZEl0ZW0sXG4gIGFsbG93RWRpdERhdGFUeXBlLFxuICBpdGVtR2VuZXJhdG9yLFxuICBjb2x1bW5MYWJlbFRvb2x0aXBzLFxufSkge1xuICByZXR1cm4gKFxuICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgIHRhYmxlQ29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBzb3J0Q29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgIGFsbG93QWRkSXRlbT17YWxsb3dBZGRJdGVtfVxuICAgICAgaXRlbUdlbmVyYXRvcj17aXRlbUdlbmVyYXRvcn1cbiAgICAgIGNvbGxlY3Rpb249e2NvbHVtbnN9XG4gICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXtjb2x1bW5MYWJlbFRvb2x0aXBzfVxuICAgICAgc3RpY2t5SGVhZGVyXG4gICAgICBleHBhbmRGaWVsZHNldD17XG4gICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgIDxGaWVsZHNldCBjb21wYWN0PlxuICAgICAgICAgICAge3Nob3dFeHByZXNzaW9uICYmIChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJleHByZXNzaW9uXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMIGV4cHJlc3Npb24nKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJtYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnTGFiZWwnKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0xhYmVsJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHthbGxvd0VkaXREYXRhVHlwZSAmJiAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidHlwZVwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICBhcmlhTGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zPXtEQVRBX1RZUEVTfVxuICAgICAgICAgICAgICAgICAgICBuYW1lPVwidHlwZVwiXG4gICAgICAgICAgICAgICAgICAgIGFsbG93TmV3T3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICBhbGxvd0NsZWFyXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcykgPyAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQWR2YW5jZWQgZGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0FkdmFuY2VkIERhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8PjwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cInB5dGhvbl9kYXRlX2Zvcm1hdFwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdEYXRldGltZSBmb3JtYXQnKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e1xuICAgICAgICAgICAgICAgIC8qIE5vdGUgdGhlIGZyYWdtZW50ZWQgdHJhbnNsYXRpb25zIG1heSBub3Qgd29yay4gKi9cbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAge3QoJ1RoZSBwYXR0ZXJuIG9mIHRpbWVzdGFtcCBmb3JtYXQuIEZvciBzdHJpbmdzIHVzZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2RvY3MucHl0aG9uLm9yZy8yL2xpYnJhcnkvZGF0ZXRpbWUuaHRtbCNzdHJmdGltZS1zdHJwdGltZS1iZWhhdmlvclwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnUHl0aG9uIGRhdGV0aW1lIHN0cmluZyBwYXR0ZXJuJyl9XG4gICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICB7dCgnIGV4cHJlc3Npb24gd2hpY2ggbmVlZHMgdG8gYWRoZXJlIHRvIHRoZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9JU09fODYwMVwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnSVNPIDg2MDEnKX1cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgIHt0KGAgc3RhbmRhcmQgdG8gZW5zdXJlIHRoYXQgdGhlIGxleGljb2dyYXBoaWNhbCBvcmRlcmluZ1xuICAgICAgICAgICAgICAgICAgICAgIGNvaW5jaWRlcyB3aXRoIHRoZSBjaHJvbm9sb2dpY2FsIG9yZGVyaW5nLiBJZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgZm9ybWF0IGRvZXMgbm90IGFkaGVyZSB0byB0aGUgSVNPIDg2MDEgc3RhbmRhcmRcbiAgICAgICAgICAgICAgICAgICAgICB5b3Ugd2lsbCBuZWVkIHRvIGRlZmluZSBhbiBleHByZXNzaW9uIGFuZCB0eXBlIGZvclxuICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWluZyB0aGUgc3RyaW5nIGludG8gYSBkYXRlIG9yIHRpbWVzdGFtcC4gTm90ZVxuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseSB0aW1lIHpvbmVzIGFyZSBub3Qgc3VwcG9ydGVkLiBJZiB0aW1lIGlzIHN0b3JlZFxuICAgICAgICAgICAgICAgICAgICAgIGluIGVwb2NoIGZvcm1hdCwgcHV0IFxcYGVwb2NoX3NcXGAgb3IgXFxgZXBvY2hfbXNcXGAuIElmIG5vIHBhdHRlcm5cbiAgICAgICAgICAgICAgICAgICAgICBpcyBzcGVjaWZpZWQgd2UgZmFsbCBiYWNrIHRvIHVzaW5nIHRoZSBvcHRpb25hbCBkZWZhdWx0cyBvbiBhIHBlclxuICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlL2NvbHVtbiBuYW1lIGxldmVsIHZpYSB0aGUgZXh0cmEgcGFyYW1ldGVyLmApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwicHl0aG9uX2RhdGVfZm9ybWF0XCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiJVktJW0tJWRcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWVkIEJ5Jyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWVkXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25EZXRhaWxzXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICAgIDwvRm9ybUNvbnRhaW5lcj5cbiAgICAgIH1cbiAgICAgIGNvbHVtbkxhYmVscz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCdDb2x1bW4nKSxcbiAgICAgICAgICAgICAgYWR2YW5jZWRfZGF0YV90eXBlOiB0KCdBZHZhbmNlZCBkYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgdHlwZTogdCgnRGF0YSB0eXBlJyksXG4gICAgICAgICAgICAgIGdyb3VwYnk6IHQoJ0lzIGRpbWVuc2lvbicpLFxuICAgICAgICAgICAgICBpc19kdHRtOiB0KCdJcyB0ZW1wb3JhbCcpLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiB0KCdEZWZhdWx0IGRhdGV0aW1lJyksXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IHQoJ0lzIGZpbHRlcmFibGUnKSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJ0NvbHVtbicpLFxuICAgICAgICAgICAgICB0eXBlOiB0KCdEYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgZ3JvdXBieTogdCgnSXMgZGltZW5zaW9uJyksXG4gICAgICAgICAgICAgIGlzX2R0dG06IHQoJ0lzIHRlbXBvcmFsJyksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHQoJ0RlZmF1bHQgZGF0ZXRpbWUnKSxcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdCgnSXMgZmlsdGVyYWJsZScpLFxuICAgICAgICAgICAgfVxuICAgICAgfVxuICAgICAgb25DaGFuZ2U9e29uQ29sdW1uc0NoYW5nZX1cbiAgICAgIGl0ZW1SZW5kZXJlcnM9e1xuICAgICAgICBpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKVxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZVxuICAgICAgICAgICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17dn1cbiAgICAgICAgICAgICAgICAgICAgICBvblNhdmVUaXRsZT17b25JdGVtQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dn1cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6ICh2YWx1ZSwgX29uSXRlbUNoYW5nZSwgX2xhYmVsLCByZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGVja2VkID0gZGF0YXNvdXJjZS5tYWluX2R0dG1fY29sID09PSByZWNvcmQuY29sdW1uX25hbWU7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlzYWJsZWQgPSAhY29sdW1ucy5maW5kKFxuICAgICAgICAgICAgICAgICAgY29sdW1uID0+IGNvbHVtbi5jb2x1bW5fbmFtZSA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICkuaXNfZHR0bTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD17YHJhZGlvLWRlZmF1bHQtZHR0bS0ke3JlY29yZC5jb2x1bW5fbmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtjaGVja2VkfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdHlwZTogZCA9PiAoZCA/IDxMYWJlbD57ZH08L0xhYmVsPiA6IG51bGwpLFxuICAgICAgICAgICAgICBhZHZhbmNlZF9kYXRhX3R5cGU6IGQgPT4gKFxuICAgICAgICAgICAgICAgIDxMYWJlbCBvbkNoYW5nZT17b25Db2x1bW5zQ2hhbmdlfT57ZH08L0xhYmVsPlxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBpc19kdHRtOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGdyb3VwYnk6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDoge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkl0ZW1DaGFuZ2V9IC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt2fVxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogKHZhbHVlLCBfb25JdGVtQ2hhbmdlLCBfbGFiZWwsIHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSBkYXRhc291cmNlLm1haW5fZHR0bV9jb2wgPT09IHJlY29yZC5jb2x1bW5fbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFjb2x1bW5zLmZpbmQoXG4gICAgICAgICAgICAgICAgICBjb2x1bW4gPT4gY29sdW1uLmNvbHVtbl9uYW1lID09PSByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgKS5pc19kdHRtO1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PXtgcmFkaW8tZGVmYXVsdC1kdHRtLSR7cmVjb3JkLmNvbHVtbl9uYW1lfWB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NoZWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+XG4gICAgICAgICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0eXBlOiBkID0+IChkID8gPExhYmVsPntkfTwvTGFiZWw+IDogbnVsbCksXG4gICAgICAgICAgICAgIGlzX2R0dG06IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZ3JvdXBieTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICB9XG4gICAgICB9XG4gICAgLz5cbiAgKTtcbn1cbkNvbHVtbkNvbGxlY3Rpb25UYWJsZS5wcm9wVHlwZXMgPSB7XG4gIGNvbHVtbnM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ29sdW1uc0NoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25EYXRhc291cmNlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBlZGl0YWJsZUNvbHVtbk5hbWU6IFByb3BUeXBlcy5ib29sLFxuICBzaG93RXhwcmVzc2lvbjogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93QWRkSXRlbTogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93RWRpdERhdGFUeXBlOiBQcm9wVHlwZXMuYm9vbCxcbiAgaXRlbUdlbmVyYXRvcjogUHJvcFR5cGVzLmZ1bmMsXG59O1xuQ29sdW1uQ29sbGVjdGlvblRhYmxlLmRlZmF1bHRQcm9wcyA9IHtcbiAgZWRpdGFibGVDb2x1bW5OYW1lOiBmYWxzZSxcbiAgc2hvd0V4cHJlc3Npb246IGZhbHNlLFxuICBhbGxvd0FkZEl0ZW06IGZhbHNlLFxuICBhbGxvd0VkaXREYXRhVHlwZTogZmFsc2UsXG4gIGl0ZW1HZW5lcmF0b3I6ICgpID0+ICh7XG4gICAgY29sdW1uX25hbWU6IHQoJzxuZXcgY29sdW1uPicpLFxuICAgIGZpbHRlcmFibGU6IHRydWUsXG4gICAgZ3JvdXBieTogdHJ1ZSxcbiAgfSksXG59O1xuXG5mdW5jdGlvbiBTdGFja2VkRmllbGQoeyBsYWJlbCwgZm9ybUVsZW1lbnQgfSkge1xuICByZXR1cm4gKFxuICAgIDxkaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICA8c3Ryb25nPntsYWJlbH08L3N0cm9uZz5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj57Zm9ybUVsZW1lbnR9PC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cblN0YWNrZWRGaWVsZC5wcm9wVHlwZXMgPSB7XG4gIGxhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBmb3JtRWxlbWVudDogUHJvcFR5cGVzLm5vZGUsXG59O1xuXG5mdW5jdGlvbiBGb3JtQ29udGFpbmVyKHsgY2hpbGRyZW4gfSkge1xuICByZXR1cm4gPENhcmQgcGFkZGVkPntjaGlsZHJlbn08L0NhcmQ+O1xufVxuXG5Gb3JtQ29udGFpbmVyLnByb3BUeXBlcyA9IHtcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5ub2RlLFxufTtcblxuY29uc3QgcHJvcFR5cGVzID0ge1xuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgYWRkU3VjY2Vzc1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBhZGREYW5nZXJUb2FzdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2V0SXNFZGl0aW5nOiBQcm9wVHlwZXMuZnVuYyxcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgb25DaGFuZ2U6ICgpID0+IHt9LFxuICBzZXRJc0VkaXRpbmc6ICgpID0+IHt9LFxufTtcblxuZnVuY3Rpb24gT3duZXJzU2VsZWN0b3IoeyBkYXRhc291cmNlLCBvbkNoYW5nZSB9KSB7XG4gIGNvbnN0IGxvYWRPcHRpb25zID0gdXNlQ2FsbGJhY2soKHNlYXJjaCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gcmlzb24uZW5jb2RlKHsgZmlsdGVyOiBzZWFyY2gsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgcmV0dXJuIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGF0YXNldC9yZWxhdGVkL293bmVycz9xPSR7cXVlcnl9YCxcbiAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdFxuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5leHRyYS5hY3RpdmUpXG4gICAgICAgIC5tYXAoaXRlbSA9PiAoe1xuICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgIH0pKSxcbiAgICAgIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQsXG4gICAgfSkpO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8QXN5bmNTZWxlY3RcbiAgICAgIGFyaWFMYWJlbD17dCgnU2VsZWN0IG93bmVycycpfVxuICAgICAgbW9kZT1cIm11bHRpcGxlXCJcbiAgICAgIG5hbWU9XCJvd25lcnNcIlxuICAgICAgdmFsdWU9e2RhdGFzb3VyY2Uub3duZXJzfVxuICAgICAgb3B0aW9ucz17bG9hZE9wdGlvbnN9XG4gICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICBoZWFkZXI9ezxGb3JtTGFiZWw+e3QoJ093bmVycycpfTwvRm9ybUxhYmVsPn1cbiAgICAgIGFsbG93Q2xlYXJcbiAgICAvPlxuICApO1xufVxuXG5jbGFzcyBEYXRhc291cmNlRWRpdG9yIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBkYXRhc291cmNlOiB7XG4gICAgICAgIC4uLnByb3BzLmRhdGFzb3VyY2UsXG4gICAgICAgIG93bmVyczogcHJvcHMuZGF0YXNvdXJjZS5vd25lcnMubWFwKG93bmVyID0+ICh7XG4gICAgICAgICAgdmFsdWU6IG93bmVyLnZhbHVlIHx8IG93bmVyLmlkLFxuICAgICAgICAgIGxhYmVsOiBvd25lci5sYWJlbCB8fCBgJHtvd25lci5maXJzdF9uYW1lfSAke293bmVyLmxhc3RfbmFtZX1gLFxuICAgICAgICB9KSksXG4gICAgICAgIG1ldHJpY3M6IHByb3BzLmRhdGFzb3VyY2UubWV0cmljcz8ubWFwKG1ldHJpYyA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWNhdGlvbkRldGFpbHMsXG4gICAgICAgICAgfSA9IG1ldHJpYztcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uOiB7IGRldGFpbHMsIGNlcnRpZmllZF9ieTogY2VydGlmaWVkQnkgfSA9IHt9LFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duLFxuICAgICAgICAgIH0gPSBKU09OLnBhcnNlKG1ldHJpYy5leHRyYSB8fCAne30nKSB8fCB7fTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4ubWV0cmljLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpY2F0aW9uRGV0YWlscyB8fCBkZXRhaWxzLFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duIHx8ICcnLFxuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeSB8fCBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgaXNTcWxhOlxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLmRhdGFzb3VyY2VfdHlwZSA9PT0gJ3RhYmxlJyB8fFxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLnR5cGUgPT09ICd0YWJsZScsXG4gICAgICBpc0VkaXRNb2RlOiBmYWxzZSxcbiAgICAgIGRhdGFiYXNlQ29sdW1uczogcHJvcHMuZGF0YXNvdXJjZS5jb2x1bW5zLmZpbHRlcihjb2wgPT4gIWNvbC5leHByZXNzaW9uKSxcbiAgICAgIGNhbGN1bGF0ZWRDb2x1bW5zOiBwcm9wcy5kYXRhc291cmNlLmNvbHVtbnMuZmlsdGVyKFxuICAgICAgICBjb2wgPT4gISFjb2wuZXhwcmVzc2lvbixcbiAgICAgICksXG4gICAgICBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlLFxuICAgICAgYWN0aXZlVGFiS2V5OiAwLFxuICAgICAgZGF0YXNvdXJjZVR5cGU6IHByb3BzLmRhdGFzb3VyY2Uuc3FsXG4gICAgICAgID8gREFUQVNPVVJDRV9UWVBFUy52aXJ0dWFsLmtleVxuICAgICAgICA6IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5LFxuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25DaGFuZ2VFZGl0TW9kZSA9IHRoaXMub25DaGFuZ2VFZGl0TW9kZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSA9IHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlQ2hhbmdlID0gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhID1cbiAgICAgIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEuYmluZCh0aGlzKTtcbiAgICB0aGlzLnN5bmNNZXRhZGF0YSA9IHRoaXMuc3luY01ldGFkYXRhLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZXRDb2x1bW5zID0gdGhpcy5zZXRDb2x1bW5zLmJpbmQodGhpcyk7XG4gICAgdGhpcy52YWxpZGF0ZUFuZENoYW5nZSA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZVRhYlNlbGVjdCA9IHRoaXMuaGFuZGxlVGFiU2VsZWN0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5jdXJyZW5jaWVzID0gZW5zdXJlSXNBcnJheShwcm9wcy5jdXJyZW5jaWVzKS5tYXAoY3VycmVuY3lDb2RlID0+ICh7XG4gICAgICB2YWx1ZTogY3VycmVuY3lDb2RlLFxuICAgICAgbGFiZWw6IGAke2dldEN1cnJlbmN5U3ltYm9sKHtcbiAgICAgICAgc3ltYm9sOiBjdXJyZW5jeUNvZGUsXG4gICAgICB9KX0gKCR7Y3VycmVuY3lDb2RlfSlgLFxuICAgIH0pKTtcbiAgfVxuXG4gIG9uQ2hhbmdlKCkge1xuICAgIC8vIEVtcHR5aW5nIFNRTCBpZiBcIlBoeXNpY2FsXCIgcmFkaW8gYnV0dG9uIGlzIHNlbGVjdGVkXG4gICAgLy8gQ3VycmVudGx5IHRoZSBsb2dpYyB0byBrbm93IHdoZXRoZXIgdGhlIHNvdXJjZSBpc1xuICAgIC8vIHBoeXNpY2FsIG9yIHZpcnR1YWwgaXMgYmFzZWQgb24gd2hldGhlciBTUUwgaXMgZW1wdHkgb3Igbm90LlxuICAgIGNvbnN0IHsgZGF0YXNvdXJjZVR5cGUsIGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qgc3FsID1cbiAgICAgIGRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSA/ICcnIDogZGF0YXNvdXJjZS5zcWw7XG4gICAgY29uc3QgbmV3RGF0YXNvdXJjZSA9IHtcbiAgICAgIC4uLnRoaXMuc3RhdGUuZGF0YXNvdXJjZSxcbiAgICAgIHNxbCxcbiAgICAgIGNvbHVtbnM6IFsuLi50aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1ucywgLi4udGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc10sXG4gICAgfTtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKG5ld0RhdGFzb3VyY2UsIHRoaXMuc3RhdGUuZXJyb3JzKTtcbiAgfVxuXG4gIG9uQ2hhbmdlRWRpdE1vZGUoKSB7XG4gICAgdGhpcy5wcm9wcy5zZXRJc0VkaXRpbmcoIXRoaXMuc3RhdGUuaXNFZGl0TW9kZSk7XG4gICAgdGhpcy5zZXRTdGF0ZShwcmV2U3RhdGUgPT4gKHsgaXNFZGl0TW9kZTogIXByZXZTdGF0ZS5pc0VkaXRNb2RlIH0pKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCBjYWxsYmFjayA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGF0YXNvdXJjZSB9LCBjYWxsYmFjayk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKGF0dHIsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjsgLy8gaWYgdmFsdWUgaXMgdW5kZWZpbmVkIGRvIG5vdCB1cGRhdGUgc3RhdGVcbiAgICBjb25zdCBkYXRhc291cmNlID0geyAuLi50aGlzLnN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfTtcbiAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgcHJldlN0YXRlID0+ICh7XG4gICAgICAgIGRhdGFzb3VyY2U6IHsgLi4ucHJldlN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfSxcbiAgICAgIH0pLFxuICAgICAgYXR0ciA9PT0gJ3RhYmxlX25hbWUnXG4gICAgICAgID8gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UoZGF0YXNvdXJjZSwgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSlcbiAgICAgICAgOiB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKSxcbiAgICApO1xuICB9XG5cbiAgb25EYXRhc291cmNlVHlwZUNoYW5nZShkYXRhc291cmNlVHlwZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhc291cmNlVHlwZSB9KTtcbiAgfVxuXG4gIHNldENvbHVtbnMob2JqKSB7XG4gICAgLy8gdXBkYXRlIGNhbGN1bGF0ZWRDb2x1bW5zIG9yIGRhdGFiYXNlQ29sdW1uc1xuICAgIHRoaXMuc2V0U3RhdGUob2JqLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKTtcbiAgfVxuXG4gIHZhbGlkYXRlQW5kQ2hhbmdlKCkge1xuICAgIHRoaXMudmFsaWRhdGUodGhpcy5vbkNoYW5nZSk7XG4gIH1cblxuICB0YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSgpIHtcbiAgICB0aGlzLnZhbGlkYXRlKCgpID0+IHtcbiAgICAgIHRoaXMuc3luY01ldGFkYXRhKCk7XG4gICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzeW5jTWV0YWRhdGEoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IHRydWUgfSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG5ld0NvbHMgPSBhd2FpdCBmZXRjaFN5bmNlZENvbHVtbnMoZGF0YXNvdXJjZSk7XG4gICAgICBjb25zdCBjb2x1bW5DaGFuZ2VzID0gdXBkYXRlQ29sdW1ucyhcbiAgICAgICAgZGF0YXNvdXJjZS5jb2x1bW5zLFxuICAgICAgICBuZXdDb2xzLFxuICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdCxcbiAgICAgICk7XG4gICAgICB0aGlzLnNldENvbHVtbnMoe1xuICAgICAgICBkYXRhYmFzZUNvbHVtbnM6IGNvbHVtbkNoYW5nZXMuZmluYWxDb2x1bW5zLmZpbHRlcihcbiAgICAgICAgICBjb2wgPT4gIWNvbC5leHByZXNzaW9uLCAvLyByZW1vdmUgY2FsY3VsYXRlZCBjb2x1bW5zXG4gICAgICAgICksXG4gICAgICB9KTtcbiAgICAgIHRoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0KHQoJ01ldGFkYXRhIGhhcyBiZWVuIHN5bmNlZCcpKTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCB7IGVycm9yOiBjbGllbnRFcnJvciwgc3RhdHVzVGV4dCB9ID1cbiAgICAgICAgYXdhaXQgZ2V0Q2xpZW50RXJyb3JPYmplY3QoZXJyb3IpO1xuICAgICAgdGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdChcbiAgICAgICAgY2xpZW50RXJyb3IgfHwgc3RhdHVzVGV4dCB8fCB0KCdBbiBlcnJvciBoYXMgb2NjdXJyZWQnKSxcbiAgICAgICk7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgbWV0YWRhdGFMb2FkaW5nOiBmYWxzZSB9KTtcbiAgICB9XG4gIH1cblxuICBmaW5kRHVwbGljYXRlcyhhcnIsIGFjY2Vzc29yKSB7XG4gICAgY29uc3Qgc2VlbiA9IHt9O1xuICAgIGNvbnN0IGR1cHMgPSBbXTtcbiAgICBhcnIuZm9yRWFjaChvYmogPT4ge1xuICAgICAgY29uc3QgaXRlbSA9IGFjY2Vzc29yKG9iaik7XG4gICAgICBpZiAoaXRlbSBpbiBzZWVuKSB7XG4gICAgICAgIGR1cHMucHVzaChpdGVtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlZW5baXRlbV0gPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBkdXBzO1xuICB9XG5cbiAgdmFsaWRhdGUoY2FsbGJhY2spIHtcbiAgICBsZXQgZXJyb3JzID0gW107XG4gICAgbGV0IGR1cHM7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgLy8gTG9va2luZyBmb3IgZHVwbGljYXRlIGNvbHVtbl9uYW1lXG4gICAgZHVwcyA9IHRoaXMuZmluZER1cGxpY2F0ZXMoZGF0YXNvdXJjZS5jb2x1bW5zLCBvYmogPT4gb2JqLmNvbHVtbl9uYW1lKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgZHVwcy5tYXAobmFtZSA9PiB0KCdDb2x1bW4gbmFtZSBbJXNdIGlzIGR1cGxpY2F0ZWQnLCBuYW1lKSksXG4gICAgKTtcblxuICAgIC8vIExvb2tpbmcgZm9yIGR1cGxpY2F0ZSBtZXRyaWNfbmFtZVxuICAgIGR1cHMgPSB0aGlzLmZpbmREdXBsaWNhdGVzKGRhdGFzb3VyY2UubWV0cmljcywgb2JqID0+IG9iai5tZXRyaWNfbmFtZSk7XG4gICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChcbiAgICAgIGR1cHMubWFwKG5hbWUgPT4gdCgnTWV0cmljIG5hbWUgWyVzXSBpcyBkdXBsaWNhdGVkJywgbmFtZSkpLFxuICAgICk7XG5cbiAgICAvLyBNYWtpbmcgc3VyZSBjYWxjdWxhdGVkQ29sdW1ucyBoYXZlIGFuIGV4cHJlc3Npb24gZGVmaW5lZFxuICAgIGNvbnN0IG5vRmlsdGVyQ2FsY0NvbHMgPSB0aGlzLnN0YXRlLmNhbGN1bGF0ZWRDb2x1bW5zLmZpbHRlcihcbiAgICAgIGNvbCA9PiAhY29sLmV4cHJlc3Npb24gJiYgIWNvbC5qc29uLFxuICAgICk7XG4gICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChcbiAgICAgIG5vRmlsdGVyQ2FsY0NvbHMubWFwKGNvbCA9PlxuICAgICAgICB0KCdDYWxjdWxhdGVkIGNvbHVtbiBbJXNdIHJlcXVpcmVzIGFuIGV4cHJlc3Npb24nLCBjb2wuY29sdW1uX25hbWUpLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgLy8gdmFsaWRhdGUgY3VycmVuY3kgY29kZVxuICAgIHRyeSB7XG4gICAgICB0aGlzLnN0YXRlLmRhdGFzb3VyY2UubWV0cmljcz8uZm9yRWFjaChcbiAgICAgICAgbWV0cmljID0+XG4gICAgICAgICAgbWV0cmljLmN1cnJlbmN5Py5zeW1ib2wgJiZcbiAgICAgICAgICBuZXcgSW50bC5OdW1iZXJGb3JtYXQoJ2VuLVVTJywge1xuICAgICAgICAgICAgc3R5bGU6ICdjdXJyZW5jeScsXG4gICAgICAgICAgICBjdXJyZW5jeTogbWV0cmljLmN1cnJlbmN5LnN5bWJvbCxcbiAgICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgfSBjYXRjaCB7XG4gICAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFt0KCdJbnZhbGlkIGN1cnJlbmN5IGNvZGUgaW4gc2F2ZWQgbWV0cmljcycpXSk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGVycm9ycyB9LCBjYWxsYmFjayk7XG4gIH1cblxuICBoYW5kbGVUYWJTZWxlY3QoYWN0aXZlVGFiS2V5KSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGFjdGl2ZVRhYktleSB9KTtcbiAgfVxuXG4gIHNvcnRNZXRyaWNzKG1ldHJpY3MpIHtcbiAgICByZXR1cm4gbWV0cmljcy5zb3J0KCh7IGlkOiBhIH0sIHsgaWQ6IGIgfSkgPT4gYiAtIGEpO1xuICB9XG5cbiAgcmVuZGVyU2V0dGluZ3NGaWVsZHNldCgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGaWVsZHNldFxuICAgICAgICB0aXRsZT17dCgnQmFzaWMnKX1cbiAgICAgICAgaXRlbT17ZGF0YXNvdXJjZX1cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICBsYWJlbD17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJtYXJrZG93blwiXG4gICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgZmllbGRLZXk9XCJkZWZhdWx0X2VuZHBvaW50XCJcbiAgICAgICAgICBsYWJlbD17dCgnRGVmYXVsdCBVUkwnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgIGBEZWZhdWx0IFVSTCB0byByZWRpcmVjdCB0byB3aGVuIGFjY2Vzc2luZyBmcm9tIHRoZSBkYXRhc2V0IGxpc3QgcGFnZS5cbiAgICAgICAgICAgIEFjY2VwdHMgcmVsYXRpdmUgVVJMcyBzdWNoIGFzIDxzcGFuIHN0eWxlPeKAnndoaXRlLXNwYWNlOiBub3dyYXA74oCdPi9zdXBlcnNldC9kYXNoYm9hcmQve2lkfS88L3NwYW4+YCxcbiAgICAgICAgICApfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJkZWZhdWx0X2VuZHBvaW50XCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiZmlsdGVyX3NlbGVjdF9lbmFibGVkXCJcbiAgICAgICAgICBsYWJlbD17dCgnQXV0b2NvbXBsZXRlIGZpbHRlcnMnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnV2hldGhlciB0byBwb3B1bGF0ZSBhdXRvY29tcGxldGUgZmlsdGVycyBvcHRpb25zJyl9XG4gICAgICAgICAgY29udHJvbD17PENoZWNrYm94Q29udHJvbCAvPn1cbiAgICAgICAgLz5cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZmV0Y2hfdmFsdWVzX3ByZWRpY2F0ZVwiXG4gICAgICAgICAgICBsYWJlbD17dCgnQXV0b2NvbXBsZXRlIHF1ZXJ5IHByZWRpY2F0ZScpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdXaGVuIHVzaW5nIFwiQXV0b2NvbXBsZXRlIGZpbHRlcnNcIiwgdGhpcyBjYW4gYmUgdXNlZCB0byBpbXByb3ZlIHBlcmZvcm1hbmNlICcgK1xuICAgICAgICAgICAgICAgICdvZiB0aGUgcXVlcnkgZmV0Y2hpbmcgdGhlIHZhbHVlcy4gVXNlIHRoaXMgb3B0aW9uIHRvIGFwcGx5IGEgJyArXG4gICAgICAgICAgICAgICAgJ3ByZWRpY2F0ZSAoV0hFUkUgY2xhdXNlKSB0byB0aGUgcXVlcnkgc2VsZWN0aW5nIHRoZSBkaXN0aW5jdCAnICtcbiAgICAgICAgICAgICAgICAndmFsdWVzIGZyb20gdGhlIHRhYmxlLiBUeXBpY2FsbHkgdGhlIGludGVudCB3b3VsZCBiZSB0byBsaW1pdCB0aGUgc2NhbiAnICtcbiAgICAgICAgICAgICAgICAnYnkgYXBwbHlpbmcgYSByZWxhdGl2ZSB0aW1lIGZpbHRlciBvbiBhIHBhcnRpdGlvbmVkIG9yIGluZGV4ZWQgdGltZS1yZWxhdGVkIGZpZWxkLicsXG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICBsYW5ndWFnZT1cInNxbFwiXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZmV0Y2hfdmFsdWVzX3ByZWRpY2F0ZVwiXG4gICAgICAgICAgICAgICAgbWluTGluZXM9ezV9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cImV4dHJhXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdFeHRyYScpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdFeHRyYSBkYXRhIHRvIHNwZWNpZnkgdGFibGUgbWV0YWRhdGEuIEN1cnJlbnRseSBzdXBwb3J0cyAnICtcbiAgICAgICAgICAgICAgICAnbWV0YWRhdGEgb2YgdGhlIGZvcm1hdDogYHsgXCJjZXJ0aWZpY2F0aW9uXCI6IHsgXCJjZXJ0aWZpZWRfYnlcIjogJyArXG4gICAgICAgICAgICAgICAgJ1wiRGF0YSBQbGF0Zm9ybSBUZWFtXCIsIFwiZGV0YWlsc1wiOiBcIlRoaXMgdGFibGUgaXMgdGhlIHNvdXJjZSBvZiB0cnV0aC5cIiAnICtcbiAgICAgICAgICAgICAgICAnfSwgXCJ3YXJuaW5nX21hcmtkb3duXCI6IFwiVGhpcyBpcyBhIHdhcm5pbmcuXCIgfWAuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImV4dHJhXCJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZT1cImpzb25cIlxuICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8T3duZXJzU2VsZWN0b3JcbiAgICAgICAgICBkYXRhc291cmNlPXtkYXRhc291cmNlfVxuICAgICAgICAgIG9uQ2hhbmdlPXtuZXdPd25lcnMgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UoeyAuLi5kYXRhc291cmNlLCBvd25lcnM6IG5ld093bmVycyB9KTtcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgPC9GaWVsZHNldD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyQWR2YW5jZWRGaWVsZHNldCgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGaWVsZHNldFxuICAgICAgICB0aXRsZT17dCgnQWR2YW5jZWQnKX1cbiAgICAgICAgaXRlbT17ZGF0YXNvdXJjZX1cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cImNhY2hlX3RpbWVvdXRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdDYWNoZSB0aW1lb3V0Jyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnVGhlIGR1cmF0aW9uIG9mIHRpbWUgaW4gc2Vjb25kcyBiZWZvcmUgdGhlIGNhY2hlIGlzIGludmFsaWRhdGVkLiBTZXQgdG8gLTEgdG8gYnlwYXNzIHRoZSBjYWNoZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImNhY2hlX3RpbWVvdXRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgZmllbGRLZXk9XCJvZmZzZXRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdIb3VycyBvZmZzZXQnKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwib2Zmc2V0XCIgLz59XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnVGhlIG51bWJlciBvZiBob3VycywgbmVnYXRpdmUgb3IgcG9zaXRpdmUsIHRvIHNoaWZ0IHRoZSB0aW1lIGNvbHVtbi4gVGhpcyBjYW4gYmUgdXNlZCB0byBtb3ZlIFVUQyB0aW1lIHRvIGxvY2FsIHRpbWUuJyxcbiAgICAgICAgICApfVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJ0ZW1wbGF0ZV9wYXJhbXNcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ1RlbXBsYXRlIHBhcmFtZXRlcnMnKX1cbiAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAnQSBzZXQgb2YgcGFyYW1ldGVycyB0aGF0IGJlY29tZSBhdmFpbGFibGUgaW4gdGhlIHF1ZXJ5IHVzaW5nIEppbmphIHRlbXBsYXRpbmcgc3ludGF4JyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwidGVtcGxhdGVfcGFyYW1zXCIgLz59XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJub3JtYWxpemVfY29sdW1uc1wiXG4gICAgICAgICAgbGFiZWw9e3QoJ05vcm1hbGl6ZSBjb2x1bW4gbmFtZXMnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdBbGxvdyBjb2x1bW4gbmFtZXMgdG8gYmUgY2hhbmdlZCB0byBjYXNlIGluc2Vuc2l0aXZlIGZvcm1hdCwgaWYgc3VwcG9ydGVkIChlLmcuIE9yYWNsZSwgU25vd2ZsYWtlKS4nLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PENoZWNrYm94Q29udHJvbCBjb250cm9sSWQ9XCJub3JtYWxpemVfY29sdW1uc1wiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCJcbiAgICAgICAgICBsYWJlbD17dCgnQWx3YXlzIGZpbHRlciBtYWluIGRhdGV0aW1lIGNvbHVtbicpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgYFdoZW4gdGhlIHNlY29uZGFyeSB0ZW1wb3JhbCBjb2x1bW5zIGFyZSBmaWx0ZXJlZCwgYXBwbHkgdGhlIHNhbWUgZmlsdGVyIHRvIHRoZSBtYWluIGRhdGV0aW1lIGNvbHVtbi5gLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PENoZWNrYm94Q29udHJvbCBjb250cm9sSWQ9XCJhbHdheXNfZmlsdGVyX21haW5fZHR0bVwiIC8+fVxuICAgICAgICAvPlxuICAgICAgPC9GaWVsZHNldD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU3BhdGlhbFRhYigpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBzcGF0aWFscywgYWxsX2NvbHM6IGFsbENvbHMgfSA9IGRhdGFzb3VyY2U7XG4gICAgcmV0dXJuIChcbiAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgdGFiPXs8Q29sbGVjdGlvblRhYlRpdGxlIGNvbGxlY3Rpb249e3NwYXRpYWxzfSB0aXRsZT17dCgnU3BhdGlhbCcpfSAvPn1cbiAgICAgICAga2V5PXs0fVxuICAgICAgPlxuICAgICAgICA8Q29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgdGFibGVDb2x1bW5zPXtbJ25hbWUnLCAnY29uZmlnJ119XG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMsICdzcGF0aWFscycpfVxuICAgICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgICBuYW1lOiB0KCc8bmV3IHNwYXRpYWw+JyksXG4gICAgICAgICAgICB0eXBlOiB0KCc8bm8gdHlwZT4nKSxcbiAgICAgICAgICAgIGNvbmZpZzogbnVsbCxcbiAgICAgICAgICB9KX1cbiAgICAgICAgICBjb2xsZWN0aW9uPXtzcGF0aWFsc31cbiAgICAgICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgICAgICBpdGVtUmVuZGVyZXJzPXt7XG4gICAgICAgICAgICBuYW1lOiAoZCwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPEVkaXRhYmxlVGl0bGUgY2FuRWRpdCB0aXRsZT17ZH0gb25TYXZlVGl0bGU9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIGNvbmZpZzogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICAgIDxTcGF0aWFsQ29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSBjaG9pY2VzPXthbGxDb2xzfSAvPlxuICAgICAgICAgICAgKSxcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlclNvdXJjZUZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdj5cbiAgICAgICAgPEVkaXRMb2NrQ29udGFpbmVyPlxuICAgICAgICAgIDxzcGFuIHJvbGU9XCJidXR0b25cIiB0YWJJbmRleD17MH0gb25DbGljaz17dGhpcy5vbkNoYW5nZUVkaXRNb2RlfT5cbiAgICAgICAgICAgIHt0aGlzLnN0YXRlLmlzRWRpdE1vZGUgPyAoXG4gICAgICAgICAgICAgIDxJY29ucy5VbmxvY2tPdXRsaW5lZFxuICAgICAgICAgICAgICAgIGljb25TaXplPVwieGxcIlxuICAgICAgICAgICAgICAgIGNzcz17dGhlbWUgPT4gY3NzYFxuICAgICAgICAgICAgICAgICAgbWFyZ2luOiBhdXRvICR7dGhlbWUuZ3JpZFVuaXR9cHggYXV0byAwO1xuICAgICAgICAgICAgICAgIGB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8SWNvbnMuTG9ja091dGxpbmVkXG4gICAgICAgICAgICAgICAgaWNvblNpemU9XCJ4bFwiXG4gICAgICAgICAgICAgICAgY3NzPXt0aGVtZSA9PiAoe1xuICAgICAgICAgICAgICAgICAgbWFyZ2luOiBgYXV0byAke3RoZW1lLmdyaWRVbml0fXB4IGF1dG8gMGAsXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICB7IXRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJiAoXG4gICAgICAgICAgICA8ZGl2Pnt0KCdDbGljayB0aGUgbG9jayB0byBtYWtlIGNoYW5nZXMuJyl9PC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmIChcbiAgICAgICAgICAgIDxkaXY+e3QoJ0NsaWNrIHRoZSBsb2NrIHRvIHByZXZlbnQgZnVydGhlciBjaGFuZ2VzLicpfTwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRWRpdExvY2tDb250YWluZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibS1sLTEwIG0tdC0yMCBtLWItMTBcIj5cbiAgICAgICAgICB7REFUQVNPVVJDRV9UWVBFU19BUlIubWFwKHR5cGUgPT4gKFxuICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgIGtleT17dHlwZS5rZXl9XG4gICAgICAgICAgICAgIHZhbHVlPXt0eXBlLmtleX1cbiAgICAgICAgICAgICAgaW5saW5lXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVR5cGVDaGFuZ2UuYmluZCh0aGlzLCB0eXBlLmtleSl9XG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IHR5cGUua2V5fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3R5cGUubGFiZWx9XG4gICAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxGaWVsZHNldCBpdGVtPXtkYXRhc291cmNlfSBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9IGNvbXBhY3Q+XG4gICAgICAgICAge3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMudmlydHVhbC5rZXkgJiYgKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGF0YWJhc2VTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ1ZpcnR1YWwnKX1cbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IG1hcmdpblRvcDogOCB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERhdGFiYXNlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYj17ZGF0YXNvdXJjZT8uZGF0YWJhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0YWxvZz17ZGF0YXNvdXJjZS5jYXRhbG9nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYT17ZGF0YXNvdXJjZS5zY2hlbWF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DYXRhbG9nQ2hhbmdlPXtjYXRhbG9nID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnY2F0YWxvZycsIGNhdGFsb2cpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2NoZW1hQ2hhbmdlPXtzY2hlbWEgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdzY2hlbWEnLCBzY2hlbWEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRGJDaGFuZ2U9e2RhdGFiYXNlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnZGF0YWJhc2UnLCBkYXRhYmFzZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yPXt0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyB3aWR0aDogJ2NhbGMoMTAwJSAtIDM0cHgpJywgbWFyZ2luVG9wOiAtMTYgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInRhYmxlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ05hbWUnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ0YWJsZV9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGFibGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0RhdGFzZXQgbmFtZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMJyl9XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAgICAgICAgICdXaGVuIHNwZWNpZnlpbmcgU1FMLCB0aGUgZGF0YXNvdXJjZSBhY3RzIGFzIGEgdmlldy4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnU3VwZXJzZXQgd2lsbCB1c2UgdGhpcyBzdGF0ZW1lbnQgYXMgYSBzdWJxdWVyeSB3aGlsZSBncm91cGluZyBhbmQgZmlsdGVyaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ29uIHRoZSBnZW5lcmF0ZWQgcGFyZW50IHF1ZXJpZXMuJyxcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5MaW5lcz17MjB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhMaW5lcz17SW5maW5pdHl9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkT25seT17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cImJvdGhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgdG9vbHRpcE9wdGlvbnM9e3NxbFRvb2x0aXBPcHRpb25zfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLnN0YXRlLmRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSAmJiAoXG4gICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidGFibGVTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICBsYWJlbD17dCgnUGh5c2ljYWwnKX1cbiAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyBtYXJnaW5Ub3A6IDggfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPFRhYmxlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyYWJsZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLmRhdGFiYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZV9uYW1lOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuZGF0YWJhc2U/LmRhdGFiYXNlX25hbWUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlPy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSWQ9e2RhdGFzb3VyY2UuZGF0YWJhc2U/LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXJyb3I9e3RoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRhbG9nPXtkYXRhc291cmNlLmNhdGFsb2d9XG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE9e2RhdGFzb3VyY2Uuc2NoZW1hfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsTGFiTW9kZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVZhbHVlPXtkYXRhc291cmNlLnRhYmxlX25hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNhdGFsb2dDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNhdGFsb2cgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdjYXRhbG9nJywgY2F0YWxvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25TY2hlbWFDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHNjaGVtYSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3NjaGVtYScsIHNjaGVtYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25EYkNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZGF0YWJhc2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhYmFzZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25UYWJsZVNlbGVjdENoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGFibGUgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAgICdUaGUgcG9pbnRlciB0byBhIHBoeXNpY2FsIHRhYmxlIChvciB2aWV3KS4gS2VlcCBpbiBtaW5kIHRoYXQgdGhlIGNoYXJ0IGlzICcgK1xuICAgICAgICAgICAgICAgICAgICAgICdhc3NvY2lhdGVkIHRvIHRoaXMgU3VwZXJzZXQgbG9naWNhbCB0YWJsZSwgYW5kIHRoaXMgbG9naWNhbCB0YWJsZSBwb2ludHMgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBwaHlzaWNhbCB0YWJsZSByZWZlcmVuY2VkIGhlcmUuJyxcbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyRXJyb3JzKCkge1xuICAgIGlmICh0aGlzLnN0YXRlLmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8QWxlcnRcbiAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7IG1hcmdpbkJvdHRvbTogdGhlbWUuZ3JpZFVuaXQgKiA0IH0pfVxuICAgICAgICAgIHR5cGU9XCJlcnJvclwiXG4gICAgICAgICAgbWVzc2FnZT17XG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5lcnJvcnMubWFwKGVyciA9PiAoXG4gICAgICAgICAgICAgICAgPGRpdiBrZXk9e2Vycn0+e2Vycn08L2Rpdj5cbiAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIHJldHVybiAoXG4gICAgICA8Q29sbGVjdGlvblRhYmxlXG4gICAgICAgIHRhYmxlQ29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBzb3J0Q29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBjb2x1bW5MYWJlbHM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdCgnTWV0cmljIEtleScpLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogdCgnTGFiZWwnKSxcbiAgICAgICAgICBleHByZXNzaW9uOiB0KCdTUUwgZXhwcmVzc2lvbicpLFxuICAgICAgICB9fVxuICAgICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoXG4gICAgICAgICAgICAnVGhpcyBmaWVsZCBpcyB1c2VkIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgdG8gYXR0YWNoICcgK1xuICAgICAgICAgICAgICAndGhlIG1ldHJpYyB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCBhcyB0aGUgYWxpYXMgaW4gdGhlICcgK1xuICAgICAgICAgICAgICAnU1FMIHF1ZXJ5LicsXG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgZXhwYW5kRmllbGRzZXQ9e1xuICAgICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgPEZpZWxkc2V0IGNvbXBhY3Q+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkM2Zvcm1hdFwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0QzIGZvcm1hdCcpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sIGNvbnRyb2xJZD1cImQzZm9ybWF0XCIgcGxhY2Vob2xkZXI9XCIleS8lbS8lZFwiIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImN1cnJlbmN5XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnTWV0cmljIGN1cnJlbmN5Jyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8Q3VycmVuY3lDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5U2VsZWN0T3ZlcnJpZGVQcm9wcz17e1xuICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0KCdTZWxlY3Qgb3IgdHlwZSBjdXJyZW5jeSBzeW1ib2wnKSxcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VsZWN0QWRkaXRpb25hbFN0eWxlcz17Y3NzYFxuICAgICAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogMzAlO1xuICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAnUGVyc29uIG9yIGdyb3VwIHRoYXQgaGFzIGNlcnRpZmllZCB0aGlzIG1ldHJpYycsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQ2VydGlmaWVkIGJ5Jyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25fZGV0YWlsc1wiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnV2FybmluZycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwid2FybmluZ19tYXJrZG93blwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ09wdGlvbmFsIHdhcm5pbmcgYWJvdXQgdXNlIG9mIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cIndhcm5pbmdfbWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgICAgICA8L0Zvcm1Db250YWluZXI+XG4gICAgICAgIH1cbiAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgYWxsb3dBZGRJdGVtXG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UuYmluZCh0aGlzLCAnbWV0cmljcycpfVxuICAgICAgICBpdGVtR2VuZXJhdG9yPXsoKSA9PiAoe1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KCc8bmV3IG1ldHJpYz4nKSxcbiAgICAgICAgICB2ZXJib3NlX25hbWU6ICcnLFxuICAgICAgICAgIGV4cHJlc3Npb246ICcnLFxuICAgICAgICB9KX1cbiAgICAgICAgaXRlbUNlbGxQcm9wcz17e1xuICAgICAgICAgIGV4cHJlc3Npb246ICgpID0+ICh7XG4gICAgICAgICAgICB3aWR0aDogJzI0MHB4JyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfX1cbiAgICAgICAgaXRlbVJlbmRlcmVycz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiAodiwgb25DaGFuZ2UsIF8sIHJlY29yZCkgPT4gKFxuICAgICAgICAgICAgPEZsZXhSb3dDb250YWluZXI+XG4gICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7cmVjb3JkLndhcm5pbmdfbWFya2Rvd24gJiYgKFxuICAgICAgICAgICAgICAgIDxXYXJuaW5nSWNvbldpdGhUb29sdGlwXG4gICAgICAgICAgICAgICAgICB3YXJuaW5nTWFya2Rvd249e3JlY29yZC53YXJuaW5nX21hcmtkb3dufVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxFZGl0YWJsZVRpdGxlIGNhbkVkaXQgdGl0bGU9e3Z9IG9uU2F2ZVRpdGxlPXtvbkNoYW5nZX0gLz5cbiAgICAgICAgICAgIDwvRmxleFJvd0NvbnRhaW5lcj5cbiAgICAgICAgICApLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dENvbnRyb2wgY2FuRWRpdCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZXhwcmVzc2lvbjogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlPXt2fVxuICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgIGV4dHJhQ2xhc3Nlcz17WydkYXRhc291cmNlLXNxbC1leHByZXNzaW9uJ119XG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIG1pbkxpbmVzPXs1fVxuICAgICAgICAgICAgICB0ZXh0QXJlYVN0eWxlcz17eyBtaW5XaWR0aDogJzIwMHB4JywgbWF4V2lkdGg6ICc0NTBweCcgfX1cbiAgICAgICAgICAgICAgcmVzaXplPVwiYm90aFwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZGVzY3JpcHRpb246ICh2LCBvbkNoYW5nZSwgbGFiZWwpID0+IChcbiAgICAgICAgICAgIDxTdGFja2VkRmllbGRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICBmb3JtRWxlbWVudD17PFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICAgIGQzZm9ybWF0OiAodiwgb25DaGFuZ2UsIGxhYmVsKSA9PiAoXG4gICAgICAgICAgICA8U3RhY2tlZEZpZWxkXG4gICAgICAgICAgICAgIGxhYmVsPXtsYWJlbH1cbiAgICAgICAgICAgICAgZm9ybUVsZW1lbnQ9ezxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPn1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgYWxsb3dEZWxldGVzXG4gICAgICAgIHN0aWNreUhlYWRlclxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSwgYWN0aXZlVGFiS2V5IH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIGNvbnN0IHsgdGhlbWUgfSA9IHRoaXMucHJvcHM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPERhdGFzb3VyY2VDb250YWluZXIgZGF0YS10ZXN0PVwiZGF0YXNvdXJjZS1lZGl0b3JcIj5cbiAgICAgICAge3RoaXMucmVuZGVyRXJyb3JzKCl9XG4gICAgICAgIDxBbGVydFxuICAgICAgICAgIGNzcz17dGhlbWUgPT4gKHsgbWFyZ2luQm90dG9tOiB0aGVtZS5ncmlkVW5pdCAqIDQgfSl9XG4gICAgICAgICAgdHlwZT1cIndhcm5pbmdcIlxuICAgICAgICAgIG1lc3NhZ2U9e1xuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgeycgJ31cbiAgICAgICAgICAgICAgPHN0cm9uZz57dCgnQmUgY2FyZWZ1bC4nKX0gPC9zdHJvbmc+XG4gICAgICAgICAgICAgIHt0KFxuICAgICAgICAgICAgICAgICdDaGFuZ2luZyB0aGVzZSBzZXR0aW5ncyB3aWxsIGFmZmVjdCBhbGwgY2hhcnRzIHVzaW5nIHRoaXMgZGF0YXNldCwgaW5jbHVkaW5nIGNoYXJ0cyBvd25lZCBieSBvdGhlciBwZW9wbGUuJyxcbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICAgPFN0eWxlZFRhYmxlVGFic1xuICAgICAgICAgIGZ1bGxXaWR0aD17ZmFsc2V9XG4gICAgICAgICAgaWQ9XCJ0YWJsZS10YWJzXCJcbiAgICAgICAgICBkYXRhLXRlc3Q9XCJlZGl0LWRhdGFzZXQtdGFic1wiXG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlVGFiU2VsZWN0fVxuICAgICAgICAgIGRlZmF1bHRBY3RpdmVLZXk9e2FjdGl2ZVRhYktleX1cbiAgICAgICAgPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUga2V5PXswfSB0YWI9e3QoJ1NvdXJjZScpfT5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlclNvdXJjZUZpZWxkc2V0KHRoZW1lKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnTWV0cmljcycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXsxfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NvbHVtbnMnKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleT17Mn1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8U3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRCdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBidXR0b25TaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICAgICAgICBidXR0b25TdHlsZT1cInRlcnRpYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5zeW5jTWV0YWRhdGF9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInN5bmMtZnJvbS1zb3VyY2VcIlxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8SWNvbnMuRGF0YWJhc2VPdXRsaW5lZCBpY29uU2l6ZT1cIm1cIiAvPlxuICAgICAgICAgICAgICAgICAgICB7dCgnU3luYyBjb2x1bW5zIGZyb20gc291cmNlJyl9XG4gICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L1N0eWxlZEJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgIDwvQ29sdW1uQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkNvbGxlY3Rpb25UYWJsZVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNvbHVtbnMtdGFibGVcIlxuICAgICAgICAgICAgICAgIGNvbHVtbnM9e3RoaXMuc3RhdGUuZGF0YWJhc2VDb2x1bW5zfVxuICAgICAgICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgICAgICAgb25Db2x1bW5zQ2hhbmdlPXtkYXRhYmFzZUNvbHVtbnMgPT5cbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Q29sdW1ucyh7IGRhdGFiYXNlQ29sdW1ucyB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5tZXRhZGF0YUxvYWRpbmcgJiYgPExvYWRpbmcgLz59XG4gICAgICAgICAgICA8L1N0eWxlZENvbHVtbnNUYWJXcmFwcGVyPlxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgIHRhYj17XG4gICAgICAgICAgICAgIDxDb2xsZWN0aW9uVGFiVGl0bGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uPXt0aGlzLnN0YXRlLmNhbGN1bGF0ZWRDb2x1bW5zfVxuICAgICAgICAgICAgICAgIHRpdGxlPXt0KCdDYWxjdWxhdGVkIGNvbHVtbnMnKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleT17M31cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8U3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5Db2xsZWN0aW9uVGFibGVcbiAgICAgICAgICAgICAgICBjb2x1bW5zPXt0aGlzLnN0YXRlLmNhbGN1bGF0ZWRDb2x1bW5zfVxuICAgICAgICAgICAgICAgIG9uQ29sdW1uc0NoYW5nZT17Y2FsY3VsYXRlZENvbHVtbnMgPT5cbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Q29sdW1ucyh7IGNhbGN1bGF0ZWRDb2x1bW5zIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbHVtbkxhYmVsVG9vbHRpcHM9e3tcbiAgICAgICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KFxuICAgICAgICAgICAgICAgICAgICAnVGhpcyBmaWVsZCBpcyB1c2VkIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgdG8gYXR0YWNoICcgK1xuICAgICAgICAgICAgICAgICAgICAgICd0aGUgY2FsY3VsYXRlZCBkaW1lbnNpb24gdG8gY2hhcnRzLiBJdCBpcyBhbHNvIHVzZWQgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ2FzIHRoZSBhbGlhcyBpbiB0aGUgU1FMIHF1ZXJ5LicsXG4gICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX1cbiAgICAgICAgICAgICAgICBkYXRhc291cmNlPXtkYXRhc291cmNlfVxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZVxuICAgICAgICAgICAgICAgIHNob3dFeHByZXNzaW9uXG4gICAgICAgICAgICAgICAgYWxsb3dBZGRJdGVtXG4gICAgICAgICAgICAgICAgYWxsb3dFZGl0RGF0YVR5cGVcbiAgICAgICAgICAgICAgICBpdGVtR2VuZXJhdG9yPXsoKSA9PiAoe1xuICAgICAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJzxuZXcgY29sdW1uPicpLFxuICAgICAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGdyb3VwYnk6IHRydWUsXG4gICAgICAgICAgICAgICAgICBleHByZXNzaW9uOiB0KCc8ZW50ZXIgU1FMIGV4cHJlc3Npb24gaGVyZT4nKSxcbiAgICAgICAgICAgICAgICAgIF9fZXhwYW5kZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L1N0eWxlZENvbHVtbnNUYWJXcmFwcGVyPlxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUga2V5PXs0fSB0YWI9e3QoJ1NldHRpbmdzJyl9PlxuICAgICAgICAgICAgPFJvdyBndXR0ZXI9ezE2fT5cbiAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgPEZvcm1Db250YWluZXI+e3RoaXMucmVuZGVyU2V0dGluZ3NGaWVsZHNldCgpfTwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICAgIDxGb3JtQ29udGFpbmVyPnt0aGlzLnJlbmRlckFkdmFuY2VkRmllbGRzZXQoKX08L0Zvcm1Db250YWluZXI+XG4gICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgPC9Sb3c+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgIDwvU3R5bGVkVGFibGVUYWJzPlxuICAgICAgPC9EYXRhc291cmNlQ29udGFpbmVyPlxuICAgICk7XG4gIH1cbn1cblxuRGF0YXNvdXJjZUVkaXRvci5kZWZhdWx0UHJvcHMgPSBkZWZhdWx0UHJvcHM7XG5EYXRhc291cmNlRWRpdG9yLnByb3BUeXBlcyA9IHByb3BUeXBlcztcblxuY29uc3QgRGF0YVNvdXJjZUNvbXBvbmVudCA9IHdpdGhUaGVtZShEYXRhc291cmNlRWRpdG9yKTtcblxuZXhwb3J0IGRlZmF1bHQgd2l0aFRvYXN0cyhEYXRhU291cmNlQ29tcG9uZW50KTtcbiJdfQ== */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\n\nfunction CollectionTabTitle({ title, collection }) {\n  return (\n    _jsxs(\"div\", {\n      css: _ref, children: [\n\n\n      title, ' ',\n      _jsx(StyledBadge, { count: collection ? collection.length : 0, showZero: true })] }\n    ));\n\n}\n\nCollectionTabTitle.propTypes = {\n  title: PropTypes.string,\n  collection: PropTypes.array\n};\n\nfunction ColumnCollectionTable({\n  columns,\n  datasource,\n  onColumnsChange,\n  onDatasourceChange,\n  editableColumnName,\n  showExpression,\n  allowAddItem,\n  allowEditDataType,\n  itemGenerator,\n  columnLabelTooltips\n}) {\n  return (\n    _jsx(CollectionTable, {\n      tableColumns:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      [\n      'column_name',\n      'advanced_data_type',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'] :\n\n      [\n      'column_name',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'],\n\n\n      sortColumns:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      [\n      'column_name',\n      'advanced_data_type',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'] :\n\n      [\n      'column_name',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'],\n\n\n      allowDeletes: true,\n      allowAddItem: allowAddItem,\n      itemGenerator: itemGenerator,\n      collection: columns,\n      columnLabelTooltips: columnLabelTooltips,\n      stickyHeader: true,\n      expandFieldset:\n      _jsx(FormContainer, { children:\n        _jsxs(Fieldset, { compact: true, children: [\n          showExpression &&\n          _jsx(Field, {\n            fieldKey: \"expression\",\n            label: t('SQL expression'),\n            control:\n            _jsx(TextAreaControl, {\n              language: \"markdown\",\n              offerEditInModal: false,\n              resize: \"vertical\" }\n            ) }\n\n          ),\n\n          _jsx(Field, {\n            fieldKey: \"verbose_name\",\n            label: t('Label'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"verbose_name\",\n              placeholder: t('Label') }\n            ) }\n\n          ),\n          _jsx(Field, {\n            fieldKey: \"description\",\n            label: t('Description'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"description\",\n              placeholder: t('Description') }\n            ) }\n\n          ),\n          allowEditDataType &&\n          _jsx(Field, {\n            fieldKey: \"type\",\n            label: t('Data type'),\n            control:\n            _jsx(Select, {\n              ariaLabel: t('Data type'),\n              options: DATA_TYPES,\n              name: \"type\",\n              allowNewOptions: true,\n              allowClear: true }\n            ) }\n\n          ),\n\n          isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n          _jsx(Field, {\n            fieldKey: \"advanced_data_type\",\n            label: t('Advanced data type'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"advanced_data_type\",\n              placeholder: t('Advanced Data type') }\n            ) }\n\n          ) :\n\n          _jsx(_Fragment, {}),\n\n          _jsx(Field, {\n            fieldKey: \"python_date_format\",\n            label: t('Datetime format'),\n            description:\n            /* Note the fragmented translations may not work. */\n            _jsxs(\"div\", { children: [\n              t('The pattern of timestamp format. For strings use '),\n              _jsx(\"a\", { href: \"https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior\", children:\n                t('Python datetime string pattern') }\n              ),\n              t(' expression which needs to adhere to the '),\n              _jsx(\"a\", { href: \"https://en.wikipedia.org/wiki/ISO_8601\", children:\n                t('ISO 8601') }\n              ),\n              t(` standard to ensure that the lexicographical ordering\n                      coincides with the chronological ordering. If the\n                      timestamp format does not adhere to the ISO 8601 standard\n                      you will need to define an expression and type for\n                      transforming the string into a date or timestamp. Note\n                      currently time zones are not supported. If time is stored\n                      in epoch format, put \\`epoch_s\\` or \\`epoch_ms\\`. If no pattern\n                      is specified we fall back to using the optional defaults on a per\n                      database/column name level via the extra parameter.`)] }\n            ),\n\n            control:\n            _jsx(TextControl, {\n              controlId: \"python_date_format\",\n              placeholder: \"%Y-%m-%d\" }\n            ) }\n\n          ),\n          _jsx(Field, {\n            fieldKey: \"certified_by\",\n            label: t('Certified By'),\n            description: t('Person or group that has certified this metric'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"certified\",\n              placeholder: t('Certified by') }\n            ) }\n\n          ),\n          _jsx(Field, {\n            fieldKey: \"certification_details\",\n            label: t('Certification details'),\n            description: t('Details of the certification'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"certificationDetails\",\n              placeholder: t('Certification details') }\n            ) }\n\n          )] }\n        ) }\n      ),\n\n      columnLabels:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      {\n        column_name: t('Column'),\n        advanced_data_type: t('Advanced data type'),\n        type: t('Data type'),\n        groupby: t('Is dimension'),\n        is_dttm: t('Is temporal'),\n        main_dttm_col: t('Default datetime'),\n        filterable: t('Is filterable')\n      } :\n      {\n        column_name: t('Column'),\n        type: t('Data type'),\n        groupby: t('Is dimension'),\n        is_dttm: t('Is temporal'),\n        main_dttm_col: t('Default datetime'),\n        filterable: t('Is filterable')\n      },\n\n      onChange: onColumnsChange,\n      itemRenderers:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      {\n        column_name: (v, onItemChange, _, record) =>\n        editableColumnName ?\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          _jsx(EditableTitle, {\n            canEdit: true,\n            title: v,\n            onSaveTitle: onItemChange }\n          )] }\n        ) :\n\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          v] }\n        ),\n\n        main_dttm_col: (value, _onItemChange, _label, record) => {\n          const checked = datasource.main_dttm_col === record.column_name;\n          const disabled = !columns.find(\n            (column) => column.column_name === record.column_name\n          ).is_dttm;\n          return (\n            _jsx(Radio, {\n\n              checked: checked,\n              disabled: disabled,\n              onChange: () =>\n              onDatasourceChange({\n                ...datasource,\n                main_dttm_col: record.column_name\n              }) }\n\n            ));\n\n        },\n        type: (d) => d ? _jsx(Label, { children: d }) : null,\n        advanced_data_type: (d) =>\n        _jsx(Label, { onChange: onColumnsChange, children: d }),\n\n        is_dttm: checkboxGenerator,\n        filterable: checkboxGenerator,\n        groupby: checkboxGenerator\n      } :\n      {\n        column_name: (v, onItemChange, _, record) =>\n        editableColumnName ?\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          _jsx(TextControl, { value: v, onChange: onItemChange })] }\n        ) :\n\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          v] }\n        ),\n\n        main_dttm_col: (value, _onItemChange, _label, record) => {\n          const checked = datasource.main_dttm_col === record.column_name;\n          const disabled = !columns.find(\n            (column) => column.column_name === record.column_name\n          ).is_dttm;\n          return (\n            _jsx(Radio, {\n\n              checked: checked,\n              disabled: disabled,\n              onChange: () =>\n              onDatasourceChange({\n                ...datasource,\n                main_dttm_col: record.column_name\n              }) }\n\n            ));\n\n        },\n        type: (d) => d ? _jsx(Label, { children: d }) : null,\n        is_dttm: checkboxGenerator,\n        filterable: checkboxGenerator,\n        groupby: checkboxGenerator\n      } }\n\n    ));\n\n}\nColumnCollectionTable.propTypes = {\n  columns: PropTypes.array.isRequired,\n  datasource: PropTypes.object.isRequired,\n  onColumnsChange: PropTypes.func.isRequired,\n  onDatasourceChange: PropTypes.func.isRequired,\n  editableColumnName: PropTypes.bool,\n  showExpression: PropTypes.bool,\n  allowAddItem: PropTypes.bool,\n  allowEditDataType: PropTypes.bool,\n  itemGenerator: PropTypes.func\n};\nColumnCollectionTable.defaultProps = {\n  editableColumnName: false,\n  showExpression: false,\n  allowAddItem: false,\n  allowEditDataType: false,\n  itemGenerator: () => ({\n    column_name: t('<new column>'),\n    filterable: true,\n    groupby: true\n  })\n};\n\nfunction StackedField({ label, formElement }) {\n  return (\n    _jsxs(\"div\", { children: [\n      _jsx(\"div\", { children:\n        _jsx(\"strong\", { children: label }) }\n      ),\n      _jsx(\"div\", { children: formElement })] }\n    ));\n\n}\n\nStackedField.propTypes = {\n  label: PropTypes.string,\n  formElement: PropTypes.node\n};\n\nfunction FormContainer({ children }) {\n  return _jsx(Card, { padded: true, children: children });\n}\n\nFormContainer.propTypes = {\n  children: PropTypes.node\n};\n\nconst propTypes = {\n  datasource: PropTypes.object.isRequired,\n  onChange: PropTypes.func,\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  setIsEditing: PropTypes.func\n};\n\nconst defaultProps = {\n  onChange: () => {},\n  setIsEditing: () => {}\n};\n\nfunction OwnersSelector({ datasource, onChange }) {\n  const loadOptions = useCallback((search = '', page, pageSize) => {\n    const query = rison.encode({ filter: search, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dataset/related/owners?q=${query}`\n    }).then((response) => ({\n      data: response.json.result.\n      filter((item) => item.extra.active).\n      map((item) => ({\n        value: item.value,\n        label: item.text\n      })),\n      totalCount: response.json.count\n    }));\n  }, []);\n\n  return (\n    _jsx(AsyncSelect, {\n      ariaLabel: t('Select owners'),\n      mode: \"multiple\",\n      name: \"owners\",\n      value: datasource.owners,\n      options: loadOptions,\n      onChange: onChange,\n      header: _jsx(FormLabel, { children: t('Owners') }),\n      allowClear: true }\n    ));\n\n}var _ref2 = process.env.NODE_ENV === \"production\" ? { name: \"hkh81z\", styles: \"margin-top:8px\" } : { name: \"17jm38f-DatasourceEditor\", styles: \"margin-top:8px;label:DatasourceEditor;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFtZ0M2QiIsImZpbGUiOiIvaG9tZS9hZGVsL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL0RhdGFzb3VyY2UvRGF0YXNvdXJjZUVkaXRvci5qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgQ2FyZCBmcm9tICdzcmMvY29tcG9uZW50cy9DYXJkJztcbmltcG9ydCBBbGVydCBmcm9tICdzcmMvY29tcG9uZW50cy9BbGVydCc7XG5pbXBvcnQgQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQmFkZ2UnO1xuaW1wb3J0IHtcbiAgY3NzLFxuICBpc0ZlYXR1cmVFbmFibGVkLFxuICBnZXRDdXJyZW5jeVN5bWJvbCxcbiAgZW5zdXJlSXNBcnJheSxcbiAgRmVhdHVyZUZsYWcsXG4gIHN0eWxlZCxcbiAgU3VwZXJzZXRDbGllbnQsXG4gIHQsXG4gIHdpdGhUaGVtZSxcbiAgZ2V0Q2xpZW50RXJyb3JPYmplY3QsXG59IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCB7IFNlbGVjdCwgQXN5bmNTZWxlY3QsIFJvdywgQ29sIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMnO1xuaW1wb3J0IHsgRm9ybUxhYmVsIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvRm9ybSc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJ3NyYy9jb21wb25lbnRzL0J1dHRvbic7XG5pbXBvcnQgVGFicyBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJzJztcbmltcG9ydCBDZXJ0aWZpZWRCYWRnZSBmcm9tICdzcmMvY29tcG9uZW50cy9DZXJ0aWZpZWRCYWRnZSc7XG5pbXBvcnQgV2FybmluZ0ljb25XaXRoVG9vbHRpcCBmcm9tICdzcmMvY29tcG9uZW50cy9XYXJuaW5nSWNvbldpdGhUb29sdGlwJztcbmltcG9ydCBEYXRhYmFzZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL0RhdGFiYXNlU2VsZWN0b3InO1xuaW1wb3J0IExhYmVsIGZyb20gJ3NyYy9jb21wb25lbnRzL0xhYmVsJztcbmltcG9ydCBMb2FkaW5nIGZyb20gJ3NyYy9jb21wb25lbnRzL0xvYWRpbmcnO1xuaW1wb3J0IFRhYmxlU2VsZWN0b3IgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFibGVTZWxlY3Rvcic7XG5pbXBvcnQgRWRpdGFibGVUaXRsZSBmcm9tICdzcmMvY29tcG9uZW50cy9FZGl0YWJsZVRpdGxlJztcbmltcG9ydCBDaGVja2JveENvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9DaGVja2JveENvbnRyb2wnO1xuaW1wb3J0IFRleHRDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvVGV4dENvbnRyb2wnO1xuaW1wb3J0IFRleHRBcmVhQ29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1RleHRBcmVhQ29udHJvbCc7XG5pbXBvcnQgU3BhdGlhbENvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9TcGF0aWFsQ29udHJvbCc7XG5pbXBvcnQgd2l0aFRvYXN0cyBmcm9tICdzcmMvY29tcG9uZW50cy9NZXNzYWdlVG9hc3RzL3dpdGhUb2FzdHMnO1xuaW1wb3J0IEljb25zIGZyb20gJ3NyYy9jb21wb25lbnRzL0ljb25zJztcbmltcG9ydCBDdXJyZW5jeUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9DdXJyZW5jeUNvbnRyb2wnO1xuaW1wb3J0IENvbGxlY3Rpb25UYWJsZSBmcm9tICcuL0NvbGxlY3Rpb25UYWJsZSc7XG5pbXBvcnQgRmllbGRzZXQgZnJvbSAnLi9GaWVsZHNldCc7XG5pbXBvcnQgRmllbGQgZnJvbSAnLi9GaWVsZCc7XG5pbXBvcnQgeyBmZXRjaFN5bmNlZENvbHVtbnMsIHVwZGF0ZUNvbHVtbnMgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3QgRGF0YXNvdXJjZUNvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIC5jaGFuZ2Utd2FybmluZyB7XG4gICAgbWFyZ2luOiAxNnB4IDEwcHggMDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMud2FybmluZy5iYXNlfTtcbiAgfVxuXG4gIC5jaGFuZ2Utd2FybmluZyAuYm9sZCB7XG4gICAgZm9udC13ZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS53ZWlnaHRzLmJvbGR9O1xuICB9XG5cbiAgLmZvcm0tZ3JvdXAuaGFzLWZlZWRiYWNrID4gLmhlbHAtYmxvY2sge1xuICAgIG1hcmdpbi10b3A6IDhweDtcbiAgfVxuXG4gIC5mb3JtLWdyb3VwLmZvcm0tZ3JvdXAtbWQge1xuICAgIG1hcmdpbi1ib3R0b206IDhweDtcbiAgfVxuYDtcblxuY29uc3QgRmxleFJvd0NvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGRpc3BsYXk6IGZsZXg7XG5cbiAgc3ZnIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZFRhYmxlVGFicyA9IHN0eWxlZChUYWJzKWBcbiAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIC5hbnQtdGFicy1jb250ZW50LWhvbGRlciB7XG4gICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZEJhZGdlID0gc3R5bGVkKEJhZGdlKWBcbiAgLmFudGQ1LWJhZGdlLWNvdW50IHtcbiAgICBsaW5lLWhlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgaGVpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgRWRpdExvY2tDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBmb250LXNpemU6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS5zaXplcy5zfXB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBhIHtcbiAgICBwYWRkaW5nOiAwIDEwcHg7XG4gIH1cbmA7XG5cbmNvbnN0IENvbHVtbkJ1dHRvbldyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICB0ZXh0LWFsaWduOiByaWdodDtcbiAgJHsoeyB0aGVtZSB9KSA9PiBgbWFyZ2luLWJvdHRvbTogJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHhgfVxuYDtcblxuY29uc3QgU3R5bGVkTGFiZWxXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgc3BhbiB7XG4gICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRDb2x1bW5zVGFiV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIC50YWJsZSA+IHRib2R5ID4gdHIgPiB0ZCB7XG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgfVxuXG4gIC5hbnQtdGFnIHtcbiAgICBtYXJnaW4tdG9wOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRCdXR0b25XcmFwcGVyID0gc3R5bGVkLnNwYW5gXG4gICR7KHsgdGhlbWUgfSkgPT4gYFxuICAgIG1hcmdpbi10b3A6ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4O1xuICAgIG1hcmdpbi1sZWZ0OiAke3RoZW1lLmdyaWRVbml0ICogM31weDtcbiAgICBidXR0b24+c3Bhbj46Zmlyc3Qtb2YtdHlwZSB7XG4gICAgICBtYXJnaW4tcmlnaHQ6IDA7XG4gICAgfVxuICBgfVxuYDtcblxuY29uc3Qgc3FsVG9vbHRpcE9wdGlvbnMgPSB7XG4gIHBsYWNlbWVudDogJ3RvcFJpZ2h0JyxcbiAgdGl0bGU6IHQoXG4gICAgJ0lmIGNoYW5nZXMgYXJlIG1hZGUgdG8geW91ciBTUUwgcXVlcnksICcgK1xuICAgICAgJ2NvbHVtbnMgaW4geW91ciBkYXRhc2V0IHdpbGwgYmUgc3luY2VkIHdoZW4gc2F2aW5nIHRoZSBkYXRhc2V0LicsXG4gICksXG59O1xuXG5jb25zdCBjaGVja2JveEdlbmVyYXRvciA9IChkLCBvbkNoYW5nZSkgPT4gKFxuICA8Q2hlY2tib3hDb250cm9sIHZhbHVlPXtkfSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+XG4pO1xuY29uc3QgREFUQV9UWVBFUyA9IFtcbiAgeyB2YWx1ZTogJ1NUUklORycsIGxhYmVsOiB0KCdTVFJJTkcnKSB9LFxuICB7IHZhbHVlOiAnTlVNRVJJQycsIGxhYmVsOiB0KCdOVU1FUklDJykgfSxcbiAgeyB2YWx1ZTogJ0RBVEVUSU1FJywgbGFiZWw6IHQoJ0RBVEVUSU1FJykgfSxcbiAgeyB2YWx1ZTogJ0JPT0xFQU4nLCBsYWJlbDogdCgnQk9PTEVBTicpIH0sXG5dO1xuXG5jb25zdCBEQVRBU09VUkNFX1RZUEVTX0FSUiA9IFtcbiAgeyBrZXk6ICdwaHlzaWNhbCcsIGxhYmVsOiB0KCdQaHlzaWNhbCAodGFibGUgb3IgdmlldyknKSB9LFxuICB7IGtleTogJ3ZpcnR1YWwnLCBsYWJlbDogdCgnVmlydHVhbCAoU1FMKScpIH0sXG5dO1xuY29uc3QgREFUQVNPVVJDRV9UWVBFUyA9IHt9O1xuREFUQVNPVVJDRV9UWVBFU19BUlIuZm9yRWFjaChvID0+IHtcbiAgREFUQVNPVVJDRV9UWVBFU1tvLmtleV0gPSBvO1xufSk7XG5cbmZ1bmN0aW9uIENvbGxlY3Rpb25UYWJUaXRsZSh7IHRpdGxlLCBjb2xsZWN0aW9uIH0pIHtcbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjc3M9e3sgZGlzcGxheTogJ2ZsZXgnLCBhbGlnbkl0ZW1zOiAnY2VudGVyJyB9fVxuICAgICAgZGF0YS10ZXN0PXtgY29sbGVjdGlvbi10YWItJHt0aXRsZX1gfVxuICAgID5cbiAgICAgIHt0aXRsZX17JyAnfVxuICAgICAgPFN0eWxlZEJhZGdlIGNvdW50PXtjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwfSBzaG93WmVybyAvPlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5Db2xsZWN0aW9uVGFiVGl0bGUucHJvcFR5cGVzID0ge1xuICB0aXRsZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgY29sbGVjdGlvbjogUHJvcFR5cGVzLmFycmF5LFxufTtcblxuZnVuY3Rpb24gQ29sdW1uQ29sbGVjdGlvblRhYmxlKHtcbiAgY29sdW1ucyxcbiAgZGF0YXNvdXJjZSxcbiAgb25Db2x1bW5zQ2hhbmdlLFxuICBvbkRhdGFzb3VyY2VDaGFuZ2UsXG4gIGVkaXRhYmxlQ29sdW1uTmFtZSxcbiAgc2hvd0V4cHJlc3Npb24sXG4gIGFsbG93QWRkSXRlbSxcbiAgYWxsb3dFZGl0RGF0YVR5cGUsXG4gIGl0ZW1HZW5lcmF0b3IsXG4gIGNvbHVtbkxhYmVsVG9vbHRpcHMsXG59KSB7XG4gIHJldHVybiAoXG4gICAgPENvbGxlY3Rpb25UYWJsZVxuICAgICAgdGFibGVDb2x1bW5zPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ2FkdmFuY2VkX2RhdGFfdHlwZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgIH1cbiAgICAgIHNvcnRDb2x1bW5zPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ2FkdmFuY2VkX2RhdGFfdHlwZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgIH1cbiAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgYWxsb3dBZGRJdGVtPXthbGxvd0FkZEl0ZW19XG4gICAgICBpdGVtR2VuZXJhdG9yPXtpdGVtR2VuZXJhdG9yfVxuICAgICAgY29sbGVjdGlvbj17Y29sdW1uc31cbiAgICAgIGNvbHVtbkxhYmVsVG9vbHRpcHM9e2NvbHVtbkxhYmVsVG9vbHRpcHN9XG4gICAgICBzdGlja3lIZWFkZXJcbiAgICAgIGV4cGFuZEZpZWxkc2V0PXtcbiAgICAgICAgPEZvcm1Db250YWluZXI+XG4gICAgICAgICAgPEZpZWxkc2V0IGNvbXBhY3Q+XG4gICAgICAgICAgICB7c2hvd0V4cHJlc3Npb24gJiYgKFxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImV4cHJlc3Npb25cIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdTUUwgZXhwcmVzc2lvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cInZlcmJvc2VfbmFtZVwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdMYWJlbCcpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cInZlcmJvc2VfbmFtZVwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnTGFiZWwnKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAge2FsbG93RWRpdERhdGFUeXBlICYmIChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ0eXBlXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgIGFyaWFMYWJlbD17dCgnRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9e0RBVEFfVFlQRVN9XG4gICAgICAgICAgICAgICAgICAgIG5hbWU9XCJ0eXBlXCJcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dOZXdPcHRpb25zXG4gICAgICAgICAgICAgICAgICAgIGFsbG93Q2xlYXJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKSA/IChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJhZHZhbmNlZF9kYXRhX3R5cGVcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdBZHZhbmNlZCBkYXRhIHR5cGUnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJhZHZhbmNlZF9kYXRhX3R5cGVcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQWR2YW5jZWQgRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDw+PC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwicHl0aG9uX2RhdGVfZm9ybWF0XCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0RhdGV0aW1lIGZvcm1hdCcpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17XG4gICAgICAgICAgICAgICAgLyogTm90ZSB0aGUgZnJhZ21lbnRlZCB0cmFuc2xhdGlvbnMgbWF5IG5vdCB3b3JrLiAqL1xuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICB7dCgnVGhlIHBhdHRlcm4gb2YgdGltZXN0YW1wIGZvcm1hdC4gRm9yIHN0cmluZ3MgdXNlICcpfVxuICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZG9jcy5weXRob24ub3JnLzIvbGlicmFyeS9kYXRldGltZS5odG1sI3N0cmZ0aW1lLXN0cnB0aW1lLWJlaGF2aW9yXCI+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdQeXRob24gZGF0ZXRpbWUgc3RyaW5nIHBhdHRlcm4nKX1cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgIHt0KCcgZXhwcmVzc2lvbiB3aGljaCBuZWVkcyB0byBhZGhlcmUgdG8gdGhlICcpfVxuICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0lTT184NjAxXCI+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdJU08gODYwMScpfVxuICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAge3QoYCBzdGFuZGFyZCB0byBlbnN1cmUgdGhhdCB0aGUgbGV4aWNvZ3JhcGhpY2FsIG9yZGVyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgY29pbmNpZGVzIHdpdGggdGhlIGNocm9ub2xvZ2ljYWwgb3JkZXJpbmcuIElmIHRoZVxuICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcCBmb3JtYXQgZG9lcyBub3QgYWRoZXJlIHRvIHRoZSBJU08gODYwMSBzdGFuZGFyZFxuICAgICAgICAgICAgICAgICAgICAgIHlvdSB3aWxsIG5lZWQgdG8gZGVmaW5lIGFuIGV4cHJlc3Npb24gYW5kIHR5cGUgZm9yXG4gICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtaW5nIHRoZSBzdHJpbmcgaW50byBhIGRhdGUgb3IgdGltZXN0YW1wLiBOb3RlXG4gICAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5IHRpbWUgem9uZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIElmIHRpbWUgaXMgc3RvcmVkXG4gICAgICAgICAgICAgICAgICAgICAgaW4gZXBvY2ggZm9ybWF0LCBwdXQgXFxgZXBvY2hfc1xcYCBvciBcXGBlcG9jaF9tc1xcYC4gSWYgbm8gcGF0dGVyblxuICAgICAgICAgICAgICAgICAgICAgIGlzIHNwZWNpZmllZCB3ZSBmYWxsIGJhY2sgdG8gdXNpbmcgdGhlIG9wdGlvbmFsIGRlZmF1bHRzIG9uIGEgcGVyXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UvY29sdW1uIG5hbWUgbGV2ZWwgdmlhIHRoZSBleHRyYSBwYXJhbWV0ZXIuYCl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJweXRob25fZGF0ZV9mb3JtYXRcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIlWS0lbS0lZFwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpZWQgQnknKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ1BlcnNvbiBvciBncm91cCB0aGF0IGhhcyBjZXJ0aWZpZWQgdGhpcyBtZXRyaWMnKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpZWRcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmllZCBieScpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpY2F0aW9uX2RldGFpbHNcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdEZXRhaWxzIG9mIHRoZSBjZXJ0aWZpY2F0aW9uJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWNhdGlvbkRldGFpbHNcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgICAgPC9Gb3JtQ29udGFpbmVyPlxuICAgICAgfVxuICAgICAgY29sdW1uTGFiZWxzPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJ0NvbHVtbicpLFxuICAgICAgICAgICAgICBhZHZhbmNlZF9kYXRhX3R5cGU6IHQoJ0FkdmFuY2VkIGRhdGEgdHlwZScpLFxuICAgICAgICAgICAgICB0eXBlOiB0KCdEYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgZ3JvdXBieTogdCgnSXMgZGltZW5zaW9uJyksXG4gICAgICAgICAgICAgIGlzX2R0dG06IHQoJ0lzIHRlbXBvcmFsJyksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHQoJ0RlZmF1bHQgZGF0ZXRpbWUnKSxcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdCgnSXMgZmlsdGVyYWJsZScpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDoge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnQ29sdW1uJyksXG4gICAgICAgICAgICAgIHR5cGU6IHQoJ0RhdGEgdHlwZScpLFxuICAgICAgICAgICAgICBncm91cGJ5OiB0KCdJcyBkaW1lbnNpb24nKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogdCgnSXMgdGVtcG9yYWwnKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogdCgnRGVmYXVsdCBkYXRldGltZScpLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0KCdJcyBmaWx0ZXJhYmxlJyksXG4gICAgICAgICAgICB9XG4gICAgICB9XG4gICAgICBvbkNoYW5nZT17b25Db2x1bW5zQ2hhbmdlfVxuICAgICAgaXRlbVJlbmRlcmVycz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiAodiwgb25JdGVtQ2hhbmdlLCBfLCByZWNvcmQpID0+XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lID8gKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxFZGl0YWJsZVRpdGxlXG4gICAgICAgICAgICAgICAgICAgICAgY2FuRWRpdFxuICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXt2fVxuICAgICAgICAgICAgICAgICAgICAgIG9uU2F2ZVRpdGxlPXtvbkl0ZW1DaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt2fVxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogKHZhbHVlLCBfb25JdGVtQ2hhbmdlLCBfbGFiZWwsIHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSBkYXRhc291cmNlLm1haW5fZHR0bV9jb2wgPT09IHJlY29yZC5jb2x1bW5fbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFjb2x1bW5zLmZpbmQoXG4gICAgICAgICAgICAgICAgICBjb2x1bW4gPT4gY29sdW1uLmNvbHVtbl9uYW1lID09PSByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgKS5pc19kdHRtO1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PXtgcmFkaW8tZGVmYXVsdC1kdHRtLSR7cmVjb3JkLmNvbHVtbl9uYW1lfWB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NoZWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+XG4gICAgICAgICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0eXBlOiBkID0+IChkID8gPExhYmVsPntkfTwvTGFiZWw+IDogbnVsbCksXG4gICAgICAgICAgICAgIGFkdmFuY2VkX2RhdGFfdHlwZTogZCA9PiAoXG4gICAgICAgICAgICAgICAgPExhYmVsIG9uQ2hhbmdlPXtvbkNvbHVtbnNDaGFuZ2V9PntkfTwvTGFiZWw+XG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIGlzX2R0dG06IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZ3JvdXBieTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgOiB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiAodiwgb25JdGVtQ2hhbmdlLCBfLCByZWNvcmQpID0+XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lID8gKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uSXRlbUNoYW5nZX0gLz5cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgICB7cmVjb3JkLmlzX2NlcnRpZmllZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPENlcnRpZmllZEJhZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRCeT17cmVjb3JkLmNlcnRpZmllZF9ieX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM9e3JlY29yZC5jZXJ0aWZpY2F0aW9uX2RldGFpbHN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAge3Z9XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiAodmFsdWUsIF9vbkl0ZW1DaGFuZ2UsIF9sYWJlbCwgcmVjb3JkKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hlY2tlZCA9IGRhdGFzb3VyY2UubWFpbl9kdHRtX2NvbCA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpc2FibGVkID0gIWNvbHVtbnMuZmluZChcbiAgICAgICAgICAgICAgICAgIGNvbHVtbiA9PiBjb2x1bW4uY29sdW1uX25hbWUgPT09IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICApLmlzX2R0dG07XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgIDxSYWRpb1xuICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3Q9e2ByYWRpby1kZWZhdWx0LWR0dG0tJHtyZWNvcmQuY29sdW1uX25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Y2hlY2tlZH1cbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGF0YXNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHR5cGU6IGQgPT4gKGQgPyA8TGFiZWw+e2R9PC9MYWJlbD4gOiBudWxsKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBncm91cGJ5OiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAvPlxuICApO1xufVxuQ29sdW1uQ29sbGVjdGlvblRhYmxlLnByb3BUeXBlcyA9IHtcbiAgY29sdW1uczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gIGRhdGFzb3VyY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgb25Db2x1bW5zQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkRhdGFzb3VyY2VDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGVkaXRhYmxlQ29sdW1uTmFtZTogUHJvcFR5cGVzLmJvb2wsXG4gIHNob3dFeHByZXNzaW9uOiBQcm9wVHlwZXMuYm9vbCxcbiAgYWxsb3dBZGRJdGVtOiBQcm9wVHlwZXMuYm9vbCxcbiAgYWxsb3dFZGl0RGF0YVR5cGU6IFByb3BUeXBlcy5ib29sLFxuICBpdGVtR2VuZXJhdG9yOiBQcm9wVHlwZXMuZnVuYyxcbn07XG5Db2x1bW5Db2xsZWN0aW9uVGFibGUuZGVmYXVsdFByb3BzID0ge1xuICBlZGl0YWJsZUNvbHVtbk5hbWU6IGZhbHNlLFxuICBzaG93RXhwcmVzc2lvbjogZmFsc2UsXG4gIGFsbG93QWRkSXRlbTogZmFsc2UsXG4gIGFsbG93RWRpdERhdGFUeXBlOiBmYWxzZSxcbiAgaXRlbUdlbmVyYXRvcjogKCkgPT4gKHtcbiAgICBjb2x1bW5fbmFtZTogdCgnPG5ldyBjb2x1bW4+JyksXG4gICAgZmlsdGVyYWJsZTogdHJ1ZSxcbiAgICBncm91cGJ5OiB0cnVlLFxuICB9KSxcbn07XG5cbmZ1bmN0aW9uIFN0YWNrZWRGaWVsZCh7IGxhYmVsLCBmb3JtRWxlbWVudCB9KSB7XG4gIHJldHVybiAoXG4gICAgPGRpdj5cbiAgICAgIDxkaXY+XG4gICAgICAgIDxzdHJvbmc+e2xhYmVsfTwvc3Ryb25nPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2Pntmb3JtRWxlbWVudH08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuU3RhY2tlZEZpZWxkLnByb3BUeXBlcyA9IHtcbiAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGZvcm1FbGVtZW50OiBQcm9wVHlwZXMubm9kZSxcbn07XG5cbmZ1bmN0aW9uIEZvcm1Db250YWluZXIoeyBjaGlsZHJlbiB9KSB7XG4gIHJldHVybiA8Q2FyZCBwYWRkZWQ+e2NoaWxkcmVufTwvQ2FyZD47XG59XG5cbkZvcm1Db250YWluZXIucHJvcFR5cGVzID0ge1xuICBjaGlsZHJlbjogUHJvcFR5cGVzLm5vZGUsXG59O1xuXG5jb25zdCBwcm9wVHlwZXMgPSB7XG4gIGRhdGFzb3VyY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBhZGRTdWNjZXNzVG9hc3Q6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGFkZERhbmdlclRvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBzZXRJc0VkaXRpbmc6IFByb3BUeXBlcy5mdW5jLFxufTtcblxuY29uc3QgZGVmYXVsdFByb3BzID0ge1xuICBvbkNoYW5nZTogKCkgPT4ge30sXG4gIHNldElzRWRpdGluZzogKCkgPT4ge30sXG59O1xuXG5mdW5jdGlvbiBPd25lcnNTZWxlY3Rvcih7IGRhdGFzb3VyY2UsIG9uQ2hhbmdlIH0pIHtcbiAgY29uc3QgbG9hZE9wdGlvbnMgPSB1c2VDYWxsYmFjaygoc2VhcmNoID0gJycsIHBhZ2UsIHBhZ2VTaXplKSA9PiB7XG4gICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IHNlYXJjaCwgcGFnZSwgcGFnZV9zaXplOiBwYWdlU2l6ZSB9KTtcbiAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXRhc2V0L3JlbGF0ZWQvb3duZXJzP3E9JHtxdWVyeX1gLFxuICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gKHtcbiAgICAgIGRhdGE6IHJlc3BvbnNlLmpzb24ucmVzdWx0XG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLmV4dHJhLmFjdGl2ZSlcbiAgICAgICAgLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgfSkpLFxuICAgICAgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCxcbiAgICB9KSk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gKFxuICAgIDxBc3luY1NlbGVjdFxuICAgICAgYXJpYUxhYmVsPXt0KCdTZWxlY3Qgb3duZXJzJyl9XG4gICAgICBtb2RlPVwibXVsdGlwbGVcIlxuICAgICAgbmFtZT1cIm93bmVyc1wiXG4gICAgICB2YWx1ZT17ZGF0YXNvdXJjZS5vd25lcnN9XG4gICAgICBvcHRpb25zPXtsb2FkT3B0aW9uc31cbiAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgIGhlYWRlcj17PEZvcm1MYWJlbD57dCgnT3duZXJzJyl9PC9Gb3JtTGFiZWw+fVxuICAgICAgYWxsb3dDbGVhclxuICAgIC8+XG4gICk7XG59XG5cbmNsYXNzIERhdGFzb3VyY2VFZGl0b3IgZXh0ZW5kcyBQdXJlQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGRhdGFzb3VyY2U6IHtcbiAgICAgICAgLi4ucHJvcHMuZGF0YXNvdXJjZSxcbiAgICAgICAgb3duZXJzOiBwcm9wcy5kYXRhc291cmNlLm93bmVycy5tYXAob3duZXIgPT4gKHtcbiAgICAgICAgICB2YWx1ZTogb3duZXIudmFsdWUgfHwgb3duZXIuaWQsXG4gICAgICAgICAgbGFiZWw6IG93bmVyLmxhYmVsIHx8IGAke293bmVyLmZpcnN0X25hbWV9ICR7b3duZXIubGFzdF9uYW1lfWAsXG4gICAgICAgIH0pKSxcbiAgICAgICAgbWV0cmljczogcHJvcHMuZGF0YXNvdXJjZS5tZXRyaWNzPy5tYXAobWV0cmljID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5TWV0cmljLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpY2F0aW9uRGV0YWlscyxcbiAgICAgICAgICB9ID0gbWV0cmljO1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb246IHsgZGV0YWlscywgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeSB9ID0ge30sXG4gICAgICAgICAgICB3YXJuaW5nX21hcmtkb3duOiB3YXJuaW5nTWFya2Rvd24sXG4gICAgICAgICAgfSA9IEpTT04ucGFyc2UobWV0cmljLmV4dHJhIHx8ICd7fScpIHx8IHt9O1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5tZXRyaWMsXG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uX2RldGFpbHM6IGNlcnRpZmljYXRpb25EZXRhaWxzIHx8IGRldGFpbHMsXG4gICAgICAgICAgICB3YXJuaW5nX21hcmtkb3duOiB3YXJuaW5nTWFya2Rvd24gfHwgJycsXG4gICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5IHx8IGNlcnRpZmllZEJ5TWV0cmljLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICAgIGVycm9yczogW10sXG4gICAgICBpc1NxbGE6XG4gICAgICAgIHByb3BzLmRhdGFzb3VyY2UuZGF0YXNvdXJjZV90eXBlID09PSAndGFibGUnIHx8XG4gICAgICAgIHByb3BzLmRhdGFzb3VyY2UudHlwZSA9PT0gJ3RhYmxlJyxcbiAgICAgIGlzRWRpdE1vZGU6IGZhbHNlLFxuICAgICAgZGF0YWJhc2VDb2x1bW5zOiBwcm9wcy5kYXRhc291cmNlLmNvbHVtbnMuZmlsdGVyKGNvbCA9PiAhY29sLmV4cHJlc3Npb24pLFxuICAgICAgY2FsY3VsYXRlZENvbHVtbnM6IHByb3BzLmRhdGFzb3VyY2UuY29sdW1ucy5maWx0ZXIoXG4gICAgICAgIGNvbCA9PiAhIWNvbC5leHByZXNzaW9uLFxuICAgICAgKSxcbiAgICAgIG1ldGFkYXRhTG9hZGluZzogZmFsc2UsXG4gICAgICBhY3RpdmVUYWJLZXk6IDAsXG4gICAgICBkYXRhc291cmNlVHlwZTogcHJvcHMuZGF0YXNvdXJjZS5zcWxcbiAgICAgICAgPyBEQVRBU09VUkNFX1RZUEVTLnZpcnR1YWwua2V5XG4gICAgICAgIDogREFUQVNPVVJDRV9UWVBFUy5waHlzaWNhbC5rZXksXG4gICAgfTtcblxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkNoYW5nZUVkaXRNb2RlID0gdGhpcy5vbkNoYW5nZUVkaXRNb2RlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlID0gdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UgPSB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEgPVxuICAgICAgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3luY01ldGFkYXRhID0gdGhpcy5zeW5jTWV0YWRhdGEuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldENvbHVtbnMgPSB0aGlzLnNldENvbHVtbnMuYmluZCh0aGlzKTtcbiAgICB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlID0gdGhpcy52YWxpZGF0ZUFuZENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlVGFiU2VsZWN0ID0gdGhpcy5oYW5kbGVUYWJTZWxlY3QuYmluZCh0aGlzKTtcbiAgICB0aGlzLmN1cnJlbmNpZXMgPSBlbnN1cmVJc0FycmF5KHByb3BzLmN1cnJlbmNpZXMpLm1hcChjdXJyZW5jeUNvZGUgPT4gKHtcbiAgICAgIHZhbHVlOiBjdXJyZW5jeUNvZGUsXG4gICAgICBsYWJlbDogYCR7Z2V0Q3VycmVuY3lTeW1ib2woe1xuICAgICAgICBzeW1ib2w6IGN1cnJlbmN5Q29kZSxcbiAgICAgIH0pfSAoJHtjdXJyZW5jeUNvZGV9KWAsXG4gICAgfSkpO1xuICB9XG5cbiAgb25DaGFuZ2UoKSB7XG4gICAgLy8gRW1wdHlpbmcgU1FMIGlmIFwiUGh5c2ljYWxcIiByYWRpbyBidXR0b24gaXMgc2VsZWN0ZWRcbiAgICAvLyBDdXJyZW50bHkgdGhlIGxvZ2ljIHRvIGtub3cgd2hldGhlciB0aGUgc291cmNlIGlzXG4gICAgLy8gcGh5c2ljYWwgb3IgdmlydHVhbCBpcyBiYXNlZCBvbiB3aGV0aGVyIFNRTCBpcyBlbXB0eSBvciBub3QuXG4gICAgY29uc3QgeyBkYXRhc291cmNlVHlwZSwgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBzcWwgPVxuICAgICAgZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5ID8gJycgOiBkYXRhc291cmNlLnNxbDtcbiAgICBjb25zdCBuZXdEYXRhc291cmNlID0ge1xuICAgICAgLi4udGhpcy5zdGF0ZS5kYXRhc291cmNlLFxuICAgICAgc3FsLFxuICAgICAgY29sdW1uczogWy4uLnRoaXMuc3RhdGUuZGF0YWJhc2VDb2x1bW5zLCAuLi50aGlzLnN0YXRlLmNhbGN1bGF0ZWRDb2x1bW5zXSxcbiAgICB9O1xuICAgIHRoaXMucHJvcHMub25DaGFuZ2UobmV3RGF0YXNvdXJjZSwgdGhpcy5zdGF0ZS5lcnJvcnMpO1xuICB9XG5cbiAgb25DaGFuZ2VFZGl0TW9kZSgpIHtcbiAgICB0aGlzLnByb3BzLnNldElzRWRpdGluZyghdGhpcy5zdGF0ZS5pc0VkaXRNb2RlKTtcbiAgICB0aGlzLnNldFN0YXRlKHByZXZTdGF0ZSA9PiAoeyBpc0VkaXRNb2RlOiAhcHJldlN0YXRlLmlzRWRpdE1vZGUgfSkpO1xuICB9XG5cbiAgb25EYXRhc291cmNlQ2hhbmdlKGRhdGFzb3VyY2UsIGNhbGxiYWNrID0gdGhpcy52YWxpZGF0ZUFuZENoYW5nZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhc291cmNlIH0sIGNhbGxiYWNrKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoYXR0ciwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuOyAvLyBpZiB2YWx1ZSBpcyB1bmRlZmluZWQgZG8gbm90IHVwZGF0ZSBzdGF0ZVxuICAgIGNvbnN0IGRhdGFzb3VyY2UgPSB7IC4uLnRoaXMuc3RhdGUuZGF0YXNvdXJjZSwgW2F0dHJdOiB2YWx1ZSB9O1xuICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICBwcmV2U3RhdGUgPT4gKHtcbiAgICAgICAgZGF0YXNvdXJjZTogeyAuLi5wcmV2U3RhdGUuZGF0YXNvdXJjZSwgW2F0dHJdOiB2YWx1ZSB9LFxuICAgICAgfSksXG4gICAgICBhdHRyID09PSAndGFibGVfbmFtZSdcbiAgICAgICAgPyB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhKVxuICAgICAgICA6IHRoaXMub25EYXRhc291cmNlQ2hhbmdlKGRhdGFzb3VyY2UsIHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpLFxuICAgICk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VUeXBlQ2hhbmdlKGRhdGFzb3VyY2VUeXBlKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRhdGFzb3VyY2VUeXBlIH0pO1xuICB9XG5cbiAgc2V0Q29sdW1ucyhvYmopIHtcbiAgICAvLyB1cGRhdGUgY2FsY3VsYXRlZENvbHVtbnMgb3IgZGF0YWJhc2VDb2x1bW5zXG4gICAgdGhpcy5zZXRTdGF0ZShvYmosIHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpO1xuICB9XG5cbiAgdmFsaWRhdGVBbmRDaGFuZ2UoKSB7XG4gICAgdGhpcy52YWxpZGF0ZSh0aGlzLm9uQ2hhbmdlKTtcbiAgfVxuXG4gIHRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhKCkge1xuICAgIHRoaXMudmFsaWRhdGUoKCkgPT4ge1xuICAgICAgdGhpcy5zeW5jTWV0YWRhdGEoKTtcbiAgICAgIHRoaXMub25DaGFuZ2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHN5bmNNZXRhZGF0YSgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG1ldGFkYXRhTG9hZGluZzogdHJ1ZSB9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3Q29scyA9IGF3YWl0IGZldGNoU3luY2VkQ29sdW1ucyhkYXRhc291cmNlKTtcbiAgICAgIGNvbnN0IGNvbHVtbkNoYW5nZXMgPSB1cGRhdGVDb2x1bW5zKFxuICAgICAgICBkYXRhc291cmNlLmNvbHVtbnMsXG4gICAgICAgIG5ld0NvbHMsXG4gICAgICAgIHRoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0LFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2V0Q29sdW1ucyh7XG4gICAgICAgIGRhdGFiYXNlQ29sdW1uczogY29sdW1uQ2hhbmdlcy5maW5hbENvbHVtbnMuZmlsdGVyKFxuICAgICAgICAgIGNvbCA9PiAhY29sLmV4cHJlc3Npb24sIC8vIHJlbW92ZSBjYWxjdWxhdGVkIGNvbHVtbnNcbiAgICAgICAgKSxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5wcm9wcy5hZGRTdWNjZXNzVG9hc3QodCgnTWV0YWRhdGEgaGFzIGJlZW4gc3luY2VkJykpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1ldGFkYXRhTG9hZGluZzogZmFsc2UgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGNsaWVudEVycm9yLCBzdGF0dXNUZXh0IH0gPVxuICAgICAgICBhd2FpdCBnZXRDbGllbnRFcnJvck9iamVjdChlcnJvcik7XG4gICAgICB0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0KFxuICAgICAgICBjbGllbnRFcnJvciB8fCBzdGF0dXNUZXh0IHx8IHQoJ0FuIGVycm9yIGhhcyBvY2N1cnJlZCcpLFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZpbmREdXBsaWNhdGVzKGFyciwgYWNjZXNzb3IpIHtcbiAgICBjb25zdCBzZWVuID0ge307XG4gICAgY29uc3QgZHVwcyA9IFtdO1xuICAgIGFyci5mb3JFYWNoKG9iaiA9PiB7XG4gICAgICBjb25zdCBpdGVtID0gYWNjZXNzb3Iob2JqKTtcbiAgICAgIGlmIChpdGVtIGluIHNlZW4pIHtcbiAgICAgICAgZHVwcy5wdXNoKGl0ZW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VlbltpdGVtXSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGR1cHM7XG4gIH1cblxuICB2YWxpZGF0ZShjYWxsYmFjaykge1xuICAgIGxldCBlcnJvcnMgPSBbXTtcbiAgICBsZXQgZHVwcztcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAvLyBMb29raW5nIGZvciBkdXBsaWNhdGUgY29sdW1uX25hbWVcbiAgICBkdXBzID0gdGhpcy5maW5kRHVwbGljYXRlcyhkYXRhc291cmNlLmNvbHVtbnMsIG9iaiA9PiBvYmouY29sdW1uX25hbWUpO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBkdXBzLm1hcChuYW1lID0+IHQoJ0NvbHVtbiBuYW1lIFslc10gaXMgZHVwbGljYXRlZCcsIG5hbWUpKSxcbiAgICApO1xuXG4gICAgLy8gTG9va2luZyBmb3IgZHVwbGljYXRlIG1ldHJpY19uYW1lXG4gICAgZHVwcyA9IHRoaXMuZmluZER1cGxpY2F0ZXMoZGF0YXNvdXJjZS5tZXRyaWNzLCBvYmogPT4gb2JqLm1ldHJpY19uYW1lKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgZHVwcy5tYXAobmFtZSA9PiB0KCdNZXRyaWMgbmFtZSBbJXNdIGlzIGR1cGxpY2F0ZWQnLCBuYW1lKSksXG4gICAgKTtcblxuICAgIC8vIE1ha2luZyBzdXJlIGNhbGN1bGF0ZWRDb2x1bW5zIGhhdmUgYW4gZXhwcmVzc2lvbiBkZWZpbmVkXG4gICAgY29uc3Qgbm9GaWx0ZXJDYWxjQ29scyA9IHRoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnMuZmlsdGVyKFxuICAgICAgY29sID0+ICFjb2wuZXhwcmVzc2lvbiAmJiAhY29sLmpzb24sXG4gICAgKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgbm9GaWx0ZXJDYWxjQ29scy5tYXAoY29sID0+XG4gICAgICAgIHQoJ0NhbGN1bGF0ZWQgY29sdW1uIFslc10gcmVxdWlyZXMgYW4gZXhwcmVzc2lvbicsIGNvbC5jb2x1bW5fbmFtZSksXG4gICAgICApLFxuICAgICk7XG5cbiAgICAvLyB2YWxpZGF0ZSBjdXJyZW5jeSBjb2RlXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3RhdGUuZGF0YXNvdXJjZS5tZXRyaWNzPy5mb3JFYWNoKFxuICAgICAgICBtZXRyaWMgPT5cbiAgICAgICAgICBtZXRyaWMuY3VycmVuY3k/LnN5bWJvbCAmJlxuICAgICAgICAgIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZW4tVVMnLCB7XG4gICAgICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JyxcbiAgICAgICAgICAgIGN1cnJlbmN5OiBtZXRyaWMuY3VycmVuY3kuc3ltYm9sLFxuICAgICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoW3QoJ0ludmFsaWQgY3VycmVuY3kgY29kZSBpbiBzYXZlZCBtZXRyaWNzJyldKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHsgZXJyb3JzIH0sIGNhbGxiYWNrKTtcbiAgfVxuXG4gIGhhbmRsZVRhYlNlbGVjdChhY3RpdmVUYWJLZXkpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgYWN0aXZlVGFiS2V5IH0pO1xuICB9XG5cbiAgc29ydE1ldHJpY3MobWV0cmljcykge1xuICAgIHJldHVybiBtZXRyaWNzLnNvcnQoKHsgaWQ6IGEgfSwgeyBpZDogYiB9KSA9PiBiIC0gYSk7XG4gIH1cblxuICByZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdCYXNpYycpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cImRlZmF1bHRfZW5kcG9pbnRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZWZhdWx0IFVSTCcpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgYERlZmF1bHQgVVJMIHRvIHJlZGlyZWN0IHRvIHdoZW4gYWNjZXNzaW5nIGZyb20gdGhlIGRhdGFzZXQgbGlzdCBwYWdlLlxuICAgICAgICAgICAgQWNjZXB0cyByZWxhdGl2ZSBVUkxzIHN1Y2ggYXMgPHNwYW4gc3R5bGU94oCed2hpdGUtc3BhY2U6IG5vd3JhcDvigJ0+L3N1cGVyc2V0L2Rhc2hib2FyZC97aWR9Lzwvc3Bhbj5gLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImRlZmF1bHRfZW5kcG9pbnRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJmaWx0ZXJfc2VsZWN0X2VuYWJsZWRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgZmlsdGVycycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdXaGV0aGVyIHRvIHBvcHVsYXRlIGF1dG9jb21wbGV0ZSBmaWx0ZXJzIG9wdGlvbnMnKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIC8+fVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgcXVlcnkgcHJlZGljYXRlJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ1doZW4gdXNpbmcgXCJBdXRvY29tcGxldGUgZmlsdGVyc1wiLCB0aGlzIGNhbiBiZSB1c2VkIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UgJyArXG4gICAgICAgICAgICAgICAgJ29mIHRoZSBxdWVyeSBmZXRjaGluZyB0aGUgdmFsdWVzLiBVc2UgdGhpcyBvcHRpb24gdG8gYXBwbHkgYSAnICtcbiAgICAgICAgICAgICAgICAncHJlZGljYXRlIChXSEVSRSBjbGF1c2UpIHRvIHRoZSBxdWVyeSBzZWxlY3RpbmcgdGhlIGRpc3RpbmN0ICcgK1xuICAgICAgICAgICAgICAgICd2YWx1ZXMgZnJvbSB0aGUgdGFibGUuIFR5cGljYWxseSB0aGUgaW50ZW50IHdvdWxkIGJlIHRvIGxpbWl0IHRoZSBzY2FuICcgK1xuICAgICAgICAgICAgICAgICdieSBhcHBseWluZyBhIHJlbGF0aXZlIHRpbWUgZmlsdGVyIG9uIGEgcGFydGl0aW9uZWQgb3IgaW5kZXhlZCB0aW1lLXJlbGF0ZWQgZmllbGQuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgICAgICBtaW5MaW5lcz17NX1cbiAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZXh0cmFcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ0V4dHJhJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ0V4dHJhIGRhdGEgdG8gc3BlY2lmeSB0YWJsZSBtZXRhZGF0YS4gQ3VycmVudGx5IHN1cHBvcnRzICcgK1xuICAgICAgICAgICAgICAgICdtZXRhZGF0YSBvZiB0aGUgZm9ybWF0OiBgeyBcImNlcnRpZmljYXRpb25cIjogeyBcImNlcnRpZmllZF9ieVwiOiAnICtcbiAgICAgICAgICAgICAgICAnXCJEYXRhIFBsYXRmb3JtIFRlYW1cIiwgXCJkZXRhaWxzXCI6IFwiVGhpcyB0YWJsZSBpcyB0aGUgc291cmNlIG9mIHRydXRoLlwiICcgK1xuICAgICAgICAgICAgICAgICd9LCBcIndhcm5pbmdfbWFya2Rvd25cIjogXCJUaGlzIGlzIGEgd2FybmluZy5cIiB9YC4nLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZXh0cmFcIlxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxPd25lcnNTZWxlY3RvclxuICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgb25DaGFuZ2U9e25ld093bmVycyA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZSh7IC4uLmRhdGFzb3VyY2UsIG93bmVyczogbmV3T3duZXJzIH0pO1xuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdBZHZhbmNlZCcpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiY2FjaGVfdGltZW91dFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0NhY2hlIHRpbWVvdXQnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgZHVyYXRpb24gb2YgdGltZSBpbiBzZWNvbmRzIGJlZm9yZSB0aGUgY2FjaGUgaXMgaW52YWxpZGF0ZWQuIFNldCB0byAtMSB0byBieXBhc3MgdGhlIGNhY2hlLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwiY2FjaGVfdGltZW91dFwiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cIm9mZnNldFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0hvdXJzIG9mZnNldCcpfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJvZmZzZXRcIiAvPn1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgbnVtYmVyIG9mIGhvdXJzLCBuZWdhdGl2ZSBvciBwb3NpdGl2ZSwgdG8gc2hpZnQgdGhlIHRpbWUgY29sdW1uLiBUaGlzIGNhbiBiZSB1c2VkIHRvIG1vdmUgVVRDIHRpbWUgdG8gbG9jYWwgdGltZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cInRlbXBsYXRlX3BhcmFtc1wiXG4gICAgICAgICAgICBsYWJlbD17dCgnVGVtcGxhdGUgcGFyYW1ldGVycycpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdBIHNldCBvZiBwYXJhbWV0ZXJzIHRoYXQgYmVjb21lIGF2YWlsYWJsZSBpbiB0aGUgcXVlcnkgdXNpbmcgSmluamEgdGVtcGxhdGluZyBzeW50YXgnLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJ0ZW1wbGF0ZV9wYXJhbXNcIiAvPn1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cIm5vcm1hbGl6ZV9jb2x1bW5zXCJcbiAgICAgICAgICBsYWJlbD17dCgnTm9ybWFsaXplIGNvbHVtbiBuYW1lcycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0FsbG93IGNvbHVtbiBuYW1lcyB0byBiZSBjaGFuZ2VkIHRvIGNhc2UgaW5zZW5zaXRpdmUgZm9ybWF0LCBpZiBzdXBwb3J0ZWQgKGUuZy4gT3JhY2xlLCBTbm93Zmxha2UpLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cIm5vcm1hbGl6ZV9jb2x1bW5zXCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiYWx3YXlzX2ZpbHRlcl9tYWluX2R0dG1cIlxuICAgICAgICAgIGxhYmVsPXt0KCdBbHdheXMgZmlsdGVyIG1haW4gZGF0ZXRpbWUgY29sdW1uJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICBgV2hlbiB0aGUgc2Vjb25kYXJ5IHRlbXBvcmFsIGNvbHVtbnMgYXJlIGZpbHRlcmVkLCBhcHBseSB0aGUgc2FtZSBmaWx0ZXIgdG8gdGhlIG1haW4gZGF0ZXRpbWUgY29sdW1uLmAsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCIgLz59XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJTcGF0aWFsVGFiKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IHNwYXRpYWxzLCBhbGxfY29sczogYWxsQ29scyB9ID0gZGF0YXNvdXJjZTtcbiAgICByZXR1cm4gKFxuICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICB0YWI9ezxDb2xsZWN0aW9uVGFiVGl0bGUgY29sbGVjdGlvbj17c3BhdGlhbHN9IHRpdGxlPXt0KCdTcGF0aWFsJyl9IC8+fVxuICAgICAgICBrZXk9ezR9XG4gICAgICA+XG4gICAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgICB0YWJsZUNvbHVtbnM9e1snbmFtZScsICdjb25maWcnXX1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcywgJ3NwYXRpYWxzJyl9XG4gICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHQoJzxuZXcgc3BhdGlhbD4nKSxcbiAgICAgICAgICAgIHR5cGU6IHQoJzxubyB0eXBlPicpLFxuICAgICAgICAgICAgY29uZmlnOiBudWxsLFxuICAgICAgICAgIH0pfVxuICAgICAgICAgIGNvbGxlY3Rpb249e3NwYXRpYWxzfVxuICAgICAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgICAgIGl0ZW1SZW5kZXJlcnM9e3tcbiAgICAgICAgICAgIG5hbWU6IChkLCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZSBjYW5FZGl0IHRpdGxlPXtkfSBvblNhdmVUaXRsZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgY29uZmlnOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPFNwYXRpYWxDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IGNob2ljZXM9e2FsbENvbHN9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU291cmNlRmllbGRzZXQoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICA8RWRpdExvY2tDb250YWluZXI+XG4gICAgICAgICAgPHNwYW4gcm9sZT1cImJ1dHRvblwiIHRhYkluZGV4PXswfSBvbkNsaWNrPXt0aGlzLm9uQ2hhbmdlRWRpdE1vZGV9PlxuICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNFZGl0TW9kZSA/IChcbiAgICAgICAgICAgICAgPEljb25zLlVubG9ja091dGxpbmVkXG4gICAgICAgICAgICAgICAgaWNvblNpemU9XCJ4bFwiXG4gICAgICAgICAgICAgICAgY3NzPXt0aGVtZSA9PiBjc3NgXG4gICAgICAgICAgICAgICAgICBtYXJnaW46IGF1dG8gJHt0aGVtZS5ncmlkVW5pdH1weCBhdXRvIDA7XG4gICAgICAgICAgICAgICAgYH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDxJY29ucy5Mb2NrT3V0bGluZWRcbiAgICAgICAgICAgICAgICBpY29uU2l6ZT1cInhsXCJcbiAgICAgICAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7XG4gICAgICAgICAgICAgICAgICBtYXJnaW46IGBhdXRvICR7dGhlbWUuZ3JpZFVuaXR9cHggYXV0byAwYCxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgIHshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmIChcbiAgICAgICAgICAgIDxkaXY+e3QoJ0NsaWNrIHRoZSBsb2NrIHRvIG1ha2UgY2hhbmdlcy4nKX08L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgPGRpdj57dCgnQ2xpY2sgdGhlIGxvY2sgdG8gcHJldmVudCBmdXJ0aGVyIGNoYW5nZXMuJyl9PC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9FZGl0TG9ja0NvbnRhaW5lcj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtLWwtMTAgbS10LTIwIG0tYi0xMFwiPlxuICAgICAgICAgIHtEQVRBU09VUkNFX1RZUEVTX0FSUi5tYXAodHlwZSA9PiAoXG4gICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAga2V5PXt0eXBlLmtleX1cbiAgICAgICAgICAgICAgdmFsdWU9e3R5cGUua2V5fVxuICAgICAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlVHlwZUNoYW5nZS5iaW5kKHRoaXMsIHR5cGUua2V5KX1cbiAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5zdGF0ZS5kYXRhc291cmNlVHlwZSA9PT0gdHlwZS5rZXl9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7dHlwZS5sYWJlbH1cbiAgICAgICAgICAgIDwvUmFkaW8+XG4gICAgICAgICAgKSl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8aHIgLz5cbiAgICAgICAgPEZpZWxkc2V0IGl0ZW09e2RhdGFzb3VyY2V9IG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX0gY29tcGFjdD5cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5kYXRhc291cmNlVHlwZSA9PT0gREFUQVNPVVJDRV9UWVBFUy52aXJ0dWFsLmtleSAmJiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkYXRhYmFzZVNlbGVjdG9yXCJcbiAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnVmlydHVhbCcpfVxuICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjc3M9e3sgbWFyZ2luVG9wOiA4IH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RGF0YWJhc2VTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiPXtkYXRhc291cmNlPy5kYXRhYmFzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRhbG9nPXtkYXRhc291cmNlLmNhdGFsb2d9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hPXtkYXRhc291cmNlLnNjaGVtYX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNhdGFsb2dDaGFuZ2U9e2NhdGFsb2cgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdjYXRhbG9nJywgY2F0YWxvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TY2hlbWFDaGFuZ2U9e3NjaGVtYSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3NjaGVtYScsIHNjaGVtYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25EYkNoYW5nZT17ZGF0YWJhc2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdkYXRhYmFzZScsIGRhdGFiYXNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXJyb3I9e3RoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IHdpZHRoOiAnY2FsYygxMDAlIC0gMzRweCknLCBtYXJnaW5Ub3A6IC0xNiB9fT5cbiAgICAgICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidGFibGVfbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnTmFtZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cInRhYmxlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0YWJsZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3RhYmxlX25hbWUnLCB0YWJsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGF0YXNldCBuYW1lJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInNxbFwiXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdTUUwnKX1cbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAgICAgJ1doZW4gc3BlY2lmeWluZyBTUUwsIHRoZSBkYXRhc291cmNlIGFjdHMgYXMgYSB2aWV3LiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdTdXBlcnNldCB3aWxsIHVzZSB0aGlzIHN0YXRlbWVudCBhcyBhIHN1YnF1ZXJ5IHdoaWxlIGdyb3VwaW5nIGFuZCBmaWx0ZXJpbmcgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnb24gdGhlIGdlbmVyYXRlZCBwYXJlbnQgcXVlcmllcy4nLFxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cInNxbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkxpbmVzPXsyMH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1heExpbmVzPXtJbmZpbml0eX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplPVwiYm90aFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwT3B0aW9ucz17c3FsVG9vbHRpcE9wdGlvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgICAge3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5ICYmIChcbiAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ0YWJsZVNlbGVjdG9yXCJcbiAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdQaHlzaWNhbCcpfVxuICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IG1hcmdpblRvcDogOCB9fT5cbiAgICAgICAgICAgICAgICAgICAgICA8VGFibGVTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJhYmxlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UuZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlX25hbWU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXNvdXJjZS5kYXRhYmFzZT8uZGF0YWJhc2VfbmFtZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuZGF0YWJhc2U/Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGJJZD17ZGF0YXNvdXJjZS5kYXRhYmFzZT8uaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcj17dGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGFsb2c9e2RhdGFzb3VyY2UuY2F0YWxvZ31cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYT17ZGF0YXNvdXJjZS5zY2hlbWF9XG4gICAgICAgICAgICAgICAgICAgICAgICBzcWxMYWJNb2RlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlVmFsdWU9e2RhdGFzb3VyY2UudGFibGVfbmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2F0YWxvZ0NoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY2F0YWxvZyA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ2NhdGFsb2cnLCBjYXRhbG9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblNjaGVtYUNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gc2NoZW1hID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnc2NoZW1hJywgc2NoZW1hKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkRiQ2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBkYXRhYmFzZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGFiYXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblRhYmxlU2VsZWN0Q2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0YWJsZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3RhYmxlX25hbWUnLCB0YWJsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgICAgICAgJ1RoZSBwb2ludGVyIHRvIGEgcGh5c2ljYWwgdGFibGUgKG9yIHZpZXcpLiBLZWVwIGluIG1pbmQgdGhhdCB0aGUgY2hhcnQgaXMgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ2Fzc29jaWF0ZWQgdG8gdGhpcyBTdXBlcnNldCBsb2dpY2FsIHRhYmxlLCBhbmQgdGhpcyBsb2dpY2FsIHRhYmxlIHBvaW50cyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAndGhlIHBoeXNpY2FsIHRhYmxlIHJlZmVyZW5jZWQgaGVyZS4nLFxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJFcnJvcnMoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUuZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxBbGVydFxuICAgICAgICAgIGNzcz17dGhlbWUgPT4gKHsgbWFyZ2luQm90dG9tOiB0aGVtZS5ncmlkVW5pdCAqIDQgfSl9XG4gICAgICAgICAgdHlwZT1cImVycm9yXCJcbiAgICAgICAgICBtZXNzYWdlPXtcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmVycm9ycy5tYXAoZXJyID0+IChcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17ZXJyfT57ZXJyfTwvZGl2PlxuICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgIDwvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmVuZGVyTWV0cmljQ29sbGVjdGlvbigpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBtZXRyaWNzIH0gPSBkYXRhc291cmNlO1xuICAgIGNvbnN0IHNvcnRlZE1ldHJpY3MgPSBtZXRyaWNzPy5sZW5ndGggPyB0aGlzLnNvcnRNZXRyaWNzKG1ldHJpY3MpIDogW107XG4gICAgcmV0dXJuIChcbiAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgdGFibGVDb2x1bW5zPXtbJ21ldHJpY19uYW1lJywgJ3ZlcmJvc2VfbmFtZScsICdleHByZXNzaW9uJ119XG4gICAgICAgIHNvcnRDb2x1bW5zPXtbJ21ldHJpY19uYW1lJywgJ3ZlcmJvc2VfbmFtZScsICdleHByZXNzaW9uJ119XG4gICAgICAgIGNvbHVtbkxhYmVscz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KCdNZXRyaWMgS2V5JyksXG4gICAgICAgICAgdmVyYm9zZV9uYW1lOiB0KCdMYWJlbCcpLFxuICAgICAgICAgIGV4cHJlc3Npb246IHQoJ1NRTCBleHByZXNzaW9uJyksXG4gICAgICAgIH19XG4gICAgICAgIGNvbHVtbkxhYmVsVG9vbHRpcHM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdChcbiAgICAgICAgICAgICdUaGlzIGZpZWxkIGlzIHVzZWQgYXMgYSB1bmlxdWUgaWRlbnRpZmllciB0byBhdHRhY2ggJyArXG4gICAgICAgICAgICAgICd0aGUgbWV0cmljIHRvIGNoYXJ0cy4gSXQgaXMgYWxzbyB1c2VkIGFzIHRoZSBhbGlhcyBpbiB0aGUgJyArXG4gICAgICAgICAgICAgICdTUUwgcXVlcnkuJyxcbiAgICAgICAgICApLFxuICAgICAgICB9fVxuICAgICAgICBleHBhbmRGaWVsZHNldD17XG4gICAgICAgICAgPEZvcm1Db250YWluZXI+XG4gICAgICAgICAgICA8RmllbGRzZXQgY29tcGFjdD5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImQzZm9ybWF0XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnRDMgZm9ybWF0Jyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2wgY29udHJvbElkPVwiZDNmb3JtYXRcIiBwbGFjZWhvbGRlcj1cIiV5LyVtLyVkXCIgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY3VycmVuY3lcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdNZXRyaWMgY3VycmVuY3knKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxDdXJyZW5jeUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3lTZWxlY3RPdmVycmlkZVByb3BzPXt7XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IHQoJ1NlbGVjdCBvciB0eXBlIGN1cnJlbmN5IHN5bWJvbCcpLFxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBzeW1ib2xTZWxlY3RBZGRpdGlvbmFsU3R5bGVzPXtjc3NgXG4gICAgICAgICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAzMCU7XG4gICAgICAgICAgICAgICAgICAgIGB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmllZCBieScpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWVkX2J5XCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgICAgICdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgbWV0cmljJyxcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpY2F0aW9uX2RldGFpbHNcIlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdEZXRhaWxzIG9mIHRoZSBjZXJ0aWZpY2F0aW9uJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdXYXJuaW5nJyl9XG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ3YXJuaW5nX21hcmtkb3duXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnT3B0aW9uYWwgd2FybmluZyBhYm91dCB1c2Ugb2YgdGhpcyBtZXRyaWMnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwid2FybmluZ19tYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwibWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L0ZpZWxkc2V0PlxuICAgICAgICAgIDwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgfVxuICAgICAgICBjb2xsZWN0aW9uPXtzb3J0ZWRNZXRyaWNzfVxuICAgICAgICBhbGxvd0FkZEl0ZW1cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMsICdtZXRyaWNzJyl9XG4gICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoJzxuZXcgbWV0cmljPicpLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogJycsXG4gICAgICAgICAgZXhwcmVzc2lvbjogJycsXG4gICAgICAgIH0pfVxuICAgICAgICBpdGVtQ2VsbFByb3BzPXt7XG4gICAgICAgICAgZXhwcmVzc2lvbjogKCkgPT4gKHtcbiAgICAgICAgICAgIHdpZHRoOiAnMjQwcHgnLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9fVxuICAgICAgICBpdGVtUmVuZGVyZXJzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6ICh2LCBvbkNoYW5nZSwgXywgcmVjb3JkKSA9PiAoXG4gICAgICAgICAgICA8RmxleFJvd0NvbnRhaW5lcj5cbiAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtyZWNvcmQud2FybmluZ19tYXJrZG93biAmJiAoXG4gICAgICAgICAgICAgICAgPFdhcm5pbmdJY29uV2l0aFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgIHdhcm5pbmdNYXJrZG93bj17cmVjb3JkLndhcm5pbmdfbWFya2Rvd259XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPEVkaXRhYmxlVGl0bGUgY2FuRWRpdCB0aXRsZT17dn0gb25TYXZlVGl0bGU9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICAgPC9GbGV4Um93Q29udGFpbmVyPlxuICAgICAgICAgICksXG4gICAgICAgICAgdmVyYm9zZV9uYW1lOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgIDxUZXh0Q29udHJvbCBjYW5FZGl0IHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgICBleHByZXNzaW9uOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgY2FuRWRpdFxuICAgICAgICAgICAgICBpbml0aWFsVmFsdWU9e3Z9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzPXtbJ2RhdGFzb3VyY2Utc3FsLWV4cHJlc3Npb24nXX1cbiAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJzcWxcIlxuICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgbWluTGluZXM9ezV9XG4gICAgICAgICAgICAgIHRleHRBcmVhU3R5bGVzPXt7IG1pbldpZHRoOiAnMjAwcHgnLCBtYXhXaWR0aDogJzQ1MHB4JyB9fVxuICAgICAgICAgICAgICByZXNpemU9XCJib3RoXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogKHYsIG9uQ2hhbmdlLCBsYWJlbCkgPT4gKFxuICAgICAgICAgICAgPFN0YWNrZWRGaWVsZFxuICAgICAgICAgICAgICBsYWJlbD17bGFiZWx9XG4gICAgICAgICAgICAgIGZvcm1FbGVtZW50PXs8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkNoYW5nZX0gLz59XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZDNmb3JtYXQ6ICh2LCBvbkNoYW5nZSwgbGFiZWwpID0+IChcbiAgICAgICAgICAgIDxTdGFja2VkRmllbGRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICBmb3JtRWxlbWVudD17PFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICB9fVxuICAgICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgICAgc3RpY2t5SGVhZGVyXG4gICAgICAvPlxuICAgICk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlLCBhY3RpdmVUYWJLZXkgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBtZXRyaWNzIH0gPSBkYXRhc291cmNlO1xuICAgIGNvbnN0IHNvcnRlZE1ldHJpY3MgPSBtZXRyaWNzPy5sZW5ndGggPyB0aGlzLnNvcnRNZXRyaWNzKG1ldHJpY3MpIDogW107XG4gICAgY29uc3QgeyB0aGVtZSB9ID0gdGhpcy5wcm9wcztcblxuICAgIHJldHVybiAoXG4gICAgICA8RGF0YXNvdXJjZUNvbnRhaW5lciBkYXRhLXRlc3Q9XCJkYXRhc291cmNlLWVkaXRvclwiPlxuICAgICAgICB7dGhpcy5yZW5kZXJFcnJvcnMoKX1cbiAgICAgICAgPEFsZXJ0XG4gICAgICAgICAgY3NzPXt0aGVtZSA9PiAoeyBtYXJnaW5Cb3R0b206IHRoZW1lLmdyaWRVbml0ICogNCB9KX1cbiAgICAgICAgICB0eXBlPVwid2FybmluZ1wiXG4gICAgICAgICAgbWVzc2FnZT17XG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7JyAnfVxuICAgICAgICAgICAgICA8c3Ryb25nPnt0KCdCZSBjYXJlZnVsLicpfSA8L3N0cm9uZz5cbiAgICAgICAgICAgICAge3QoXG4gICAgICAgICAgICAgICAgJ0NoYW5naW5nIHRoZXNlIHNldHRpbmdzIHdpbGwgYWZmZWN0IGFsbCBjaGFydHMgdXNpbmcgdGhpcyBkYXRhc2V0LCBpbmNsdWRpbmcgY2hhcnRzIG93bmVkIGJ5IG90aGVyIHBlb3BsZS4nLFxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgICA8U3R5bGVkVGFibGVUYWJzXG4gICAgICAgICAgZnVsbFdpZHRoPXtmYWxzZX1cbiAgICAgICAgICBpZD1cInRhYmxlLXRhYnNcIlxuICAgICAgICAgIGRhdGEtdGVzdD1cImVkaXQtZGF0YXNldC10YWJzXCJcbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVUYWJTZWxlY3R9XG4gICAgICAgICAgZGVmYXVsdEFjdGl2ZUtleT17YWN0aXZlVGFiS2V5fVxuICAgICAgICA+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSBrZXk9ezB9IHRhYj17dCgnU291cmNlJyl9PlxuICAgICAgICAgICAge3RoaXMucmVuZGVyU291cmNlRmllbGRzZXQodGhlbWUpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgIHRhYj17XG4gICAgICAgICAgICAgIDxDb2xsZWN0aW9uVGFiVGl0bGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uPXtzb3J0ZWRNZXRyaWNzfVxuICAgICAgICAgICAgICAgIHRpdGxlPXt0KCdNZXRyaWNzJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXk9ezF9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge3RoaXMucmVuZGVyTWV0cmljQ29sbGVjdGlvbigpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgIHRhYj17XG4gICAgICAgICAgICAgIDxDb2xsZWN0aW9uVGFiVGl0bGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uPXt0aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1uc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnQ29sdW1ucycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXsyfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgICAgPFN0eWxlZEJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvblNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwidGVydGlhcnlcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnN5bmNNZXRhZGF0YX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic3luYy1mcm9tLXNvdXJjZVwiXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxJY29ucy5EYXRhYmFzZU91dGxpbmVkIGljb25TaXplPVwibVwiIC8+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdTeW5jIGNvbHVtbnMgZnJvbSBzb3VyY2UnKX1cbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgPC9Db2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQ29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29sdW1ucy10YWJsZVwiXG4gICAgICAgICAgICAgICAgY29sdW1ucz17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgZGF0YXNvdXJjZT17ZGF0YXNvdXJjZX1cbiAgICAgICAgICAgICAgICBvbkNvbHVtbnNDaGFuZ2U9e2RhdGFiYXNlQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgZGF0YWJhc2VDb2x1bW5zIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLm1ldGFkYXRhTG9hZGluZyAmJiA8TG9hZGluZyAvPn1cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgPENvbGxlY3Rpb25UYWJUaXRsZVxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb249e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NhbGN1bGF0ZWQgY29sdW1ucycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXszfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkNvbGxlY3Rpb25UYWJsZVxuICAgICAgICAgICAgICAgIGNvbHVtbnM9e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgb25Db2x1bW5zQ2hhbmdlPXtjYWxjdWxhdGVkQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgY2FsY3VsYXRlZENvbHVtbnMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29sdW1uTGFiZWxUb29sdGlwcz17e1xuICAgICAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoXG4gICAgICAgICAgICAgICAgICAgICdUaGlzIGZpZWxkIGlzIHVzZWQgYXMgYSB1bmlxdWUgaWRlbnRpZmllciB0byBhdHRhY2ggJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBjYWxjdWxhdGVkIGRpbWVuc2lvbiB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAnYXMgdGhlIGFsaWFzIGluIHRoZSBTUUwgcXVlcnkuJyxcbiAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lXG4gICAgICAgICAgICAgICAgc2hvd0V4cHJlc3Npb25cbiAgICAgICAgICAgICAgICBhbGxvd0FkZEl0ZW1cbiAgICAgICAgICAgICAgICBhbGxvd0VkaXREYXRhVHlwZVxuICAgICAgICAgICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnPG5ldyBjb2x1bW4+JyksXG4gICAgICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZ3JvdXBieTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IHQoJzxlbnRlciBTUUwgZXhwcmVzc2lvbiBoZXJlPicpLFxuICAgICAgICAgICAgICAgICAgX19leHBhbmRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSBrZXk9ezR9IHRhYj17dCgnU2V0dGluZ3MnKX0+XG4gICAgICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj57dGhpcy5yZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCl9PC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgPEZvcm1Db250YWluZXI+e3RoaXMucmVuZGVyQWR2YW5jZWRGaWVsZHNldCgpfTwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgPC9TdHlsZWRUYWJsZVRhYnM+XG4gICAgICA8L0RhdGFzb3VyY2VDb250YWluZXI+XG4gICAgKTtcbiAgfVxufVxuXG5EYXRhc291cmNlRWRpdG9yLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcbkRhdGFzb3VyY2VFZGl0b3IucHJvcFR5cGVzID0gcHJvcFR5cGVzO1xuXG5jb25zdCBEYXRhU291cmNlQ29tcG9uZW50ID0gd2l0aFRoZW1lKERhdGFzb3VyY2VFZGl0b3IpO1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoVG9hc3RzKERhdGFTb3VyY2VDb21wb25lbnQpO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };var _ref3 = process.env.NODE_ENV === \"production\" ? { name: \"hkh81z\", styles: \"margin-top:8px\" } : { name: \"17jm38f-DatasourceEditor\", styles: \"margin-top:8px;label:DatasourceEditor;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEya0N5QiIsImZpbGUiOiIvaG9tZS9hZGVsL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL0RhdGFzb3VyY2UvRGF0YXNvdXJjZUVkaXRvci5qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgQ2FyZCBmcm9tICdzcmMvY29tcG9uZW50cy9DYXJkJztcbmltcG9ydCBBbGVydCBmcm9tICdzcmMvY29tcG9uZW50cy9BbGVydCc7XG5pbXBvcnQgQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQmFkZ2UnO1xuaW1wb3J0IHtcbiAgY3NzLFxuICBpc0ZlYXR1cmVFbmFibGVkLFxuICBnZXRDdXJyZW5jeVN5bWJvbCxcbiAgZW5zdXJlSXNBcnJheSxcbiAgRmVhdHVyZUZsYWcsXG4gIHN0eWxlZCxcbiAgU3VwZXJzZXRDbGllbnQsXG4gIHQsXG4gIHdpdGhUaGVtZSxcbiAgZ2V0Q2xpZW50RXJyb3JPYmplY3QsXG59IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCB7IFNlbGVjdCwgQXN5bmNTZWxlY3QsIFJvdywgQ29sIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMnO1xuaW1wb3J0IHsgRm9ybUxhYmVsIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvRm9ybSc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJ3NyYy9jb21wb25lbnRzL0J1dHRvbic7XG5pbXBvcnQgVGFicyBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJzJztcbmltcG9ydCBDZXJ0aWZpZWRCYWRnZSBmcm9tICdzcmMvY29tcG9uZW50cy9DZXJ0aWZpZWRCYWRnZSc7XG5pbXBvcnQgV2FybmluZ0ljb25XaXRoVG9vbHRpcCBmcm9tICdzcmMvY29tcG9uZW50cy9XYXJuaW5nSWNvbldpdGhUb29sdGlwJztcbmltcG9ydCBEYXRhYmFzZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL0RhdGFiYXNlU2VsZWN0b3InO1xuaW1wb3J0IExhYmVsIGZyb20gJ3NyYy9jb21wb25lbnRzL0xhYmVsJztcbmltcG9ydCBMb2FkaW5nIGZyb20gJ3NyYy9jb21wb25lbnRzL0xvYWRpbmcnO1xuaW1wb3J0IFRhYmxlU2VsZWN0b3IgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFibGVTZWxlY3Rvcic7XG5pbXBvcnQgRWRpdGFibGVUaXRsZSBmcm9tICdzcmMvY29tcG9uZW50cy9FZGl0YWJsZVRpdGxlJztcbmltcG9ydCBDaGVja2JveENvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9DaGVja2JveENvbnRyb2wnO1xuaW1wb3J0IFRleHRDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvVGV4dENvbnRyb2wnO1xuaW1wb3J0IFRleHRBcmVhQ29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1RleHRBcmVhQ29udHJvbCc7XG5pbXBvcnQgU3BhdGlhbENvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9TcGF0aWFsQ29udHJvbCc7XG5pbXBvcnQgd2l0aFRvYXN0cyBmcm9tICdzcmMvY29tcG9uZW50cy9NZXNzYWdlVG9hc3RzL3dpdGhUb2FzdHMnO1xuaW1wb3J0IEljb25zIGZyb20gJ3NyYy9jb21wb25lbnRzL0ljb25zJztcbmltcG9ydCBDdXJyZW5jeUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9DdXJyZW5jeUNvbnRyb2wnO1xuaW1wb3J0IENvbGxlY3Rpb25UYWJsZSBmcm9tICcuL0NvbGxlY3Rpb25UYWJsZSc7XG5pbXBvcnQgRmllbGRzZXQgZnJvbSAnLi9GaWVsZHNldCc7XG5pbXBvcnQgRmllbGQgZnJvbSAnLi9GaWVsZCc7XG5pbXBvcnQgeyBmZXRjaFN5bmNlZENvbHVtbnMsIHVwZGF0ZUNvbHVtbnMgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3QgRGF0YXNvdXJjZUNvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIC5jaGFuZ2Utd2FybmluZyB7XG4gICAgbWFyZ2luOiAxNnB4IDEwcHggMDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMud2FybmluZy5iYXNlfTtcbiAgfVxuXG4gIC5jaGFuZ2Utd2FybmluZyAuYm9sZCB7XG4gICAgZm9udC13ZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS53ZWlnaHRzLmJvbGR9O1xuICB9XG5cbiAgLmZvcm0tZ3JvdXAuaGFzLWZlZWRiYWNrID4gLmhlbHAtYmxvY2sge1xuICAgIG1hcmdpbi10b3A6IDhweDtcbiAgfVxuXG4gIC5mb3JtLWdyb3VwLmZvcm0tZ3JvdXAtbWQge1xuICAgIG1hcmdpbi1ib3R0b206IDhweDtcbiAgfVxuYDtcblxuY29uc3QgRmxleFJvd0NvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGRpc3BsYXk6IGZsZXg7XG5cbiAgc3ZnIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZFRhYmxlVGFicyA9IHN0eWxlZChUYWJzKWBcbiAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIC5hbnQtdGFicy1jb250ZW50LWhvbGRlciB7XG4gICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZEJhZGdlID0gc3R5bGVkKEJhZGdlKWBcbiAgLmFudGQ1LWJhZGdlLWNvdW50IHtcbiAgICBsaW5lLWhlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgaGVpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgRWRpdExvY2tDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBmb250LXNpemU6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS5zaXplcy5zfXB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBhIHtcbiAgICBwYWRkaW5nOiAwIDEwcHg7XG4gIH1cbmA7XG5cbmNvbnN0IENvbHVtbkJ1dHRvbldyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICB0ZXh0LWFsaWduOiByaWdodDtcbiAgJHsoeyB0aGVtZSB9KSA9PiBgbWFyZ2luLWJvdHRvbTogJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHhgfVxuYDtcblxuY29uc3QgU3R5bGVkTGFiZWxXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgc3BhbiB7XG4gICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRDb2x1bW5zVGFiV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIC50YWJsZSA+IHRib2R5ID4gdHIgPiB0ZCB7XG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgfVxuXG4gIC5hbnQtdGFnIHtcbiAgICBtYXJnaW4tdG9wOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRCdXR0b25XcmFwcGVyID0gc3R5bGVkLnNwYW5gXG4gICR7KHsgdGhlbWUgfSkgPT4gYFxuICAgIG1hcmdpbi10b3A6ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4O1xuICAgIG1hcmdpbi1sZWZ0OiAke3RoZW1lLmdyaWRVbml0ICogM31weDtcbiAgICBidXR0b24+c3Bhbj46Zmlyc3Qtb2YtdHlwZSB7XG4gICAgICBtYXJnaW4tcmlnaHQ6IDA7XG4gICAgfVxuICBgfVxuYDtcblxuY29uc3Qgc3FsVG9vbHRpcE9wdGlvbnMgPSB7XG4gIHBsYWNlbWVudDogJ3RvcFJpZ2h0JyxcbiAgdGl0bGU6IHQoXG4gICAgJ0lmIGNoYW5nZXMgYXJlIG1hZGUgdG8geW91ciBTUUwgcXVlcnksICcgK1xuICAgICAgJ2NvbHVtbnMgaW4geW91ciBkYXRhc2V0IHdpbGwgYmUgc3luY2VkIHdoZW4gc2F2aW5nIHRoZSBkYXRhc2V0LicsXG4gICksXG59O1xuXG5jb25zdCBjaGVja2JveEdlbmVyYXRvciA9IChkLCBvbkNoYW5nZSkgPT4gKFxuICA8Q2hlY2tib3hDb250cm9sIHZhbHVlPXtkfSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+XG4pO1xuY29uc3QgREFUQV9UWVBFUyA9IFtcbiAgeyB2YWx1ZTogJ1NUUklORycsIGxhYmVsOiB0KCdTVFJJTkcnKSB9LFxuICB7IHZhbHVlOiAnTlVNRVJJQycsIGxhYmVsOiB0KCdOVU1FUklDJykgfSxcbiAgeyB2YWx1ZTogJ0RBVEVUSU1FJywgbGFiZWw6IHQoJ0RBVEVUSU1FJykgfSxcbiAgeyB2YWx1ZTogJ0JPT0xFQU4nLCBsYWJlbDogdCgnQk9PTEVBTicpIH0sXG5dO1xuXG5jb25zdCBEQVRBU09VUkNFX1RZUEVTX0FSUiA9IFtcbiAgeyBrZXk6ICdwaHlzaWNhbCcsIGxhYmVsOiB0KCdQaHlzaWNhbCAodGFibGUgb3IgdmlldyknKSB9LFxuICB7IGtleTogJ3ZpcnR1YWwnLCBsYWJlbDogdCgnVmlydHVhbCAoU1FMKScpIH0sXG5dO1xuY29uc3QgREFUQVNPVVJDRV9UWVBFUyA9IHt9O1xuREFUQVNPVVJDRV9UWVBFU19BUlIuZm9yRWFjaChvID0+IHtcbiAgREFUQVNPVVJDRV9UWVBFU1tvLmtleV0gPSBvO1xufSk7XG5cbmZ1bmN0aW9uIENvbGxlY3Rpb25UYWJUaXRsZSh7IHRpdGxlLCBjb2xsZWN0aW9uIH0pIHtcbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjc3M9e3sgZGlzcGxheTogJ2ZsZXgnLCBhbGlnbkl0ZW1zOiAnY2VudGVyJyB9fVxuICAgICAgZGF0YS10ZXN0PXtgY29sbGVjdGlvbi10YWItJHt0aXRsZX1gfVxuICAgID5cbiAgICAgIHt0aXRsZX17JyAnfVxuICAgICAgPFN0eWxlZEJhZGdlIGNvdW50PXtjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwfSBzaG93WmVybyAvPlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5Db2xsZWN0aW9uVGFiVGl0bGUucHJvcFR5cGVzID0ge1xuICB0aXRsZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgY29sbGVjdGlvbjogUHJvcFR5cGVzLmFycmF5LFxufTtcblxuZnVuY3Rpb24gQ29sdW1uQ29sbGVjdGlvblRhYmxlKHtcbiAgY29sdW1ucyxcbiAgZGF0YXNvdXJjZSxcbiAgb25Db2x1bW5zQ2hhbmdlLFxuICBvbkRhdGFzb3VyY2VDaGFuZ2UsXG4gIGVkaXRhYmxlQ29sdW1uTmFtZSxcbiAgc2hvd0V4cHJlc3Npb24sXG4gIGFsbG93QWRkSXRlbSxcbiAgYWxsb3dFZGl0RGF0YVR5cGUsXG4gIGl0ZW1HZW5lcmF0b3IsXG4gIGNvbHVtbkxhYmVsVG9vbHRpcHMsXG59KSB7XG4gIHJldHVybiAoXG4gICAgPENvbGxlY3Rpb25UYWJsZVxuICAgICAgdGFibGVDb2x1bW5zPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ2FkdmFuY2VkX2RhdGFfdHlwZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgIH1cbiAgICAgIHNvcnRDb2x1bW5zPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ2FkdmFuY2VkX2RhdGFfdHlwZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgIH1cbiAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgYWxsb3dBZGRJdGVtPXthbGxvd0FkZEl0ZW19XG4gICAgICBpdGVtR2VuZXJhdG9yPXtpdGVtR2VuZXJhdG9yfVxuICAgICAgY29sbGVjdGlvbj17Y29sdW1uc31cbiAgICAgIGNvbHVtbkxhYmVsVG9vbHRpcHM9e2NvbHVtbkxhYmVsVG9vbHRpcHN9XG4gICAgICBzdGlja3lIZWFkZXJcbiAgICAgIGV4cGFuZEZpZWxkc2V0PXtcbiAgICAgICAgPEZvcm1Db250YWluZXI+XG4gICAgICAgICAgPEZpZWxkc2V0IGNvbXBhY3Q+XG4gICAgICAgICAgICB7c2hvd0V4cHJlc3Npb24gJiYgKFxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImV4cHJlc3Npb25cIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdTUUwgZXhwcmVzc2lvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cInZlcmJvc2VfbmFtZVwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdMYWJlbCcpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cInZlcmJvc2VfbmFtZVwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnTGFiZWwnKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAge2FsbG93RWRpdERhdGFUeXBlICYmIChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ0eXBlXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgIGFyaWFMYWJlbD17dCgnRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9e0RBVEFfVFlQRVN9XG4gICAgICAgICAgICAgICAgICAgIG5hbWU9XCJ0eXBlXCJcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dOZXdPcHRpb25zXG4gICAgICAgICAgICAgICAgICAgIGFsbG93Q2xlYXJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKSA/IChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJhZHZhbmNlZF9kYXRhX3R5cGVcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdBZHZhbmNlZCBkYXRhIHR5cGUnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJhZHZhbmNlZF9kYXRhX3R5cGVcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQWR2YW5jZWQgRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDw+PC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwicHl0aG9uX2RhdGVfZm9ybWF0XCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0RhdGV0aW1lIGZvcm1hdCcpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17XG4gICAgICAgICAgICAgICAgLyogTm90ZSB0aGUgZnJhZ21lbnRlZCB0cmFuc2xhdGlvbnMgbWF5IG5vdCB3b3JrLiAqL1xuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICB7dCgnVGhlIHBhdHRlcm4gb2YgdGltZXN0YW1wIGZvcm1hdC4gRm9yIHN0cmluZ3MgdXNlICcpfVxuICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZG9jcy5weXRob24ub3JnLzIvbGlicmFyeS9kYXRldGltZS5odG1sI3N0cmZ0aW1lLXN0cnB0aW1lLWJlaGF2aW9yXCI+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdQeXRob24gZGF0ZXRpbWUgc3RyaW5nIHBhdHRlcm4nKX1cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgIHt0KCcgZXhwcmVzc2lvbiB3aGljaCBuZWVkcyB0byBhZGhlcmUgdG8gdGhlICcpfVxuICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0lTT184NjAxXCI+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdJU08gODYwMScpfVxuICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAge3QoYCBzdGFuZGFyZCB0byBlbnN1cmUgdGhhdCB0aGUgbGV4aWNvZ3JhcGhpY2FsIG9yZGVyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgY29pbmNpZGVzIHdpdGggdGhlIGNocm9ub2xvZ2ljYWwgb3JkZXJpbmcuIElmIHRoZVxuICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcCBmb3JtYXQgZG9lcyBub3QgYWRoZXJlIHRvIHRoZSBJU08gODYwMSBzdGFuZGFyZFxuICAgICAgICAgICAgICAgICAgICAgIHlvdSB3aWxsIG5lZWQgdG8gZGVmaW5lIGFuIGV4cHJlc3Npb24gYW5kIHR5cGUgZm9yXG4gICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtaW5nIHRoZSBzdHJpbmcgaW50byBhIGRhdGUgb3IgdGltZXN0YW1wLiBOb3RlXG4gICAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5IHRpbWUgem9uZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIElmIHRpbWUgaXMgc3RvcmVkXG4gICAgICAgICAgICAgICAgICAgICAgaW4gZXBvY2ggZm9ybWF0LCBwdXQgXFxgZXBvY2hfc1xcYCBvciBcXGBlcG9jaF9tc1xcYC4gSWYgbm8gcGF0dGVyblxuICAgICAgICAgICAgICAgICAgICAgIGlzIHNwZWNpZmllZCB3ZSBmYWxsIGJhY2sgdG8gdXNpbmcgdGhlIG9wdGlvbmFsIGRlZmF1bHRzIG9uIGEgcGVyXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UvY29sdW1uIG5hbWUgbGV2ZWwgdmlhIHRoZSBleHRyYSBwYXJhbWV0ZXIuYCl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJweXRob25fZGF0ZV9mb3JtYXRcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIlWS0lbS0lZFwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpZWQgQnknKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ1BlcnNvbiBvciBncm91cCB0aGF0IGhhcyBjZXJ0aWZpZWQgdGhpcyBtZXRyaWMnKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpZWRcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmllZCBieScpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpY2F0aW9uX2RldGFpbHNcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdEZXRhaWxzIG9mIHRoZSBjZXJ0aWZpY2F0aW9uJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWNhdGlvbkRldGFpbHNcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgICAgPC9Gb3JtQ29udGFpbmVyPlxuICAgICAgfVxuICAgICAgY29sdW1uTGFiZWxzPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJ0NvbHVtbicpLFxuICAgICAgICAgICAgICBhZHZhbmNlZF9kYXRhX3R5cGU6IHQoJ0FkdmFuY2VkIGRhdGEgdHlwZScpLFxuICAgICAgICAgICAgICB0eXBlOiB0KCdEYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgZ3JvdXBieTogdCgnSXMgZGltZW5zaW9uJyksXG4gICAgICAgICAgICAgIGlzX2R0dG06IHQoJ0lzIHRlbXBvcmFsJyksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHQoJ0RlZmF1bHQgZGF0ZXRpbWUnKSxcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdCgnSXMgZmlsdGVyYWJsZScpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDoge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnQ29sdW1uJyksXG4gICAgICAgICAgICAgIHR5cGU6IHQoJ0RhdGEgdHlwZScpLFxuICAgICAgICAgICAgICBncm91cGJ5OiB0KCdJcyBkaW1lbnNpb24nKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogdCgnSXMgdGVtcG9yYWwnKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogdCgnRGVmYXVsdCBkYXRldGltZScpLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0KCdJcyBmaWx0ZXJhYmxlJyksXG4gICAgICAgICAgICB9XG4gICAgICB9XG4gICAgICBvbkNoYW5nZT17b25Db2x1bW5zQ2hhbmdlfVxuICAgICAgaXRlbVJlbmRlcmVycz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiAodiwgb25JdGVtQ2hhbmdlLCBfLCByZWNvcmQpID0+XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lID8gKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxFZGl0YWJsZVRpdGxlXG4gICAgICAgICAgICAgICAgICAgICAgY2FuRWRpdFxuICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXt2fVxuICAgICAgICAgICAgICAgICAgICAgIG9uU2F2ZVRpdGxlPXtvbkl0ZW1DaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt2fVxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogKHZhbHVlLCBfb25JdGVtQ2hhbmdlLCBfbGFiZWwsIHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSBkYXRhc291cmNlLm1haW5fZHR0bV9jb2wgPT09IHJlY29yZC5jb2x1bW5fbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFjb2x1bW5zLmZpbmQoXG4gICAgICAgICAgICAgICAgICBjb2x1bW4gPT4gY29sdW1uLmNvbHVtbl9uYW1lID09PSByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgKS5pc19kdHRtO1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PXtgcmFkaW8tZGVmYXVsdC1kdHRtLSR7cmVjb3JkLmNvbHVtbl9uYW1lfWB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NoZWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+XG4gICAgICAgICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0eXBlOiBkID0+IChkID8gPExhYmVsPntkfTwvTGFiZWw+IDogbnVsbCksXG4gICAgICAgICAgICAgIGFkdmFuY2VkX2RhdGFfdHlwZTogZCA9PiAoXG4gICAgICAgICAgICAgICAgPExhYmVsIG9uQ2hhbmdlPXtvbkNvbHVtbnNDaGFuZ2V9PntkfTwvTGFiZWw+XG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIGlzX2R0dG06IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZ3JvdXBieTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgOiB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiAodiwgb25JdGVtQ2hhbmdlLCBfLCByZWNvcmQpID0+XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lID8gKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uSXRlbUNoYW5nZX0gLz5cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgICB7cmVjb3JkLmlzX2NlcnRpZmllZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPENlcnRpZmllZEJhZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRCeT17cmVjb3JkLmNlcnRpZmllZF9ieX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM9e3JlY29yZC5jZXJ0aWZpY2F0aW9uX2RldGFpbHN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAge3Z9XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiAodmFsdWUsIF9vbkl0ZW1DaGFuZ2UsIF9sYWJlbCwgcmVjb3JkKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hlY2tlZCA9IGRhdGFzb3VyY2UubWFpbl9kdHRtX2NvbCA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpc2FibGVkID0gIWNvbHVtbnMuZmluZChcbiAgICAgICAgICAgICAgICAgIGNvbHVtbiA9PiBjb2x1bW4uY29sdW1uX25hbWUgPT09IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICApLmlzX2R0dG07XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgIDxSYWRpb1xuICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3Q9e2ByYWRpby1kZWZhdWx0LWR0dG0tJHtyZWNvcmQuY29sdW1uX25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Y2hlY2tlZH1cbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGF0YXNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHR5cGU6IGQgPT4gKGQgPyA8TGFiZWw+e2R9PC9MYWJlbD4gOiBudWxsKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBncm91cGJ5OiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAvPlxuICApO1xufVxuQ29sdW1uQ29sbGVjdGlvblRhYmxlLnByb3BUeXBlcyA9IHtcbiAgY29sdW1uczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gIGRhdGFzb3VyY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgb25Db2x1bW5zQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkRhdGFzb3VyY2VDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGVkaXRhYmxlQ29sdW1uTmFtZTogUHJvcFR5cGVzLmJvb2wsXG4gIHNob3dFeHByZXNzaW9uOiBQcm9wVHlwZXMuYm9vbCxcbiAgYWxsb3dBZGRJdGVtOiBQcm9wVHlwZXMuYm9vbCxcbiAgYWxsb3dFZGl0RGF0YVR5cGU6IFByb3BUeXBlcy5ib29sLFxuICBpdGVtR2VuZXJhdG9yOiBQcm9wVHlwZXMuZnVuYyxcbn07XG5Db2x1bW5Db2xsZWN0aW9uVGFibGUuZGVmYXVsdFByb3BzID0ge1xuICBlZGl0YWJsZUNvbHVtbk5hbWU6IGZhbHNlLFxuICBzaG93RXhwcmVzc2lvbjogZmFsc2UsXG4gIGFsbG93QWRkSXRlbTogZmFsc2UsXG4gIGFsbG93RWRpdERhdGFUeXBlOiBmYWxzZSxcbiAgaXRlbUdlbmVyYXRvcjogKCkgPT4gKHtcbiAgICBjb2x1bW5fbmFtZTogdCgnPG5ldyBjb2x1bW4+JyksXG4gICAgZmlsdGVyYWJsZTogdHJ1ZSxcbiAgICBncm91cGJ5OiB0cnVlLFxuICB9KSxcbn07XG5cbmZ1bmN0aW9uIFN0YWNrZWRGaWVsZCh7IGxhYmVsLCBmb3JtRWxlbWVudCB9KSB7XG4gIHJldHVybiAoXG4gICAgPGRpdj5cbiAgICAgIDxkaXY+XG4gICAgICAgIDxzdHJvbmc+e2xhYmVsfTwvc3Ryb25nPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2Pntmb3JtRWxlbWVudH08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuU3RhY2tlZEZpZWxkLnByb3BUeXBlcyA9IHtcbiAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGZvcm1FbGVtZW50OiBQcm9wVHlwZXMubm9kZSxcbn07XG5cbmZ1bmN0aW9uIEZvcm1Db250YWluZXIoeyBjaGlsZHJlbiB9KSB7XG4gIHJldHVybiA8Q2FyZCBwYWRkZWQ+e2NoaWxkcmVufTwvQ2FyZD47XG59XG5cbkZvcm1Db250YWluZXIucHJvcFR5cGVzID0ge1xuICBjaGlsZHJlbjogUHJvcFR5cGVzLm5vZGUsXG59O1xuXG5jb25zdCBwcm9wVHlwZXMgPSB7XG4gIGRhdGFzb3VyY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBhZGRTdWNjZXNzVG9hc3Q6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGFkZERhbmdlclRvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBzZXRJc0VkaXRpbmc6IFByb3BUeXBlcy5mdW5jLFxufTtcblxuY29uc3QgZGVmYXVsdFByb3BzID0ge1xuICBvbkNoYW5nZTogKCkgPT4ge30sXG4gIHNldElzRWRpdGluZzogKCkgPT4ge30sXG59O1xuXG5mdW5jdGlvbiBPd25lcnNTZWxlY3Rvcih7IGRhdGFzb3VyY2UsIG9uQ2hhbmdlIH0pIHtcbiAgY29uc3QgbG9hZE9wdGlvbnMgPSB1c2VDYWxsYmFjaygoc2VhcmNoID0gJycsIHBhZ2UsIHBhZ2VTaXplKSA9PiB7XG4gICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IHNlYXJjaCwgcGFnZSwgcGFnZV9zaXplOiBwYWdlU2l6ZSB9KTtcbiAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXRhc2V0L3JlbGF0ZWQvb3duZXJzP3E9JHtxdWVyeX1gLFxuICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gKHtcbiAgICAgIGRhdGE6IHJlc3BvbnNlLmpzb24ucmVzdWx0XG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLmV4dHJhLmFjdGl2ZSlcbiAgICAgICAgLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgfSkpLFxuICAgICAgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCxcbiAgICB9KSk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gKFxuICAgIDxBc3luY1NlbGVjdFxuICAgICAgYXJpYUxhYmVsPXt0KCdTZWxlY3Qgb3duZXJzJyl9XG4gICAgICBtb2RlPVwibXVsdGlwbGVcIlxuICAgICAgbmFtZT1cIm93bmVyc1wiXG4gICAgICB2YWx1ZT17ZGF0YXNvdXJjZS5vd25lcnN9XG4gICAgICBvcHRpb25zPXtsb2FkT3B0aW9uc31cbiAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgIGhlYWRlcj17PEZvcm1MYWJlbD57dCgnT3duZXJzJyl9PC9Gb3JtTGFiZWw+fVxuICAgICAgYWxsb3dDbGVhclxuICAgIC8+XG4gICk7XG59XG5cbmNsYXNzIERhdGFzb3VyY2VFZGl0b3IgZXh0ZW5kcyBQdXJlQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGRhdGFzb3VyY2U6IHtcbiAgICAgICAgLi4ucHJvcHMuZGF0YXNvdXJjZSxcbiAgICAgICAgb3duZXJzOiBwcm9wcy5kYXRhc291cmNlLm93bmVycy5tYXAob3duZXIgPT4gKHtcbiAgICAgICAgICB2YWx1ZTogb3duZXIudmFsdWUgfHwgb3duZXIuaWQsXG4gICAgICAgICAgbGFiZWw6IG93bmVyLmxhYmVsIHx8IGAke293bmVyLmZpcnN0X25hbWV9ICR7b3duZXIubGFzdF9uYW1lfWAsXG4gICAgICAgIH0pKSxcbiAgICAgICAgbWV0cmljczogcHJvcHMuZGF0YXNvdXJjZS5tZXRyaWNzPy5tYXAobWV0cmljID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5TWV0cmljLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpY2F0aW9uRGV0YWlscyxcbiAgICAgICAgICB9ID0gbWV0cmljO1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb246IHsgZGV0YWlscywgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeSB9ID0ge30sXG4gICAgICAgICAgICB3YXJuaW5nX21hcmtkb3duOiB3YXJuaW5nTWFya2Rvd24sXG4gICAgICAgICAgfSA9IEpTT04ucGFyc2UobWV0cmljLmV4dHJhIHx8ICd7fScpIHx8IHt9O1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5tZXRyaWMsXG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uX2RldGFpbHM6IGNlcnRpZmljYXRpb25EZXRhaWxzIHx8IGRldGFpbHMsXG4gICAgICAgICAgICB3YXJuaW5nX21hcmtkb3duOiB3YXJuaW5nTWFya2Rvd24gfHwgJycsXG4gICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5IHx8IGNlcnRpZmllZEJ5TWV0cmljLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICAgIGVycm9yczogW10sXG4gICAgICBpc1NxbGE6XG4gICAgICAgIHByb3BzLmRhdGFzb3VyY2UuZGF0YXNvdXJjZV90eXBlID09PSAndGFibGUnIHx8XG4gICAgICAgIHByb3BzLmRhdGFzb3VyY2UudHlwZSA9PT0gJ3RhYmxlJyxcbiAgICAgIGlzRWRpdE1vZGU6IGZhbHNlLFxuICAgICAgZGF0YWJhc2VDb2x1bW5zOiBwcm9wcy5kYXRhc291cmNlLmNvbHVtbnMuZmlsdGVyKGNvbCA9PiAhY29sLmV4cHJlc3Npb24pLFxuICAgICAgY2FsY3VsYXRlZENvbHVtbnM6IHByb3BzLmRhdGFzb3VyY2UuY29sdW1ucy5maWx0ZXIoXG4gICAgICAgIGNvbCA9PiAhIWNvbC5leHByZXNzaW9uLFxuICAgICAgKSxcbiAgICAgIG1ldGFkYXRhTG9hZGluZzogZmFsc2UsXG4gICAgICBhY3RpdmVUYWJLZXk6IDAsXG4gICAgICBkYXRhc291cmNlVHlwZTogcHJvcHMuZGF0YXNvdXJjZS5zcWxcbiAgICAgICAgPyBEQVRBU09VUkNFX1RZUEVTLnZpcnR1YWwua2V5XG4gICAgICAgIDogREFUQVNPVVJDRV9UWVBFUy5waHlzaWNhbC5rZXksXG4gICAgfTtcblxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkNoYW5nZUVkaXRNb2RlID0gdGhpcy5vbkNoYW5nZUVkaXRNb2RlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlID0gdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UgPSB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEgPVxuICAgICAgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3luY01ldGFkYXRhID0gdGhpcy5zeW5jTWV0YWRhdGEuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldENvbHVtbnMgPSB0aGlzLnNldENvbHVtbnMuYmluZCh0aGlzKTtcbiAgICB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlID0gdGhpcy52YWxpZGF0ZUFuZENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlVGFiU2VsZWN0ID0gdGhpcy5oYW5kbGVUYWJTZWxlY3QuYmluZCh0aGlzKTtcbiAgICB0aGlzLmN1cnJlbmNpZXMgPSBlbnN1cmVJc0FycmF5KHByb3BzLmN1cnJlbmNpZXMpLm1hcChjdXJyZW5jeUNvZGUgPT4gKHtcbiAgICAgIHZhbHVlOiBjdXJyZW5jeUNvZGUsXG4gICAgICBsYWJlbDogYCR7Z2V0Q3VycmVuY3lTeW1ib2woe1xuICAgICAgICBzeW1ib2w6IGN1cnJlbmN5Q29kZSxcbiAgICAgIH0pfSAoJHtjdXJyZW5jeUNvZGV9KWAsXG4gICAgfSkpO1xuICB9XG5cbiAgb25DaGFuZ2UoKSB7XG4gICAgLy8gRW1wdHlpbmcgU1FMIGlmIFwiUGh5c2ljYWxcIiByYWRpbyBidXR0b24gaXMgc2VsZWN0ZWRcbiAgICAvLyBDdXJyZW50bHkgdGhlIGxvZ2ljIHRvIGtub3cgd2hldGhlciB0aGUgc291cmNlIGlzXG4gICAgLy8gcGh5c2ljYWwgb3IgdmlydHVhbCBpcyBiYXNlZCBvbiB3aGV0aGVyIFNRTCBpcyBlbXB0eSBvciBub3QuXG4gICAgY29uc3QgeyBkYXRhc291cmNlVHlwZSwgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBzcWwgPVxuICAgICAgZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5ID8gJycgOiBkYXRhc291cmNlLnNxbDtcbiAgICBjb25zdCBuZXdEYXRhc291cmNlID0ge1xuICAgICAgLi4udGhpcy5zdGF0ZS5kYXRhc291cmNlLFxuICAgICAgc3FsLFxuICAgICAgY29sdW1uczogWy4uLnRoaXMuc3RhdGUuZGF0YWJhc2VDb2x1bW5zLCAuLi50aGlzLnN0YXRlLmNhbGN1bGF0ZWRDb2x1bW5zXSxcbiAgICB9O1xuICAgIHRoaXMucHJvcHMub25DaGFuZ2UobmV3RGF0YXNvdXJjZSwgdGhpcy5zdGF0ZS5lcnJvcnMpO1xuICB9XG5cbiAgb25DaGFuZ2VFZGl0TW9kZSgpIHtcbiAgICB0aGlzLnByb3BzLnNldElzRWRpdGluZyghdGhpcy5zdGF0ZS5pc0VkaXRNb2RlKTtcbiAgICB0aGlzLnNldFN0YXRlKHByZXZTdGF0ZSA9PiAoeyBpc0VkaXRNb2RlOiAhcHJldlN0YXRlLmlzRWRpdE1vZGUgfSkpO1xuICB9XG5cbiAgb25EYXRhc291cmNlQ2hhbmdlKGRhdGFzb3VyY2UsIGNhbGxiYWNrID0gdGhpcy52YWxpZGF0ZUFuZENoYW5nZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhc291cmNlIH0sIGNhbGxiYWNrKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoYXR0ciwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuOyAvLyBpZiB2YWx1ZSBpcyB1bmRlZmluZWQgZG8gbm90IHVwZGF0ZSBzdGF0ZVxuICAgIGNvbnN0IGRhdGFzb3VyY2UgPSB7IC4uLnRoaXMuc3RhdGUuZGF0YXNvdXJjZSwgW2F0dHJdOiB2YWx1ZSB9O1xuICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICBwcmV2U3RhdGUgPT4gKHtcbiAgICAgICAgZGF0YXNvdXJjZTogeyAuLi5wcmV2U3RhdGUuZGF0YXNvdXJjZSwgW2F0dHJdOiB2YWx1ZSB9LFxuICAgICAgfSksXG4gICAgICBhdHRyID09PSAndGFibGVfbmFtZSdcbiAgICAgICAgPyB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhKVxuICAgICAgICA6IHRoaXMub25EYXRhc291cmNlQ2hhbmdlKGRhdGFzb3VyY2UsIHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpLFxuICAgICk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VUeXBlQ2hhbmdlKGRhdGFzb3VyY2VUeXBlKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRhdGFzb3VyY2VUeXBlIH0pO1xuICB9XG5cbiAgc2V0Q29sdW1ucyhvYmopIHtcbiAgICAvLyB1cGRhdGUgY2FsY3VsYXRlZENvbHVtbnMgb3IgZGF0YWJhc2VDb2x1bW5zXG4gICAgdGhpcy5zZXRTdGF0ZShvYmosIHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpO1xuICB9XG5cbiAgdmFsaWRhdGVBbmRDaGFuZ2UoKSB7XG4gICAgdGhpcy52YWxpZGF0ZSh0aGlzLm9uQ2hhbmdlKTtcbiAgfVxuXG4gIHRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhKCkge1xuICAgIHRoaXMudmFsaWRhdGUoKCkgPT4ge1xuICAgICAgdGhpcy5zeW5jTWV0YWRhdGEoKTtcbiAgICAgIHRoaXMub25DaGFuZ2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHN5bmNNZXRhZGF0YSgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG1ldGFkYXRhTG9hZGluZzogdHJ1ZSB9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3Q29scyA9IGF3YWl0IGZldGNoU3luY2VkQ29sdW1ucyhkYXRhc291cmNlKTtcbiAgICAgIGNvbnN0IGNvbHVtbkNoYW5nZXMgPSB1cGRhdGVDb2x1bW5zKFxuICAgICAgICBkYXRhc291cmNlLmNvbHVtbnMsXG4gICAgICAgIG5ld0NvbHMsXG4gICAgICAgIHRoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0LFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2V0Q29sdW1ucyh7XG4gICAgICAgIGRhdGFiYXNlQ29sdW1uczogY29sdW1uQ2hhbmdlcy5maW5hbENvbHVtbnMuZmlsdGVyKFxuICAgICAgICAgIGNvbCA9PiAhY29sLmV4cHJlc3Npb24sIC8vIHJlbW92ZSBjYWxjdWxhdGVkIGNvbHVtbnNcbiAgICAgICAgKSxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5wcm9wcy5hZGRTdWNjZXNzVG9hc3QodCgnTWV0YWRhdGEgaGFzIGJlZW4gc3luY2VkJykpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1ldGFkYXRhTG9hZGluZzogZmFsc2UgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGNsaWVudEVycm9yLCBzdGF0dXNUZXh0IH0gPVxuICAgICAgICBhd2FpdCBnZXRDbGllbnRFcnJvck9iamVjdChlcnJvcik7XG4gICAgICB0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0KFxuICAgICAgICBjbGllbnRFcnJvciB8fCBzdGF0dXNUZXh0IHx8IHQoJ0FuIGVycm9yIGhhcyBvY2N1cnJlZCcpLFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZpbmREdXBsaWNhdGVzKGFyciwgYWNjZXNzb3IpIHtcbiAgICBjb25zdCBzZWVuID0ge307XG4gICAgY29uc3QgZHVwcyA9IFtdO1xuICAgIGFyci5mb3JFYWNoKG9iaiA9PiB7XG4gICAgICBjb25zdCBpdGVtID0gYWNjZXNzb3Iob2JqKTtcbiAgICAgIGlmIChpdGVtIGluIHNlZW4pIHtcbiAgICAgICAgZHVwcy5wdXNoKGl0ZW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VlbltpdGVtXSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGR1cHM7XG4gIH1cblxuICB2YWxpZGF0ZShjYWxsYmFjaykge1xuICAgIGxldCBlcnJvcnMgPSBbXTtcbiAgICBsZXQgZHVwcztcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAvLyBMb29raW5nIGZvciBkdXBsaWNhdGUgY29sdW1uX25hbWVcbiAgICBkdXBzID0gdGhpcy5maW5kRHVwbGljYXRlcyhkYXRhc291cmNlLmNvbHVtbnMsIG9iaiA9PiBvYmouY29sdW1uX25hbWUpO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBkdXBzLm1hcChuYW1lID0+IHQoJ0NvbHVtbiBuYW1lIFslc10gaXMgZHVwbGljYXRlZCcsIG5hbWUpKSxcbiAgICApO1xuXG4gICAgLy8gTG9va2luZyBmb3IgZHVwbGljYXRlIG1ldHJpY19uYW1lXG4gICAgZHVwcyA9IHRoaXMuZmluZER1cGxpY2F0ZXMoZGF0YXNvdXJjZS5tZXRyaWNzLCBvYmogPT4gb2JqLm1ldHJpY19uYW1lKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgZHVwcy5tYXAobmFtZSA9PiB0KCdNZXRyaWMgbmFtZSBbJXNdIGlzIGR1cGxpY2F0ZWQnLCBuYW1lKSksXG4gICAgKTtcblxuICAgIC8vIE1ha2luZyBzdXJlIGNhbGN1bGF0ZWRDb2x1bW5zIGhhdmUgYW4gZXhwcmVzc2lvbiBkZWZpbmVkXG4gICAgY29uc3Qgbm9GaWx0ZXJDYWxjQ29scyA9IHRoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnMuZmlsdGVyKFxuICAgICAgY29sID0+ICFjb2wuZXhwcmVzc2lvbiAmJiAhY29sLmpzb24sXG4gICAgKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgbm9GaWx0ZXJDYWxjQ29scy5tYXAoY29sID0+XG4gICAgICAgIHQoJ0NhbGN1bGF0ZWQgY29sdW1uIFslc10gcmVxdWlyZXMgYW4gZXhwcmVzc2lvbicsIGNvbC5jb2x1bW5fbmFtZSksXG4gICAgICApLFxuICAgICk7XG5cbiAgICAvLyB2YWxpZGF0ZSBjdXJyZW5jeSBjb2RlXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3RhdGUuZGF0YXNvdXJjZS5tZXRyaWNzPy5mb3JFYWNoKFxuICAgICAgICBtZXRyaWMgPT5cbiAgICAgICAgICBtZXRyaWMuY3VycmVuY3k/LnN5bWJvbCAmJlxuICAgICAgICAgIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZW4tVVMnLCB7XG4gICAgICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JyxcbiAgICAgICAgICAgIGN1cnJlbmN5OiBtZXRyaWMuY3VycmVuY3kuc3ltYm9sLFxuICAgICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoW3QoJ0ludmFsaWQgY3VycmVuY3kgY29kZSBpbiBzYXZlZCBtZXRyaWNzJyldKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHsgZXJyb3JzIH0sIGNhbGxiYWNrKTtcbiAgfVxuXG4gIGhhbmRsZVRhYlNlbGVjdChhY3RpdmVUYWJLZXkpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgYWN0aXZlVGFiS2V5IH0pO1xuICB9XG5cbiAgc29ydE1ldHJpY3MobWV0cmljcykge1xuICAgIHJldHVybiBtZXRyaWNzLnNvcnQoKHsgaWQ6IGEgfSwgeyBpZDogYiB9KSA9PiBiIC0gYSk7XG4gIH1cblxuICByZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdCYXNpYycpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cImRlZmF1bHRfZW5kcG9pbnRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZWZhdWx0IFVSTCcpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgYERlZmF1bHQgVVJMIHRvIHJlZGlyZWN0IHRvIHdoZW4gYWNjZXNzaW5nIGZyb20gdGhlIGRhdGFzZXQgbGlzdCBwYWdlLlxuICAgICAgICAgICAgQWNjZXB0cyByZWxhdGl2ZSBVUkxzIHN1Y2ggYXMgPHNwYW4gc3R5bGU94oCed2hpdGUtc3BhY2U6IG5vd3JhcDvigJ0+L3N1cGVyc2V0L2Rhc2hib2FyZC97aWR9Lzwvc3Bhbj5gLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImRlZmF1bHRfZW5kcG9pbnRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJmaWx0ZXJfc2VsZWN0X2VuYWJsZWRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgZmlsdGVycycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdXaGV0aGVyIHRvIHBvcHVsYXRlIGF1dG9jb21wbGV0ZSBmaWx0ZXJzIG9wdGlvbnMnKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIC8+fVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgcXVlcnkgcHJlZGljYXRlJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ1doZW4gdXNpbmcgXCJBdXRvY29tcGxldGUgZmlsdGVyc1wiLCB0aGlzIGNhbiBiZSB1c2VkIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UgJyArXG4gICAgICAgICAgICAgICAgJ29mIHRoZSBxdWVyeSBmZXRjaGluZyB0aGUgdmFsdWVzLiBVc2UgdGhpcyBvcHRpb24gdG8gYXBwbHkgYSAnICtcbiAgICAgICAgICAgICAgICAncHJlZGljYXRlIChXSEVSRSBjbGF1c2UpIHRvIHRoZSBxdWVyeSBzZWxlY3RpbmcgdGhlIGRpc3RpbmN0ICcgK1xuICAgICAgICAgICAgICAgICd2YWx1ZXMgZnJvbSB0aGUgdGFibGUuIFR5cGljYWxseSB0aGUgaW50ZW50IHdvdWxkIGJlIHRvIGxpbWl0IHRoZSBzY2FuICcgK1xuICAgICAgICAgICAgICAgICdieSBhcHBseWluZyBhIHJlbGF0aXZlIHRpbWUgZmlsdGVyIG9uIGEgcGFydGl0aW9uZWQgb3IgaW5kZXhlZCB0aW1lLXJlbGF0ZWQgZmllbGQuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgICAgICBtaW5MaW5lcz17NX1cbiAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZXh0cmFcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ0V4dHJhJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ0V4dHJhIGRhdGEgdG8gc3BlY2lmeSB0YWJsZSBtZXRhZGF0YS4gQ3VycmVudGx5IHN1cHBvcnRzICcgK1xuICAgICAgICAgICAgICAgICdtZXRhZGF0YSBvZiB0aGUgZm9ybWF0OiBgeyBcImNlcnRpZmljYXRpb25cIjogeyBcImNlcnRpZmllZF9ieVwiOiAnICtcbiAgICAgICAgICAgICAgICAnXCJEYXRhIFBsYXRmb3JtIFRlYW1cIiwgXCJkZXRhaWxzXCI6IFwiVGhpcyB0YWJsZSBpcyB0aGUgc291cmNlIG9mIHRydXRoLlwiICcgK1xuICAgICAgICAgICAgICAgICd9LCBcIndhcm5pbmdfbWFya2Rvd25cIjogXCJUaGlzIGlzIGEgd2FybmluZy5cIiB9YC4nLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZXh0cmFcIlxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxPd25lcnNTZWxlY3RvclxuICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgb25DaGFuZ2U9e25ld093bmVycyA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZSh7IC4uLmRhdGFzb3VyY2UsIG93bmVyczogbmV3T3duZXJzIH0pO1xuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdBZHZhbmNlZCcpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiY2FjaGVfdGltZW91dFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0NhY2hlIHRpbWVvdXQnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgZHVyYXRpb24gb2YgdGltZSBpbiBzZWNvbmRzIGJlZm9yZSB0aGUgY2FjaGUgaXMgaW52YWxpZGF0ZWQuIFNldCB0byAtMSB0byBieXBhc3MgdGhlIGNhY2hlLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwiY2FjaGVfdGltZW91dFwiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cIm9mZnNldFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0hvdXJzIG9mZnNldCcpfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJvZmZzZXRcIiAvPn1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgbnVtYmVyIG9mIGhvdXJzLCBuZWdhdGl2ZSBvciBwb3NpdGl2ZSwgdG8gc2hpZnQgdGhlIHRpbWUgY29sdW1uLiBUaGlzIGNhbiBiZSB1c2VkIHRvIG1vdmUgVVRDIHRpbWUgdG8gbG9jYWwgdGltZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cInRlbXBsYXRlX3BhcmFtc1wiXG4gICAgICAgICAgICBsYWJlbD17dCgnVGVtcGxhdGUgcGFyYW1ldGVycycpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdBIHNldCBvZiBwYXJhbWV0ZXJzIHRoYXQgYmVjb21lIGF2YWlsYWJsZSBpbiB0aGUgcXVlcnkgdXNpbmcgSmluamEgdGVtcGxhdGluZyBzeW50YXgnLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJ0ZW1wbGF0ZV9wYXJhbXNcIiAvPn1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cIm5vcm1hbGl6ZV9jb2x1bW5zXCJcbiAgICAgICAgICBsYWJlbD17dCgnTm9ybWFsaXplIGNvbHVtbiBuYW1lcycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0FsbG93IGNvbHVtbiBuYW1lcyB0byBiZSBjaGFuZ2VkIHRvIGNhc2UgaW5zZW5zaXRpdmUgZm9ybWF0LCBpZiBzdXBwb3J0ZWQgKGUuZy4gT3JhY2xlLCBTbm93Zmxha2UpLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cIm5vcm1hbGl6ZV9jb2x1bW5zXCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiYWx3YXlzX2ZpbHRlcl9tYWluX2R0dG1cIlxuICAgICAgICAgIGxhYmVsPXt0KCdBbHdheXMgZmlsdGVyIG1haW4gZGF0ZXRpbWUgY29sdW1uJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICBgV2hlbiB0aGUgc2Vjb25kYXJ5IHRlbXBvcmFsIGNvbHVtbnMgYXJlIGZpbHRlcmVkLCBhcHBseSB0aGUgc2FtZSBmaWx0ZXIgdG8gdGhlIG1haW4gZGF0ZXRpbWUgY29sdW1uLmAsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCIgLz59XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJTcGF0aWFsVGFiKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IHNwYXRpYWxzLCBhbGxfY29sczogYWxsQ29scyB9ID0gZGF0YXNvdXJjZTtcbiAgICByZXR1cm4gKFxuICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICB0YWI9ezxDb2xsZWN0aW9uVGFiVGl0bGUgY29sbGVjdGlvbj17c3BhdGlhbHN9IHRpdGxlPXt0KCdTcGF0aWFsJyl9IC8+fVxuICAgICAgICBrZXk9ezR9XG4gICAgICA+XG4gICAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgICB0YWJsZUNvbHVtbnM9e1snbmFtZScsICdjb25maWcnXX1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcywgJ3NwYXRpYWxzJyl9XG4gICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHQoJzxuZXcgc3BhdGlhbD4nKSxcbiAgICAgICAgICAgIHR5cGU6IHQoJzxubyB0eXBlPicpLFxuICAgICAgICAgICAgY29uZmlnOiBudWxsLFxuICAgICAgICAgIH0pfVxuICAgICAgICAgIGNvbGxlY3Rpb249e3NwYXRpYWxzfVxuICAgICAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgICAgIGl0ZW1SZW5kZXJlcnM9e3tcbiAgICAgICAgICAgIG5hbWU6IChkLCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZSBjYW5FZGl0IHRpdGxlPXtkfSBvblNhdmVUaXRsZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgY29uZmlnOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPFNwYXRpYWxDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IGNob2ljZXM9e2FsbENvbHN9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU291cmNlRmllbGRzZXQoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICA8RWRpdExvY2tDb250YWluZXI+XG4gICAgICAgICAgPHNwYW4gcm9sZT1cImJ1dHRvblwiIHRhYkluZGV4PXswfSBvbkNsaWNrPXt0aGlzLm9uQ2hhbmdlRWRpdE1vZGV9PlxuICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNFZGl0TW9kZSA/IChcbiAgICAgICAgICAgICAgPEljb25zLlVubG9ja091dGxpbmVkXG4gICAgICAgICAgICAgICAgaWNvblNpemU9XCJ4bFwiXG4gICAgICAgICAgICAgICAgY3NzPXt0aGVtZSA9PiBjc3NgXG4gICAgICAgICAgICAgICAgICBtYXJnaW46IGF1dG8gJHt0aGVtZS5ncmlkVW5pdH1weCBhdXRvIDA7XG4gICAgICAgICAgICAgICAgYH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDxJY29ucy5Mb2NrT3V0bGluZWRcbiAgICAgICAgICAgICAgICBpY29uU2l6ZT1cInhsXCJcbiAgICAgICAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7XG4gICAgICAgICAgICAgICAgICBtYXJnaW46IGBhdXRvICR7dGhlbWUuZ3JpZFVuaXR9cHggYXV0byAwYCxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgIHshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmIChcbiAgICAgICAgICAgIDxkaXY+e3QoJ0NsaWNrIHRoZSBsb2NrIHRvIG1ha2UgY2hhbmdlcy4nKX08L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgPGRpdj57dCgnQ2xpY2sgdGhlIGxvY2sgdG8gcHJldmVudCBmdXJ0aGVyIGNoYW5nZXMuJyl9PC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9FZGl0TG9ja0NvbnRhaW5lcj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtLWwtMTAgbS10LTIwIG0tYi0xMFwiPlxuICAgICAgICAgIHtEQVRBU09VUkNFX1RZUEVTX0FSUi5tYXAodHlwZSA9PiAoXG4gICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAga2V5PXt0eXBlLmtleX1cbiAgICAgICAgICAgICAgdmFsdWU9e3R5cGUua2V5fVxuICAgICAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlVHlwZUNoYW5nZS5iaW5kKHRoaXMsIHR5cGUua2V5KX1cbiAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5zdGF0ZS5kYXRhc291cmNlVHlwZSA9PT0gdHlwZS5rZXl9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7dHlwZS5sYWJlbH1cbiAgICAgICAgICAgIDwvUmFkaW8+XG4gICAgICAgICAgKSl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8aHIgLz5cbiAgICAgICAgPEZpZWxkc2V0IGl0ZW09e2RhdGFzb3VyY2V9IG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX0gY29tcGFjdD5cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5kYXRhc291cmNlVHlwZSA9PT0gREFUQVNPVVJDRV9UWVBFUy52aXJ0dWFsLmtleSAmJiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkYXRhYmFzZVNlbGVjdG9yXCJcbiAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnVmlydHVhbCcpfVxuICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjc3M9e3sgbWFyZ2luVG9wOiA4IH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RGF0YWJhc2VTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiPXtkYXRhc291cmNlPy5kYXRhYmFzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRhbG9nPXtkYXRhc291cmNlLmNhdGFsb2d9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hPXtkYXRhc291cmNlLnNjaGVtYX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNhdGFsb2dDaGFuZ2U9e2NhdGFsb2cgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdjYXRhbG9nJywgY2F0YWxvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TY2hlbWFDaGFuZ2U9e3NjaGVtYSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3NjaGVtYScsIHNjaGVtYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25EYkNoYW5nZT17ZGF0YWJhc2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdkYXRhYmFzZScsIGRhdGFiYXNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXJyb3I9e3RoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IHdpZHRoOiAnY2FsYygxMDAlIC0gMzRweCknLCBtYXJnaW5Ub3A6IC0xNiB9fT5cbiAgICAgICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidGFibGVfbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnTmFtZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cInRhYmxlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0YWJsZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3RhYmxlX25hbWUnLCB0YWJsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGF0YXNldCBuYW1lJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInNxbFwiXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdTUUwnKX1cbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAgICAgJ1doZW4gc3BlY2lmeWluZyBTUUwsIHRoZSBkYXRhc291cmNlIGFjdHMgYXMgYSB2aWV3LiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdTdXBlcnNldCB3aWxsIHVzZSB0aGlzIHN0YXRlbWVudCBhcyBhIHN1YnF1ZXJ5IHdoaWxlIGdyb3VwaW5nIGFuZCBmaWx0ZXJpbmcgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnb24gdGhlIGdlbmVyYXRlZCBwYXJlbnQgcXVlcmllcy4nLFxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cInNxbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkxpbmVzPXsyMH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1heExpbmVzPXtJbmZpbml0eX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplPVwiYm90aFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwT3B0aW9ucz17c3FsVG9vbHRpcE9wdGlvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgICAge3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5ICYmIChcbiAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ0YWJsZVNlbGVjdG9yXCJcbiAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdQaHlzaWNhbCcpfVxuICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IG1hcmdpblRvcDogOCB9fT5cbiAgICAgICAgICAgICAgICAgICAgICA8VGFibGVTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJhYmxlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UuZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlX25hbWU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXNvdXJjZS5kYXRhYmFzZT8uZGF0YWJhc2VfbmFtZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuZGF0YWJhc2U/Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGJJZD17ZGF0YXNvdXJjZS5kYXRhYmFzZT8uaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcj17dGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGFsb2c9e2RhdGFzb3VyY2UuY2F0YWxvZ31cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYT17ZGF0YXNvdXJjZS5zY2hlbWF9XG4gICAgICAgICAgICAgICAgICAgICAgICBzcWxMYWJNb2RlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlVmFsdWU9e2RhdGFzb3VyY2UudGFibGVfbmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2F0YWxvZ0NoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY2F0YWxvZyA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ2NhdGFsb2cnLCBjYXRhbG9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblNjaGVtYUNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gc2NoZW1hID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnc2NoZW1hJywgc2NoZW1hKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkRiQ2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBkYXRhYmFzZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGFiYXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblRhYmxlU2VsZWN0Q2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0YWJsZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3RhYmxlX25hbWUnLCB0YWJsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgICAgICAgJ1RoZSBwb2ludGVyIHRvIGEgcGh5c2ljYWwgdGFibGUgKG9yIHZpZXcpLiBLZWVwIGluIG1pbmQgdGhhdCB0aGUgY2hhcnQgaXMgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ2Fzc29jaWF0ZWQgdG8gdGhpcyBTdXBlcnNldCBsb2dpY2FsIHRhYmxlLCBhbmQgdGhpcyBsb2dpY2FsIHRhYmxlIHBvaW50cyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAndGhlIHBoeXNpY2FsIHRhYmxlIHJlZmVyZW5jZWQgaGVyZS4nLFxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJFcnJvcnMoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUuZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxBbGVydFxuICAgICAgICAgIGNzcz17dGhlbWUgPT4gKHsgbWFyZ2luQm90dG9tOiB0aGVtZS5ncmlkVW5pdCAqIDQgfSl9XG4gICAgICAgICAgdHlwZT1cImVycm9yXCJcbiAgICAgICAgICBtZXNzYWdlPXtcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmVycm9ycy5tYXAoZXJyID0+IChcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17ZXJyfT57ZXJyfTwvZGl2PlxuICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgIDwvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmVuZGVyTWV0cmljQ29sbGVjdGlvbigpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBtZXRyaWNzIH0gPSBkYXRhc291cmNlO1xuICAgIGNvbnN0IHNvcnRlZE1ldHJpY3MgPSBtZXRyaWNzPy5sZW5ndGggPyB0aGlzLnNvcnRNZXRyaWNzKG1ldHJpY3MpIDogW107XG4gICAgcmV0dXJuIChcbiAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgdGFibGVDb2x1bW5zPXtbJ21ldHJpY19uYW1lJywgJ3ZlcmJvc2VfbmFtZScsICdleHByZXNzaW9uJ119XG4gICAgICAgIHNvcnRDb2x1bW5zPXtbJ21ldHJpY19uYW1lJywgJ3ZlcmJvc2VfbmFtZScsICdleHByZXNzaW9uJ119XG4gICAgICAgIGNvbHVtbkxhYmVscz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KCdNZXRyaWMgS2V5JyksXG4gICAgICAgICAgdmVyYm9zZV9uYW1lOiB0KCdMYWJlbCcpLFxuICAgICAgICAgIGV4cHJlc3Npb246IHQoJ1NRTCBleHByZXNzaW9uJyksXG4gICAgICAgIH19XG4gICAgICAgIGNvbHVtbkxhYmVsVG9vbHRpcHM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdChcbiAgICAgICAgICAgICdUaGlzIGZpZWxkIGlzIHVzZWQgYXMgYSB1bmlxdWUgaWRlbnRpZmllciB0byBhdHRhY2ggJyArXG4gICAgICAgICAgICAgICd0aGUgbWV0cmljIHRvIGNoYXJ0cy4gSXQgaXMgYWxzbyB1c2VkIGFzIHRoZSBhbGlhcyBpbiB0aGUgJyArXG4gICAgICAgICAgICAgICdTUUwgcXVlcnkuJyxcbiAgICAgICAgICApLFxuICAgICAgICB9fVxuICAgICAgICBleHBhbmRGaWVsZHNldD17XG4gICAgICAgICAgPEZvcm1Db250YWluZXI+XG4gICAgICAgICAgICA8RmllbGRzZXQgY29tcGFjdD5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImQzZm9ybWF0XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnRDMgZm9ybWF0Jyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2wgY29udHJvbElkPVwiZDNmb3JtYXRcIiBwbGFjZWhvbGRlcj1cIiV5LyVtLyVkXCIgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY3VycmVuY3lcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdNZXRyaWMgY3VycmVuY3knKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxDdXJyZW5jeUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3lTZWxlY3RPdmVycmlkZVByb3BzPXt7XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IHQoJ1NlbGVjdCBvciB0eXBlIGN1cnJlbmN5IHN5bWJvbCcpLFxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBzeW1ib2xTZWxlY3RBZGRpdGlvbmFsU3R5bGVzPXtjc3NgXG4gICAgICAgICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAzMCU7XG4gICAgICAgICAgICAgICAgICAgIGB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmllZCBieScpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWVkX2J5XCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgICAgICdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgbWV0cmljJyxcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpY2F0aW9uX2RldGFpbHNcIlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdEZXRhaWxzIG9mIHRoZSBjZXJ0aWZpY2F0aW9uJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdXYXJuaW5nJyl9XG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ3YXJuaW5nX21hcmtkb3duXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnT3B0aW9uYWwgd2FybmluZyBhYm91dCB1c2Ugb2YgdGhpcyBtZXRyaWMnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwid2FybmluZ19tYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwibWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L0ZpZWxkc2V0PlxuICAgICAgICAgIDwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgfVxuICAgICAgICBjb2xsZWN0aW9uPXtzb3J0ZWRNZXRyaWNzfVxuICAgICAgICBhbGxvd0FkZEl0ZW1cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMsICdtZXRyaWNzJyl9XG4gICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoJzxuZXcgbWV0cmljPicpLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogJycsXG4gICAgICAgICAgZXhwcmVzc2lvbjogJycsXG4gICAgICAgIH0pfVxuICAgICAgICBpdGVtQ2VsbFByb3BzPXt7XG4gICAgICAgICAgZXhwcmVzc2lvbjogKCkgPT4gKHtcbiAgICAgICAgICAgIHdpZHRoOiAnMjQwcHgnLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9fVxuICAgICAgICBpdGVtUmVuZGVyZXJzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6ICh2LCBvbkNoYW5nZSwgXywgcmVjb3JkKSA9PiAoXG4gICAgICAgICAgICA8RmxleFJvd0NvbnRhaW5lcj5cbiAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtyZWNvcmQud2FybmluZ19tYXJrZG93biAmJiAoXG4gICAgICAgICAgICAgICAgPFdhcm5pbmdJY29uV2l0aFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgIHdhcm5pbmdNYXJrZG93bj17cmVjb3JkLndhcm5pbmdfbWFya2Rvd259XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPEVkaXRhYmxlVGl0bGUgY2FuRWRpdCB0aXRsZT17dn0gb25TYXZlVGl0bGU9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICAgPC9GbGV4Um93Q29udGFpbmVyPlxuICAgICAgICAgICksXG4gICAgICAgICAgdmVyYm9zZV9uYW1lOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgIDxUZXh0Q29udHJvbCBjYW5FZGl0IHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgICBleHByZXNzaW9uOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgY2FuRWRpdFxuICAgICAgICAgICAgICBpbml0aWFsVmFsdWU9e3Z9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzPXtbJ2RhdGFzb3VyY2Utc3FsLWV4cHJlc3Npb24nXX1cbiAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJzcWxcIlxuICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgbWluTGluZXM9ezV9XG4gICAgICAgICAgICAgIHRleHRBcmVhU3R5bGVzPXt7IG1pbldpZHRoOiAnMjAwcHgnLCBtYXhXaWR0aDogJzQ1MHB4JyB9fVxuICAgICAgICAgICAgICByZXNpemU9XCJib3RoXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogKHYsIG9uQ2hhbmdlLCBsYWJlbCkgPT4gKFxuICAgICAgICAgICAgPFN0YWNrZWRGaWVsZFxuICAgICAgICAgICAgICBsYWJlbD17bGFiZWx9XG4gICAgICAgICAgICAgIGZvcm1FbGVtZW50PXs8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkNoYW5nZX0gLz59XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZDNmb3JtYXQ6ICh2LCBvbkNoYW5nZSwgbGFiZWwpID0+IChcbiAgICAgICAgICAgIDxTdGFja2VkRmllbGRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICBmb3JtRWxlbWVudD17PFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICB9fVxuICAgICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgICAgc3RpY2t5SGVhZGVyXG4gICAgICAvPlxuICAgICk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlLCBhY3RpdmVUYWJLZXkgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBtZXRyaWNzIH0gPSBkYXRhc291cmNlO1xuICAgIGNvbnN0IHNvcnRlZE1ldHJpY3MgPSBtZXRyaWNzPy5sZW5ndGggPyB0aGlzLnNvcnRNZXRyaWNzKG1ldHJpY3MpIDogW107XG4gICAgY29uc3QgeyB0aGVtZSB9ID0gdGhpcy5wcm9wcztcblxuICAgIHJldHVybiAoXG4gICAgICA8RGF0YXNvdXJjZUNvbnRhaW5lciBkYXRhLXRlc3Q9XCJkYXRhc291cmNlLWVkaXRvclwiPlxuICAgICAgICB7dGhpcy5yZW5kZXJFcnJvcnMoKX1cbiAgICAgICAgPEFsZXJ0XG4gICAgICAgICAgY3NzPXt0aGVtZSA9PiAoeyBtYXJnaW5Cb3R0b206IHRoZW1lLmdyaWRVbml0ICogNCB9KX1cbiAgICAgICAgICB0eXBlPVwid2FybmluZ1wiXG4gICAgICAgICAgbWVzc2FnZT17XG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7JyAnfVxuICAgICAgICAgICAgICA8c3Ryb25nPnt0KCdCZSBjYXJlZnVsLicpfSA8L3N0cm9uZz5cbiAgICAgICAgICAgICAge3QoXG4gICAgICAgICAgICAgICAgJ0NoYW5naW5nIHRoZXNlIHNldHRpbmdzIHdpbGwgYWZmZWN0IGFsbCBjaGFydHMgdXNpbmcgdGhpcyBkYXRhc2V0LCBpbmNsdWRpbmcgY2hhcnRzIG93bmVkIGJ5IG90aGVyIHBlb3BsZS4nLFxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgICA8U3R5bGVkVGFibGVUYWJzXG4gICAgICAgICAgZnVsbFdpZHRoPXtmYWxzZX1cbiAgICAgICAgICBpZD1cInRhYmxlLXRhYnNcIlxuICAgICAgICAgIGRhdGEtdGVzdD1cImVkaXQtZGF0YXNldC10YWJzXCJcbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVUYWJTZWxlY3R9XG4gICAgICAgICAgZGVmYXVsdEFjdGl2ZUtleT17YWN0aXZlVGFiS2V5fVxuICAgICAgICA+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSBrZXk9ezB9IHRhYj17dCgnU291cmNlJyl9PlxuICAgICAgICAgICAge3RoaXMucmVuZGVyU291cmNlRmllbGRzZXQodGhlbWUpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgIHRhYj17XG4gICAgICAgICAgICAgIDxDb2xsZWN0aW9uVGFiVGl0bGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uPXtzb3J0ZWRNZXRyaWNzfVxuICAgICAgICAgICAgICAgIHRpdGxlPXt0KCdNZXRyaWNzJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXk9ezF9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge3RoaXMucmVuZGVyTWV0cmljQ29sbGVjdGlvbigpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgIHRhYj17XG4gICAgICAgICAgICAgIDxDb2xsZWN0aW9uVGFiVGl0bGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uPXt0aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1uc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnQ29sdW1ucycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXsyfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgICAgPFN0eWxlZEJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvblNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwidGVydGlhcnlcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnN5bmNNZXRhZGF0YX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic3luYy1mcm9tLXNvdXJjZVwiXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxJY29ucy5EYXRhYmFzZU91dGxpbmVkIGljb25TaXplPVwibVwiIC8+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdTeW5jIGNvbHVtbnMgZnJvbSBzb3VyY2UnKX1cbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgPC9Db2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQ29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29sdW1ucy10YWJsZVwiXG4gICAgICAgICAgICAgICAgY29sdW1ucz17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgZGF0YXNvdXJjZT17ZGF0YXNvdXJjZX1cbiAgICAgICAgICAgICAgICBvbkNvbHVtbnNDaGFuZ2U9e2RhdGFiYXNlQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgZGF0YWJhc2VDb2x1bW5zIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLm1ldGFkYXRhTG9hZGluZyAmJiA8TG9hZGluZyAvPn1cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgPENvbGxlY3Rpb25UYWJUaXRsZVxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb249e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NhbGN1bGF0ZWQgY29sdW1ucycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXszfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkNvbGxlY3Rpb25UYWJsZVxuICAgICAgICAgICAgICAgIGNvbHVtbnM9e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgb25Db2x1bW5zQ2hhbmdlPXtjYWxjdWxhdGVkQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgY2FsY3VsYXRlZENvbHVtbnMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29sdW1uTGFiZWxUb29sdGlwcz17e1xuICAgICAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoXG4gICAgICAgICAgICAgICAgICAgICdUaGlzIGZpZWxkIGlzIHVzZWQgYXMgYSB1bmlxdWUgaWRlbnRpZmllciB0byBhdHRhY2ggJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBjYWxjdWxhdGVkIGRpbWVuc2lvbiB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAnYXMgdGhlIGFsaWFzIGluIHRoZSBTUUwgcXVlcnkuJyxcbiAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lXG4gICAgICAgICAgICAgICAgc2hvd0V4cHJlc3Npb25cbiAgICAgICAgICAgICAgICBhbGxvd0FkZEl0ZW1cbiAgICAgICAgICAgICAgICBhbGxvd0VkaXREYXRhVHlwZVxuICAgICAgICAgICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnPG5ldyBjb2x1bW4+JyksXG4gICAgICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZ3JvdXBieTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IHQoJzxlbnRlciBTUUwgZXhwcmVzc2lvbiBoZXJlPicpLFxuICAgICAgICAgICAgICAgICAgX19leHBhbmRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSBrZXk9ezR9IHRhYj17dCgnU2V0dGluZ3MnKX0+XG4gICAgICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj57dGhpcy5yZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCl9PC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgPEZvcm1Db250YWluZXI+e3RoaXMucmVuZGVyQWR2YW5jZWRGaWVsZHNldCgpfTwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgPC9TdHlsZWRUYWJsZVRhYnM+XG4gICAgICA8L0RhdGFzb3VyY2VDb250YWluZXI+XG4gICAgKTtcbiAgfVxufVxuXG5EYXRhc291cmNlRWRpdG9yLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcbkRhdGFzb3VyY2VFZGl0b3IucHJvcFR5cGVzID0gcHJvcFR5cGVzO1xuXG5jb25zdCBEYXRhU291cmNlQ29tcG9uZW50ID0gd2l0aFRoZW1lKERhdGFzb3VyY2VFZGl0b3IpO1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoVG9hc3RzKERhdGFTb3VyY2VDb21wb25lbnQpO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\n\nclass DatasourceEditor extends PureComponent {\n  constructor(props) {var _props$datasource$met;\n    super(props);\n    this.state = {\n      datasource: {\n        ...props.datasource,\n        owners: props.datasource.owners.map((owner) => ({\n          value: owner.value || owner.id,\n          label: owner.label || `${owner.first_name} ${owner.last_name}`\n        })),\n        metrics: (_props$datasource$met = props.datasource.metrics) == null ? void 0 : _props$datasource$met.map((metric) => {\n          const {\n            certified_by: certifiedByMetric,\n            certification_details: certificationDetails\n          } = metric;\n          const {\n            certification: { details, certified_by: certifiedBy } = {},\n            warning_markdown: warningMarkdown\n          } = JSON.parse(metric.extra || '{}') || {};\n          return {\n            ...metric,\n            certification_details: certificationDetails || details,\n            warning_markdown: warningMarkdown || '',\n            certified_by: certifiedBy || certifiedByMetric\n          };\n        })\n      },\n      errors: [],\n      isSqla:\n      props.datasource.datasource_type === 'table' ||\n      props.datasource.type === 'table',\n      isEditMode: false,\n      databaseColumns: props.datasource.columns.filter((col) => !col.expression),\n      calculatedColumns: props.datasource.columns.filter(\n        (col) => !!col.expression\n      ),\n      metadataLoading: false,\n      activeTabKey: 0,\n      datasourceType: props.datasource.sql ?\n      DATASOURCE_TYPES.virtual.key :\n      DATASOURCE_TYPES.physical.key\n    };\n\n    this.onChange = this.onChange.bind(this);\n    this.onChangeEditMode = this.onChangeEditMode.bind(this);\n    this.onDatasourcePropChange = this.onDatasourcePropChange.bind(this);\n    this.onDatasourceChange = this.onDatasourceChange.bind(this);\n    this.tableChangeAndSyncMetadata =\n    this.tableChangeAndSyncMetadata.bind(this);\n    this.syncMetadata = this.syncMetadata.bind(this);\n    this.setColumns = this.setColumns.bind(this);\n    this.validateAndChange = this.validateAndChange.bind(this);\n    this.handleTabSelect = this.handleTabSelect.bind(this);\n    this.currencies = ensureIsArray(props.currencies).map((currencyCode) => ({\n      value: currencyCode,\n      label: `${getCurrencySymbol({\n        symbol: currencyCode\n      })} (${currencyCode})`\n    }));\n  }\n\n  onChange() {\n    // Emptying SQL if \"Physical\" radio button is selected\n    // Currently the logic to know whether the source is\n    // physical or virtual is based on whether SQL is empty or not.\n    const { datasourceType, datasource } = this.state;\n    const sql =\n    datasourceType === DATASOURCE_TYPES.physical.key ? '' : datasource.sql;\n    const newDatasource = {\n      ...this.state.datasource,\n      sql,\n      columns: [...this.state.databaseColumns, ...this.state.calculatedColumns]\n    };\n    this.props.onChange(newDatasource, this.state.errors);\n  }\n\n  onChangeEditMode() {\n    this.props.setIsEditing(!this.state.isEditMode);\n    this.setState((prevState) => ({ isEditMode: !prevState.isEditMode }));\n  }\n\n  onDatasourceChange(datasource, callback = this.validateAndChange) {\n    this.setState({ datasource }, callback);\n  }\n\n  onDatasourcePropChange(attr, value) {\n    if (value === undefined) return; // if value is undefined do not update state\n    const datasource = { ...this.state.datasource, [attr]: value };\n    this.setState(\n      (prevState) => ({\n        datasource: { ...prevState.datasource, [attr]: value }\n      }),\n      attr === 'table_name' ?\n      this.onDatasourceChange(datasource, this.tableChangeAndSyncMetadata) :\n      this.onDatasourceChange(datasource, this.validateAndChange)\n    );\n  }\n\n  onDatasourceTypeChange(datasourceType) {\n    this.setState({ datasourceType });\n  }\n\n  setColumns(obj) {\n    // update calculatedColumns or databaseColumns\n    this.setState(obj, this.validateAndChange);\n  }\n\n  validateAndChange() {\n    this.validate(this.onChange);\n  }\n\n  tableChangeAndSyncMetadata() {\n    this.validate(() => {\n      this.syncMetadata();\n      this.onChange();\n    });\n  }\n\n  async syncMetadata() {\n    const { datasource } = this.state;\n    this.setState({ metadataLoading: true });\n    try {\n      const newCols = await fetchSyncedColumns(datasource);\n      const columnChanges = updateColumns(\n        datasource.columns,\n        newCols,\n        this.props.addSuccessToast\n      );\n      this.setColumns({\n        databaseColumns: columnChanges.finalColumns.filter(\n          (col) => !col.expression // remove calculated columns\n        )\n      });\n      this.props.addSuccessToast(t('Metadata has been synced'));\n      this.setState({ metadataLoading: false });\n    } catch (error) {\n      const { error: clientError, statusText } =\n      await getClientErrorObject(error);\n      this.props.addDangerToast(\n        clientError || statusText || t('An error has occurred')\n      );\n      this.setState({ metadataLoading: false });\n    }\n  }\n\n  findDuplicates(arr, accessor) {\n    const seen = {};\n    const dups = [];\n    arr.forEach((obj) => {\n      const item = accessor(obj);\n      if (item in seen) {\n        dups.push(item);\n      } else {\n        seen[item] = null;\n      }\n    });\n    return dups;\n  }\n\n  validate(callback) {\n    let errors = [];\n    let dups;\n    const { datasource } = this.state;\n\n    // Looking for duplicate column_name\n    dups = this.findDuplicates(datasource.columns, (obj) => obj.column_name);\n    errors = errors.concat(\n      dups.map((name) => t('Column name [%s] is duplicated', name))\n    );\n\n    // Looking for duplicate metric_name\n    dups = this.findDuplicates(datasource.metrics, (obj) => obj.metric_name);\n    errors = errors.concat(\n      dups.map((name) => t('Metric name [%s] is duplicated', name))\n    );\n\n    // Making sure calculatedColumns have an expression defined\n    const noFilterCalcCols = this.state.calculatedColumns.filter(\n      (col) => !col.expression && !col.json\n    );\n    errors = errors.concat(\n      noFilterCalcCols.map((col) =>\n      t('Calculated column [%s] requires an expression', col.column_name)\n      )\n    );\n\n    // validate currency code\n    try {var _this$state$datasourc;\n      (_this$state$datasourc = this.state.datasource.metrics) == null ? void 0 : _this$state$datasourc.forEach(\n        (metric) => {var _metric$currency;return (\n            ((_metric$currency = metric.currency) == null ? void 0 : _metric$currency.symbol) &&\n            new Intl.NumberFormat('en-US', {\n              style: 'currency',\n              currency: metric.currency.symbol\n            }));}\n      );\n    } catch {\n      errors = errors.concat([t('Invalid currency code in saved metrics')]);\n    }\n\n    this.setState({ errors }, callback);\n  }\n\n  handleTabSelect(activeTabKey) {\n    this.setState({ activeTabKey });\n  }\n\n  sortMetrics(metrics) {\n    return metrics.sort(({ id: a }, { id: b }) => b - a);\n  }\n\n  renderSettingsFieldset() {\n    const { datasource } = this.state;\n    return (\n      _jsxs(Fieldset, {\n        title: t('Basic'),\n        item: datasource,\n        onChange: this.onDatasourceChange, children: [\n\n        _jsx(Field, {\n          fieldKey: \"description\",\n          label: t('Description'),\n          control:\n          _jsx(TextAreaControl, {\n            language: \"markdown\",\n            offerEditInModal: false,\n            resize: \"vertical\" }\n          ) }\n\n        ),\n        _jsx(Field, {\n          fieldKey: \"default_endpoint\",\n          label: t('Default URL'),\n          description: t(\n            `Default URL to redirect to when accessing from the dataset list page.\n            Accepts relative URLs such as <span style=„white-space: nowrap;”>/superset/dashboard/{id}/</span>`\n          ),\n          control: _jsx(TextControl, { controlId: \"default_endpoint\" }) }\n        ),\n        _jsx(Field, {\n          inline: true,\n          fieldKey: \"filter_select_enabled\",\n          label: t('Autocomplete filters'),\n          description: t('Whether to populate autocomplete filters options'),\n          control: _jsx(CheckboxControl, {}) }\n        ),\n        this.state.isSqla &&\n        _jsx(Field, {\n          fieldKey: \"fetch_values_predicate\",\n          label: t('Autocomplete query predicate'),\n          description: t(\n            'When using \"Autocomplete filters\", this can be used to improve performance ' +\n            'of the query fetching the values. Use this option to apply a ' +\n            'predicate (WHERE clause) to the query selecting the distinct ' +\n            'values from the table. Typically the intent would be to limit the scan ' +\n            'by applying a relative time filter on a partitioned or indexed time-related field.'\n          ),\n          control:\n          _jsx(TextAreaControl, {\n            language: \"sql\",\n            controlId: \"fetch_values_predicate\",\n            minLines: 5,\n            resize: \"vertical\" }\n          ) }\n\n        ),\n\n        this.state.isSqla &&\n        _jsx(Field, {\n          fieldKey: \"extra\",\n          label: t('Extra'),\n          description: t(\n            'Extra data to specify table metadata. Currently supports ' +\n            'metadata of the format: `{ \"certification\": { \"certified_by\": ' +\n            '\"Data Platform Team\", \"details\": \"This table is the source of truth.\" ' +\n            '}, \"warning_markdown\": \"This is a warning.\" }`.'\n          ),\n          control:\n          _jsx(TextAreaControl, {\n            controlId: \"extra\",\n            language: \"json\",\n            offerEditInModal: false,\n            resize: \"vertical\" }\n          ) }\n\n        ),\n\n        _jsx(OwnersSelector, {\n          datasource: datasource,\n          onChange: (newOwners) => {\n            this.onDatasourceChange({ ...datasource, owners: newOwners });\n          } }\n        )] }\n      ));\n\n  }\n\n  renderAdvancedFieldset() {\n    const { datasource } = this.state;\n    return (\n      _jsxs(Fieldset, {\n        title: t('Advanced'),\n        item: datasource,\n        onChange: this.onDatasourceChange, children: [\n\n        _jsx(Field, {\n          fieldKey: \"cache_timeout\",\n          label: t('Cache timeout'),\n          description: t(\n            'The duration of time in seconds before the cache is invalidated. Set to -1 to bypass the cache.'\n          ),\n          control: _jsx(TextControl, { controlId: \"cache_timeout\" }) }\n        ),\n        _jsx(Field, {\n          fieldKey: \"offset\",\n          label: t('Hours offset'),\n          control: _jsx(TextControl, { controlId: \"offset\" }),\n          description: t(\n            'The number of hours, negative or positive, to shift the time column. This can be used to move UTC time to local time.'\n          ) }\n        ),\n        this.state.isSqla &&\n        _jsx(Field, {\n          fieldKey: \"template_params\",\n          label: t('Template parameters'),\n          description: t(\n            'A set of parameters that become available in the query using Jinja templating syntax'\n          ),\n          control: _jsx(TextControl, { controlId: \"template_params\" }) }\n        ),\n\n        _jsx(Field, {\n          inline: true,\n          fieldKey: \"normalize_columns\",\n          label: t('Normalize column names'),\n          description: t(\n            'Allow column names to be changed to case insensitive format, if supported (e.g. Oracle, Snowflake).'\n          ),\n          control: _jsx(CheckboxControl, { controlId: \"normalize_columns\" }) }\n        ),\n        _jsx(Field, {\n          inline: true,\n          fieldKey: \"always_filter_main_dttm\",\n          label: t('Always filter main datetime column'),\n          description: t(\n            `When the secondary temporal columns are filtered, apply the same filter to the main datetime column.`\n          ),\n          control: _jsx(CheckboxControl, { controlId: \"always_filter_main_dttm\" }) }\n        )] }\n      ));\n\n  }\n\n  renderSpatialTab() {\n    const { datasource } = this.state;\n    const { spatials, all_cols: allCols } = datasource;\n    return (\n      _jsx(Tabs.TabPane, {\n        tab: _jsx(CollectionTabTitle, { collection: spatials, title: t('Spatial') }), children:\n\n\n        _jsx(CollectionTable, {\n          tableColumns: ['name', 'config'],\n          onChange: this.onDatasourcePropChange.bind(this, 'spatials'),\n          itemGenerator: () => ({\n            name: t('<new spatial>'),\n            type: t('<no type>'),\n            config: null\n          }),\n          collection: spatials,\n          allowDeletes: true,\n          itemRenderers: {\n            name: (d, onChange) =>\n            _jsx(EditableTitle, { canEdit: true, title: d, onSaveTitle: onChange }),\n\n            config: (v, onChange) =>\n            _jsx(SpatialControl, { value: v, onChange: onChange, choices: allCols })\n\n          } }\n        ) }, 4\n      ));\n\n  }\n\n  renderSourceFieldset() {var _datasource$database, _datasource$database2, _datasource$database3;\n    const { datasource } = this.state;\n    return (\n      _jsxs(\"div\", { children: [\n        _jsxs(EditLockContainer, { children: [\n          _jsx(\"span\", { role: \"button\", tabIndex: 0, onClick: this.onChangeEditMode, children:\n            this.state.isEditMode ?\n            _jsx(Icons.UnlockOutlined, {\n              iconSize: \"xl\",\n              css: (theme) => css`\n                  margin: auto ${theme.gridUnit}px auto 0;\n                ` }\n            ) :\n\n            _jsx(Icons.LockOutlined, {\n              iconSize: \"xl\",\n              css: (theme) => ({\n                margin: `auto ${theme.gridUnit}px auto 0`\n              }) }\n            ) }\n\n          ),\n          !this.state.isEditMode &&\n          _jsx(\"div\", { children: t('Click the lock to make changes.') }),\n\n          this.state.isEditMode &&\n          _jsx(\"div\", { children: t('Click the lock to prevent further changes.') })] }\n\n        ),\n        _jsx(\"div\", { className: \"m-l-10 m-t-20 m-b-10\", children:\n          DATASOURCE_TYPES_ARR.map((type) =>\n          _jsx(Radio, {\n\n            value: type.key,\n            inline: true,\n            onChange: this.onDatasourceTypeChange.bind(this, type.key),\n            checked: this.state.datasourceType === type.key,\n            disabled: !this.state.isEditMode, children:\n\n            type.label }, type.key\n          )\n          ) }\n        ),\n        _jsx(\"hr\", {}),\n        _jsxs(Fieldset, { item: datasource, onChange: this.onDatasourceChange, compact: true, children: [\n          this.state.datasourceType === DATASOURCE_TYPES.virtual.key &&\n          _jsx(\"div\", { children:\n            this.state.isSqla &&\n            _jsxs(_Fragment, { children: [\n              _jsxs(Col, { xs: 24, md: 12, children: [\n                _jsx(Field, {\n                  fieldKey: \"databaseSelector\",\n                  label: t('Virtual'),\n                  control:\n                  _jsx(\"div\", { css: _ref2, children:\n                    _jsx(DatabaseSelector, {\n                      db: datasource == null ? void 0 : datasource.database,\n                      catalog: datasource.catalog,\n                      schema: datasource.schema,\n                      onCatalogChange: (catalog) =>\n                      this.state.isEditMode &&\n                      this.onDatasourcePropChange('catalog', catalog),\n\n                      onSchemaChange: (schema) =>\n                      this.state.isEditMode &&\n                      this.onDatasourcePropChange('schema', schema),\n\n                      onDbChange: (database) =>\n                      this.state.isEditMode &&\n                      this.onDatasourcePropChange('database', database),\n\n                      formMode: false,\n                      handleError: this.props.addDangerToast,\n                      readOnly: !this.state.isEditMode }\n                    ) }\n                  ) }\n\n                ),\n                _jsx(\"div\", { css: /*#__PURE__*/_css({ width: 'calc(100% - 34px)', marginTop: -16 }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:DatasourceEditor;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2FkZWwvc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEyaEN5QiIsImZpbGUiOiIvaG9tZS9hZGVsL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL0RhdGFzb3VyY2UvRGF0YXNvdXJjZUVkaXRvci5qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgQ2FyZCBmcm9tICdzcmMvY29tcG9uZW50cy9DYXJkJztcbmltcG9ydCBBbGVydCBmcm9tICdzcmMvY29tcG9uZW50cy9BbGVydCc7XG5pbXBvcnQgQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQmFkZ2UnO1xuaW1wb3J0IHtcbiAgY3NzLFxuICBpc0ZlYXR1cmVFbmFibGVkLFxuICBnZXRDdXJyZW5jeVN5bWJvbCxcbiAgZW5zdXJlSXNBcnJheSxcbiAgRmVhdHVyZUZsYWcsXG4gIHN0eWxlZCxcbiAgU3VwZXJzZXRDbGllbnQsXG4gIHQsXG4gIHdpdGhUaGVtZSxcbiAgZ2V0Q2xpZW50RXJyb3JPYmplY3QsXG59IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCB7IFNlbGVjdCwgQXN5bmNTZWxlY3QsIFJvdywgQ29sIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMnO1xuaW1wb3J0IHsgRm9ybUxhYmVsIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvRm9ybSc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJ3NyYy9jb21wb25lbnRzL0J1dHRvbic7XG5pbXBvcnQgVGFicyBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJzJztcbmltcG9ydCBDZXJ0aWZpZWRCYWRnZSBmcm9tICdzcmMvY29tcG9uZW50cy9DZXJ0aWZpZWRCYWRnZSc7XG5pbXBvcnQgV2FybmluZ0ljb25XaXRoVG9vbHRpcCBmcm9tICdzcmMvY29tcG9uZW50cy9XYXJuaW5nSWNvbldpdGhUb29sdGlwJztcbmltcG9ydCBEYXRhYmFzZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL0RhdGFiYXNlU2VsZWN0b3InO1xuaW1wb3J0IExhYmVsIGZyb20gJ3NyYy9jb21wb25lbnRzL0xhYmVsJztcbmltcG9ydCBMb2FkaW5nIGZyb20gJ3NyYy9jb21wb25lbnRzL0xvYWRpbmcnO1xuaW1wb3J0IFRhYmxlU2VsZWN0b3IgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFibGVTZWxlY3Rvcic7XG5pbXBvcnQgRWRpdGFibGVUaXRsZSBmcm9tICdzcmMvY29tcG9uZW50cy9FZGl0YWJsZVRpdGxlJztcbmltcG9ydCBDaGVja2JveENvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9DaGVja2JveENvbnRyb2wnO1xuaW1wb3J0IFRleHRDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvVGV4dENvbnRyb2wnO1xuaW1wb3J0IFRleHRBcmVhQ29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1RleHRBcmVhQ29udHJvbCc7XG5pbXBvcnQgU3BhdGlhbENvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9TcGF0aWFsQ29udHJvbCc7XG5pbXBvcnQgd2l0aFRvYXN0cyBmcm9tICdzcmMvY29tcG9uZW50cy9NZXNzYWdlVG9hc3RzL3dpdGhUb2FzdHMnO1xuaW1wb3J0IEljb25zIGZyb20gJ3NyYy9jb21wb25lbnRzL0ljb25zJztcbmltcG9ydCBDdXJyZW5jeUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9DdXJyZW5jeUNvbnRyb2wnO1xuaW1wb3J0IENvbGxlY3Rpb25UYWJsZSBmcm9tICcuL0NvbGxlY3Rpb25UYWJsZSc7XG5pbXBvcnQgRmllbGRzZXQgZnJvbSAnLi9GaWVsZHNldCc7XG5pbXBvcnQgRmllbGQgZnJvbSAnLi9GaWVsZCc7XG5pbXBvcnQgeyBmZXRjaFN5bmNlZENvbHVtbnMsIHVwZGF0ZUNvbHVtbnMgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3QgRGF0YXNvdXJjZUNvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIC5jaGFuZ2Utd2FybmluZyB7XG4gICAgbWFyZ2luOiAxNnB4IDEwcHggMDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMud2FybmluZy5iYXNlfTtcbiAgfVxuXG4gIC5jaGFuZ2Utd2FybmluZyAuYm9sZCB7XG4gICAgZm9udC13ZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS53ZWlnaHRzLmJvbGR9O1xuICB9XG5cbiAgLmZvcm0tZ3JvdXAuaGFzLWZlZWRiYWNrID4gLmhlbHAtYmxvY2sge1xuICAgIG1hcmdpbi10b3A6IDhweDtcbiAgfVxuXG4gIC5mb3JtLWdyb3VwLmZvcm0tZ3JvdXAtbWQge1xuICAgIG1hcmdpbi1ib3R0b206IDhweDtcbiAgfVxuYDtcblxuY29uc3QgRmxleFJvd0NvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGRpc3BsYXk6IGZsZXg7XG5cbiAgc3ZnIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZFRhYmxlVGFicyA9IHN0eWxlZChUYWJzKWBcbiAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIC5hbnQtdGFicy1jb250ZW50LWhvbGRlciB7XG4gICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZEJhZGdlID0gc3R5bGVkKEJhZGdlKWBcbiAgLmFudGQ1LWJhZGdlLWNvdW50IHtcbiAgICBsaW5lLWhlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgaGVpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgRWRpdExvY2tDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBmb250LXNpemU6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS5zaXplcy5zfXB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBhIHtcbiAgICBwYWRkaW5nOiAwIDEwcHg7XG4gIH1cbmA7XG5cbmNvbnN0IENvbHVtbkJ1dHRvbldyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICB0ZXh0LWFsaWduOiByaWdodDtcbiAgJHsoeyB0aGVtZSB9KSA9PiBgbWFyZ2luLWJvdHRvbTogJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHhgfVxuYDtcblxuY29uc3QgU3R5bGVkTGFiZWxXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgc3BhbiB7XG4gICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRDb2x1bW5zVGFiV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIC50YWJsZSA+IHRib2R5ID4gdHIgPiB0ZCB7XG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgfVxuXG4gIC5hbnQtdGFnIHtcbiAgICBtYXJnaW4tdG9wOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRCdXR0b25XcmFwcGVyID0gc3R5bGVkLnNwYW5gXG4gICR7KHsgdGhlbWUgfSkgPT4gYFxuICAgIG1hcmdpbi10b3A6ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4O1xuICAgIG1hcmdpbi1sZWZ0OiAke3RoZW1lLmdyaWRVbml0ICogM31weDtcbiAgICBidXR0b24+c3Bhbj46Zmlyc3Qtb2YtdHlwZSB7XG4gICAgICBtYXJnaW4tcmlnaHQ6IDA7XG4gICAgfVxuICBgfVxuYDtcblxuY29uc3Qgc3FsVG9vbHRpcE9wdGlvbnMgPSB7XG4gIHBsYWNlbWVudDogJ3RvcFJpZ2h0JyxcbiAgdGl0bGU6IHQoXG4gICAgJ0lmIGNoYW5nZXMgYXJlIG1hZGUgdG8geW91ciBTUUwgcXVlcnksICcgK1xuICAgICAgJ2NvbHVtbnMgaW4geW91ciBkYXRhc2V0IHdpbGwgYmUgc3luY2VkIHdoZW4gc2F2aW5nIHRoZSBkYXRhc2V0LicsXG4gICksXG59O1xuXG5jb25zdCBjaGVja2JveEdlbmVyYXRvciA9IChkLCBvbkNoYW5nZSkgPT4gKFxuICA8Q2hlY2tib3hDb250cm9sIHZhbHVlPXtkfSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+XG4pO1xuY29uc3QgREFUQV9UWVBFUyA9IFtcbiAgeyB2YWx1ZTogJ1NUUklORycsIGxhYmVsOiB0KCdTVFJJTkcnKSB9LFxuICB7IHZhbHVlOiAnTlVNRVJJQycsIGxhYmVsOiB0KCdOVU1FUklDJykgfSxcbiAgeyB2YWx1ZTogJ0RBVEVUSU1FJywgbGFiZWw6IHQoJ0RBVEVUSU1FJykgfSxcbiAgeyB2YWx1ZTogJ0JPT0xFQU4nLCBsYWJlbDogdCgnQk9PTEVBTicpIH0sXG5dO1xuXG5jb25zdCBEQVRBU09VUkNFX1RZUEVTX0FSUiA9IFtcbiAgeyBrZXk6ICdwaHlzaWNhbCcsIGxhYmVsOiB0KCdQaHlzaWNhbCAodGFibGUgb3IgdmlldyknKSB9LFxuICB7IGtleTogJ3ZpcnR1YWwnLCBsYWJlbDogdCgnVmlydHVhbCAoU1FMKScpIH0sXG5dO1xuY29uc3QgREFUQVNPVVJDRV9UWVBFUyA9IHt9O1xuREFUQVNPVVJDRV9UWVBFU19BUlIuZm9yRWFjaChvID0+IHtcbiAgREFUQVNPVVJDRV9UWVBFU1tvLmtleV0gPSBvO1xufSk7XG5cbmZ1bmN0aW9uIENvbGxlY3Rpb25UYWJUaXRsZSh7IHRpdGxlLCBjb2xsZWN0aW9uIH0pIHtcbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjc3M9e3sgZGlzcGxheTogJ2ZsZXgnLCBhbGlnbkl0ZW1zOiAnY2VudGVyJyB9fVxuICAgICAgZGF0YS10ZXN0PXtgY29sbGVjdGlvbi10YWItJHt0aXRsZX1gfVxuICAgID5cbiAgICAgIHt0aXRsZX17JyAnfVxuICAgICAgPFN0eWxlZEJhZGdlIGNvdW50PXtjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwfSBzaG93WmVybyAvPlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5Db2xsZWN0aW9uVGFiVGl0bGUucHJvcFR5cGVzID0ge1xuICB0aXRsZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgY29sbGVjdGlvbjogUHJvcFR5cGVzLmFycmF5LFxufTtcblxuZnVuY3Rpb24gQ29sdW1uQ29sbGVjdGlvblRhYmxlKHtcbiAgY29sdW1ucyxcbiAgZGF0YXNvdXJjZSxcbiAgb25Db2x1bW5zQ2hhbmdlLFxuICBvbkRhdGFzb3VyY2VDaGFuZ2UsXG4gIGVkaXRhYmxlQ29sdW1uTmFtZSxcbiAgc2hvd0V4cHJlc3Npb24sXG4gIGFsbG93QWRkSXRlbSxcbiAgYWxsb3dFZGl0RGF0YVR5cGUsXG4gIGl0ZW1HZW5lcmF0b3IsXG4gIGNvbHVtbkxhYmVsVG9vbHRpcHMsXG59KSB7XG4gIHJldHVybiAoXG4gICAgPENvbGxlY3Rpb25UYWJsZVxuICAgICAgdGFibGVDb2x1bW5zPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ2FkdmFuY2VkX2RhdGFfdHlwZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgIH1cbiAgICAgIHNvcnRDb2x1bW5zPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ2FkdmFuY2VkX2RhdGFfdHlwZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgIH1cbiAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgYWxsb3dBZGRJdGVtPXthbGxvd0FkZEl0ZW19XG4gICAgICBpdGVtR2VuZXJhdG9yPXtpdGVtR2VuZXJhdG9yfVxuICAgICAgY29sbGVjdGlvbj17Y29sdW1uc31cbiAgICAgIGNvbHVtbkxhYmVsVG9vbHRpcHM9e2NvbHVtbkxhYmVsVG9vbHRpcHN9XG4gICAgICBzdGlja3lIZWFkZXJcbiAgICAgIGV4cGFuZEZpZWxkc2V0PXtcbiAgICAgICAgPEZvcm1Db250YWluZXI+XG4gICAgICAgICAgPEZpZWxkc2V0IGNvbXBhY3Q+XG4gICAgICAgICAgICB7c2hvd0V4cHJlc3Npb24gJiYgKFxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImV4cHJlc3Npb25cIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdTUUwgZXhwcmVzc2lvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cInZlcmJvc2VfbmFtZVwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdMYWJlbCcpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cInZlcmJvc2VfbmFtZVwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnTGFiZWwnKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAge2FsbG93RWRpdERhdGFUeXBlICYmIChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ0eXBlXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgIGFyaWFMYWJlbD17dCgnRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9e0RBVEFfVFlQRVN9XG4gICAgICAgICAgICAgICAgICAgIG5hbWU9XCJ0eXBlXCJcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dOZXdPcHRpb25zXG4gICAgICAgICAgICAgICAgICAgIGFsbG93Q2xlYXJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKSA/IChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJhZHZhbmNlZF9kYXRhX3R5cGVcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdBZHZhbmNlZCBkYXRhIHR5cGUnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJhZHZhbmNlZF9kYXRhX3R5cGVcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQWR2YW5jZWQgRGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDw+PC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwicHl0aG9uX2RhdGVfZm9ybWF0XCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0RhdGV0aW1lIGZvcm1hdCcpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17XG4gICAgICAgICAgICAgICAgLyogTm90ZSB0aGUgZnJhZ21lbnRlZCB0cmFuc2xhdGlvbnMgbWF5IG5vdCB3b3JrLiAqL1xuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICB7dCgnVGhlIHBhdHRlcm4gb2YgdGltZXN0YW1wIGZvcm1hdC4gRm9yIHN0cmluZ3MgdXNlICcpfVxuICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZG9jcy5weXRob24ub3JnLzIvbGlicmFyeS9kYXRldGltZS5odG1sI3N0cmZ0aW1lLXN0cnB0aW1lLWJlaGF2aW9yXCI+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdQeXRob24gZGF0ZXRpbWUgc3RyaW5nIHBhdHRlcm4nKX1cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgIHt0KCcgZXhwcmVzc2lvbiB3aGljaCBuZWVkcyB0byBhZGhlcmUgdG8gdGhlICcpfVxuICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0lTT184NjAxXCI+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdJU08gODYwMScpfVxuICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAge3QoYCBzdGFuZGFyZCB0byBlbnN1cmUgdGhhdCB0aGUgbGV4aWNvZ3JhcGhpY2FsIG9yZGVyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgY29pbmNpZGVzIHdpdGggdGhlIGNocm9ub2xvZ2ljYWwgb3JkZXJpbmcuIElmIHRoZVxuICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcCBmb3JtYXQgZG9lcyBub3QgYWRoZXJlIHRvIHRoZSBJU08gODYwMSBzdGFuZGFyZFxuICAgICAgICAgICAgICAgICAgICAgIHlvdSB3aWxsIG5lZWQgdG8gZGVmaW5lIGFuIGV4cHJlc3Npb24gYW5kIHR5cGUgZm9yXG4gICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtaW5nIHRoZSBzdHJpbmcgaW50byBhIGRhdGUgb3IgdGltZXN0YW1wLiBOb3RlXG4gICAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5IHRpbWUgem9uZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIElmIHRpbWUgaXMgc3RvcmVkXG4gICAgICAgICAgICAgICAgICAgICAgaW4gZXBvY2ggZm9ybWF0LCBwdXQgXFxgZXBvY2hfc1xcYCBvciBcXGBlcG9jaF9tc1xcYC4gSWYgbm8gcGF0dGVyblxuICAgICAgICAgICAgICAgICAgICAgIGlzIHNwZWNpZmllZCB3ZSBmYWxsIGJhY2sgdG8gdXNpbmcgdGhlIG9wdGlvbmFsIGRlZmF1bHRzIG9uIGEgcGVyXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UvY29sdW1uIG5hbWUgbGV2ZWwgdmlhIHRoZSBleHRyYSBwYXJhbWV0ZXIuYCl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJweXRob25fZGF0ZV9mb3JtYXRcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIlWS0lbS0lZFwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpZWQgQnknKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ1BlcnNvbiBvciBncm91cCB0aGF0IGhhcyBjZXJ0aWZpZWQgdGhpcyBtZXRyaWMnKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpZWRcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmllZCBieScpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpY2F0aW9uX2RldGFpbHNcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdEZXRhaWxzIG9mIHRoZSBjZXJ0aWZpY2F0aW9uJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWNhdGlvbkRldGFpbHNcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgICAgPC9Gb3JtQ29udGFpbmVyPlxuICAgICAgfVxuICAgICAgY29sdW1uTGFiZWxzPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJ0NvbHVtbicpLFxuICAgICAgICAgICAgICBhZHZhbmNlZF9kYXRhX3R5cGU6IHQoJ0FkdmFuY2VkIGRhdGEgdHlwZScpLFxuICAgICAgICAgICAgICB0eXBlOiB0KCdEYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgZ3JvdXBieTogdCgnSXMgZGltZW5zaW9uJyksXG4gICAgICAgICAgICAgIGlzX2R0dG06IHQoJ0lzIHRlbXBvcmFsJyksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHQoJ0RlZmF1bHQgZGF0ZXRpbWUnKSxcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdCgnSXMgZmlsdGVyYWJsZScpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDoge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnQ29sdW1uJyksXG4gICAgICAgICAgICAgIHR5cGU6IHQoJ0RhdGEgdHlwZScpLFxuICAgICAgICAgICAgICBncm91cGJ5OiB0KCdJcyBkaW1lbnNpb24nKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogdCgnSXMgdGVtcG9yYWwnKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogdCgnRGVmYXVsdCBkYXRldGltZScpLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0KCdJcyBmaWx0ZXJhYmxlJyksXG4gICAgICAgICAgICB9XG4gICAgICB9XG4gICAgICBvbkNoYW5nZT17b25Db2x1bW5zQ2hhbmdlfVxuICAgICAgaXRlbVJlbmRlcmVycz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiAodiwgb25JdGVtQ2hhbmdlLCBfLCByZWNvcmQpID0+XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lID8gKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxFZGl0YWJsZVRpdGxlXG4gICAgICAgICAgICAgICAgICAgICAgY2FuRWRpdFxuICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXt2fVxuICAgICAgICAgICAgICAgICAgICAgIG9uU2F2ZVRpdGxlPXtvbkl0ZW1DaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt2fVxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogKHZhbHVlLCBfb25JdGVtQ2hhbmdlLCBfbGFiZWwsIHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSBkYXRhc291cmNlLm1haW5fZHR0bV9jb2wgPT09IHJlY29yZC5jb2x1bW5fbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFjb2x1bW5zLmZpbmQoXG4gICAgICAgICAgICAgICAgICBjb2x1bW4gPT4gY29sdW1uLmNvbHVtbl9uYW1lID09PSByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgKS5pc19kdHRtO1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PXtgcmFkaW8tZGVmYXVsdC1kdHRtLSR7cmVjb3JkLmNvbHVtbl9uYW1lfWB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NoZWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+XG4gICAgICAgICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0eXBlOiBkID0+IChkID8gPExhYmVsPntkfTwvTGFiZWw+IDogbnVsbCksXG4gICAgICAgICAgICAgIGFkdmFuY2VkX2RhdGFfdHlwZTogZCA9PiAoXG4gICAgICAgICAgICAgICAgPExhYmVsIG9uQ2hhbmdlPXtvbkNvbHVtbnNDaGFuZ2V9PntkfTwvTGFiZWw+XG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIGlzX2R0dG06IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZ3JvdXBieTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgOiB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiAodiwgb25JdGVtQ2hhbmdlLCBfLCByZWNvcmQpID0+XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lID8gKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uSXRlbUNoYW5nZX0gLz5cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgICB7cmVjb3JkLmlzX2NlcnRpZmllZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPENlcnRpZmllZEJhZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRCeT17cmVjb3JkLmNlcnRpZmllZF9ieX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM9e3JlY29yZC5jZXJ0aWZpY2F0aW9uX2RldGFpbHN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAge3Z9XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiAodmFsdWUsIF9vbkl0ZW1DaGFuZ2UsIF9sYWJlbCwgcmVjb3JkKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hlY2tlZCA9IGRhdGFzb3VyY2UubWFpbl9kdHRtX2NvbCA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpc2FibGVkID0gIWNvbHVtbnMuZmluZChcbiAgICAgICAgICAgICAgICAgIGNvbHVtbiA9PiBjb2x1bW4uY29sdW1uX25hbWUgPT09IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICApLmlzX2R0dG07XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgIDxSYWRpb1xuICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3Q9e2ByYWRpby1kZWZhdWx0LWR0dG0tJHtyZWNvcmQuY29sdW1uX25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Y2hlY2tlZH1cbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGF0YXNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHR5cGU6IGQgPT4gKGQgPyA8TGFiZWw+e2R9PC9MYWJlbD4gOiBudWxsKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBncm91cGJ5OiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAvPlxuICApO1xufVxuQ29sdW1uQ29sbGVjdGlvblRhYmxlLnByb3BUeXBlcyA9IHtcbiAgY29sdW1uczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gIGRhdGFzb3VyY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgb25Db2x1bW5zQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkRhdGFzb3VyY2VDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGVkaXRhYmxlQ29sdW1uTmFtZTogUHJvcFR5cGVzLmJvb2wsXG4gIHNob3dFeHByZXNzaW9uOiBQcm9wVHlwZXMuYm9vbCxcbiAgYWxsb3dBZGRJdGVtOiBQcm9wVHlwZXMuYm9vbCxcbiAgYWxsb3dFZGl0RGF0YVR5cGU6IFByb3BUeXBlcy5ib29sLFxuICBpdGVtR2VuZXJhdG9yOiBQcm9wVHlwZXMuZnVuYyxcbn07XG5Db2x1bW5Db2xsZWN0aW9uVGFibGUuZGVmYXVsdFByb3BzID0ge1xuICBlZGl0YWJsZUNvbHVtbk5hbWU6IGZhbHNlLFxuICBzaG93RXhwcmVzc2lvbjogZmFsc2UsXG4gIGFsbG93QWRkSXRlbTogZmFsc2UsXG4gIGFsbG93RWRpdERhdGFUeXBlOiBmYWxzZSxcbiAgaXRlbUdlbmVyYXRvcjogKCkgPT4gKHtcbiAgICBjb2x1bW5fbmFtZTogdCgnPG5ldyBjb2x1bW4+JyksXG4gICAgZmlsdGVyYWJsZTogdHJ1ZSxcbiAgICBncm91cGJ5OiB0cnVlLFxuICB9KSxcbn07XG5cbmZ1bmN0aW9uIFN0YWNrZWRGaWVsZCh7IGxhYmVsLCBmb3JtRWxlbWVudCB9KSB7XG4gIHJldHVybiAoXG4gICAgPGRpdj5cbiAgICAgIDxkaXY+XG4gICAgICAgIDxzdHJvbmc+e2xhYmVsfTwvc3Ryb25nPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2Pntmb3JtRWxlbWVudH08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuU3RhY2tlZEZpZWxkLnByb3BUeXBlcyA9IHtcbiAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGZvcm1FbGVtZW50OiBQcm9wVHlwZXMubm9kZSxcbn07XG5cbmZ1bmN0aW9uIEZvcm1Db250YWluZXIoeyBjaGlsZHJlbiB9KSB7XG4gIHJldHVybiA8Q2FyZCBwYWRkZWQ+e2NoaWxkcmVufTwvQ2FyZD47XG59XG5cbkZvcm1Db250YWluZXIucHJvcFR5cGVzID0ge1xuICBjaGlsZHJlbjogUHJvcFR5cGVzLm5vZGUsXG59O1xuXG5jb25zdCBwcm9wVHlwZXMgPSB7XG4gIGRhdGFzb3VyY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBhZGRTdWNjZXNzVG9hc3Q6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGFkZERhbmdlclRvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBzZXRJc0VkaXRpbmc6IFByb3BUeXBlcy5mdW5jLFxufTtcblxuY29uc3QgZGVmYXVsdFByb3BzID0ge1xuICBvbkNoYW5nZTogKCkgPT4ge30sXG4gIHNldElzRWRpdGluZzogKCkgPT4ge30sXG59O1xuXG5mdW5jdGlvbiBPd25lcnNTZWxlY3Rvcih7IGRhdGFzb3VyY2UsIG9uQ2hhbmdlIH0pIHtcbiAgY29uc3QgbG9hZE9wdGlvbnMgPSB1c2VDYWxsYmFjaygoc2VhcmNoID0gJycsIHBhZ2UsIHBhZ2VTaXplKSA9PiB7XG4gICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IHNlYXJjaCwgcGFnZSwgcGFnZV9zaXplOiBwYWdlU2l6ZSB9KTtcbiAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXRhc2V0L3JlbGF0ZWQvb3duZXJzP3E9JHtxdWVyeX1gLFxuICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gKHtcbiAgICAgIGRhdGE6IHJlc3BvbnNlLmpzb24ucmVzdWx0XG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLmV4dHJhLmFjdGl2ZSlcbiAgICAgICAgLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgfSkpLFxuICAgICAgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCxcbiAgICB9KSk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gKFxuICAgIDxBc3luY1NlbGVjdFxuICAgICAgYXJpYUxhYmVsPXt0KCdTZWxlY3Qgb3duZXJzJyl9XG4gICAgICBtb2RlPVwibXVsdGlwbGVcIlxuICAgICAgbmFtZT1cIm93bmVyc1wiXG4gICAgICB2YWx1ZT17ZGF0YXNvdXJjZS5vd25lcnN9XG4gICAgICBvcHRpb25zPXtsb2FkT3B0aW9uc31cbiAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgIGhlYWRlcj17PEZvcm1MYWJlbD57dCgnT3duZXJzJyl9PC9Gb3JtTGFiZWw+fVxuICAgICAgYWxsb3dDbGVhclxuICAgIC8+XG4gICk7XG59XG5cbmNsYXNzIERhdGFzb3VyY2VFZGl0b3IgZXh0ZW5kcyBQdXJlQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGRhdGFzb3VyY2U6IHtcbiAgICAgICAgLi4ucHJvcHMuZGF0YXNvdXJjZSxcbiAgICAgICAgb3duZXJzOiBwcm9wcy5kYXRhc291cmNlLm93bmVycy5tYXAob3duZXIgPT4gKHtcbiAgICAgICAgICB2YWx1ZTogb3duZXIudmFsdWUgfHwgb3duZXIuaWQsXG4gICAgICAgICAgbGFiZWw6IG93bmVyLmxhYmVsIHx8IGAke293bmVyLmZpcnN0X25hbWV9ICR7b3duZXIubGFzdF9uYW1lfWAsXG4gICAgICAgIH0pKSxcbiAgICAgICAgbWV0cmljczogcHJvcHMuZGF0YXNvdXJjZS5tZXRyaWNzPy5tYXAobWV0cmljID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5TWV0cmljLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpY2F0aW9uRGV0YWlscyxcbiAgICAgICAgICB9ID0gbWV0cmljO1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb246IHsgZGV0YWlscywgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeSB9ID0ge30sXG4gICAgICAgICAgICB3YXJuaW5nX21hcmtkb3duOiB3YXJuaW5nTWFya2Rvd24sXG4gICAgICAgICAgfSA9IEpTT04ucGFyc2UobWV0cmljLmV4dHJhIHx8ICd7fScpIHx8IHt9O1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5tZXRyaWMsXG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uX2RldGFpbHM6IGNlcnRpZmljYXRpb25EZXRhaWxzIHx8IGRldGFpbHMsXG4gICAgICAgICAgICB3YXJuaW5nX21hcmtkb3duOiB3YXJuaW5nTWFya2Rvd24gfHwgJycsXG4gICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5IHx8IGNlcnRpZmllZEJ5TWV0cmljLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICAgIGVycm9yczogW10sXG4gICAgICBpc1NxbGE6XG4gICAgICAgIHByb3BzLmRhdGFzb3VyY2UuZGF0YXNvdXJjZV90eXBlID09PSAndGFibGUnIHx8XG4gICAgICAgIHByb3BzLmRhdGFzb3VyY2UudHlwZSA9PT0gJ3RhYmxlJyxcbiAgICAgIGlzRWRpdE1vZGU6IGZhbHNlLFxuICAgICAgZGF0YWJhc2VDb2x1bW5zOiBwcm9wcy5kYXRhc291cmNlLmNvbHVtbnMuZmlsdGVyKGNvbCA9PiAhY29sLmV4cHJlc3Npb24pLFxuICAgICAgY2FsY3VsYXRlZENvbHVtbnM6IHByb3BzLmRhdGFzb3VyY2UuY29sdW1ucy5maWx0ZXIoXG4gICAgICAgIGNvbCA9PiAhIWNvbC5leHByZXNzaW9uLFxuICAgICAgKSxcbiAgICAgIG1ldGFkYXRhTG9hZGluZzogZmFsc2UsXG4gICAgICBhY3RpdmVUYWJLZXk6IDAsXG4gICAgICBkYXRhc291cmNlVHlwZTogcHJvcHMuZGF0YXNvdXJjZS5zcWxcbiAgICAgICAgPyBEQVRBU09VUkNFX1RZUEVTLnZpcnR1YWwua2V5XG4gICAgICAgIDogREFUQVNPVVJDRV9UWVBFUy5waHlzaWNhbC5rZXksXG4gICAgfTtcblxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkNoYW5nZUVkaXRNb2RlID0gdGhpcy5vbkNoYW5nZUVkaXRNb2RlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlID0gdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UgPSB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEgPVxuICAgICAgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3luY01ldGFkYXRhID0gdGhpcy5zeW5jTWV0YWRhdGEuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldENvbHVtbnMgPSB0aGlzLnNldENvbHVtbnMuYmluZCh0aGlzKTtcbiAgICB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlID0gdGhpcy52YWxpZGF0ZUFuZENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlVGFiU2VsZWN0ID0gdGhpcy5oYW5kbGVUYWJTZWxlY3QuYmluZCh0aGlzKTtcbiAgICB0aGlzLmN1cnJlbmNpZXMgPSBlbnN1cmVJc0FycmF5KHByb3BzLmN1cnJlbmNpZXMpLm1hcChjdXJyZW5jeUNvZGUgPT4gKHtcbiAgICAgIHZhbHVlOiBjdXJyZW5jeUNvZGUsXG4gICAgICBsYWJlbDogYCR7Z2V0Q3VycmVuY3lTeW1ib2woe1xuICAgICAgICBzeW1ib2w6IGN1cnJlbmN5Q29kZSxcbiAgICAgIH0pfSAoJHtjdXJyZW5jeUNvZGV9KWAsXG4gICAgfSkpO1xuICB9XG5cbiAgb25DaGFuZ2UoKSB7XG4gICAgLy8gRW1wdHlpbmcgU1FMIGlmIFwiUGh5c2ljYWxcIiByYWRpbyBidXR0b24gaXMgc2VsZWN0ZWRcbiAgICAvLyBDdXJyZW50bHkgdGhlIGxvZ2ljIHRvIGtub3cgd2hldGhlciB0aGUgc291cmNlIGlzXG4gICAgLy8gcGh5c2ljYWwgb3IgdmlydHVhbCBpcyBiYXNlZCBvbiB3aGV0aGVyIFNRTCBpcyBlbXB0eSBvciBub3QuXG4gICAgY29uc3QgeyBkYXRhc291cmNlVHlwZSwgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBzcWwgPVxuICAgICAgZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5ID8gJycgOiBkYXRhc291cmNlLnNxbDtcbiAgICBjb25zdCBuZXdEYXRhc291cmNlID0ge1xuICAgICAgLi4udGhpcy5zdGF0ZS5kYXRhc291cmNlLFxuICAgICAgc3FsLFxuICAgICAgY29sdW1uczogWy4uLnRoaXMuc3RhdGUuZGF0YWJhc2VDb2x1bW5zLCAuLi50aGlzLnN0YXRlLmNhbGN1bGF0ZWRDb2x1bW5zXSxcbiAgICB9O1xuICAgIHRoaXMucHJvcHMub25DaGFuZ2UobmV3RGF0YXNvdXJjZSwgdGhpcy5zdGF0ZS5lcnJvcnMpO1xuICB9XG5cbiAgb25DaGFuZ2VFZGl0TW9kZSgpIHtcbiAgICB0aGlzLnByb3BzLnNldElzRWRpdGluZyghdGhpcy5zdGF0ZS5pc0VkaXRNb2RlKTtcbiAgICB0aGlzLnNldFN0YXRlKHByZXZTdGF0ZSA9PiAoeyBpc0VkaXRNb2RlOiAhcHJldlN0YXRlLmlzRWRpdE1vZGUgfSkpO1xuICB9XG5cbiAgb25EYXRhc291cmNlQ2hhbmdlKGRhdGFzb3VyY2UsIGNhbGxiYWNrID0gdGhpcy52YWxpZGF0ZUFuZENoYW5nZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhc291cmNlIH0sIGNhbGxiYWNrKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoYXR0ciwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuOyAvLyBpZiB2YWx1ZSBpcyB1bmRlZmluZWQgZG8gbm90IHVwZGF0ZSBzdGF0ZVxuICAgIGNvbnN0IGRhdGFzb3VyY2UgPSB7IC4uLnRoaXMuc3RhdGUuZGF0YXNvdXJjZSwgW2F0dHJdOiB2YWx1ZSB9O1xuICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICBwcmV2U3RhdGUgPT4gKHtcbiAgICAgICAgZGF0YXNvdXJjZTogeyAuLi5wcmV2U3RhdGUuZGF0YXNvdXJjZSwgW2F0dHJdOiB2YWx1ZSB9LFxuICAgICAgfSksXG4gICAgICBhdHRyID09PSAndGFibGVfbmFtZSdcbiAgICAgICAgPyB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhKVxuICAgICAgICA6IHRoaXMub25EYXRhc291cmNlQ2hhbmdlKGRhdGFzb3VyY2UsIHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpLFxuICAgICk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VUeXBlQ2hhbmdlKGRhdGFzb3VyY2VUeXBlKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRhdGFzb3VyY2VUeXBlIH0pO1xuICB9XG5cbiAgc2V0Q29sdW1ucyhvYmopIHtcbiAgICAvLyB1cGRhdGUgY2FsY3VsYXRlZENvbHVtbnMgb3IgZGF0YWJhc2VDb2x1bW5zXG4gICAgdGhpcy5zZXRTdGF0ZShvYmosIHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpO1xuICB9XG5cbiAgdmFsaWRhdGVBbmRDaGFuZ2UoKSB7XG4gICAgdGhpcy52YWxpZGF0ZSh0aGlzLm9uQ2hhbmdlKTtcbiAgfVxuXG4gIHRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhKCkge1xuICAgIHRoaXMudmFsaWRhdGUoKCkgPT4ge1xuICAgICAgdGhpcy5zeW5jTWV0YWRhdGEoKTtcbiAgICAgIHRoaXMub25DaGFuZ2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHN5bmNNZXRhZGF0YSgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG1ldGFkYXRhTG9hZGluZzogdHJ1ZSB9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3Q29scyA9IGF3YWl0IGZldGNoU3luY2VkQ29sdW1ucyhkYXRhc291cmNlKTtcbiAgICAgIGNvbnN0IGNvbHVtbkNoYW5nZXMgPSB1cGRhdGVDb2x1bW5zKFxuICAgICAgICBkYXRhc291cmNlLmNvbHVtbnMsXG4gICAgICAgIG5ld0NvbHMsXG4gICAgICAgIHRoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0LFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2V0Q29sdW1ucyh7XG4gICAgICAgIGRhdGFiYXNlQ29sdW1uczogY29sdW1uQ2hhbmdlcy5maW5hbENvbHVtbnMuZmlsdGVyKFxuICAgICAgICAgIGNvbCA9PiAhY29sLmV4cHJlc3Npb24sIC8vIHJlbW92ZSBjYWxjdWxhdGVkIGNvbHVtbnNcbiAgICAgICAgKSxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5wcm9wcy5hZGRTdWNjZXNzVG9hc3QodCgnTWV0YWRhdGEgaGFzIGJlZW4gc3luY2VkJykpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1ldGFkYXRhTG9hZGluZzogZmFsc2UgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGNsaWVudEVycm9yLCBzdGF0dXNUZXh0IH0gPVxuICAgICAgICBhd2FpdCBnZXRDbGllbnRFcnJvck9iamVjdChlcnJvcik7XG4gICAgICB0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0KFxuICAgICAgICBjbGllbnRFcnJvciB8fCBzdGF0dXNUZXh0IHx8IHQoJ0FuIGVycm9yIGhhcyBvY2N1cnJlZCcpLFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZpbmREdXBsaWNhdGVzKGFyciwgYWNjZXNzb3IpIHtcbiAgICBjb25zdCBzZWVuID0ge307XG4gICAgY29uc3QgZHVwcyA9IFtdO1xuICAgIGFyci5mb3JFYWNoKG9iaiA9PiB7XG4gICAgICBjb25zdCBpdGVtID0gYWNjZXNzb3Iob2JqKTtcbiAgICAgIGlmIChpdGVtIGluIHNlZW4pIHtcbiAgICAgICAgZHVwcy5wdXNoKGl0ZW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VlbltpdGVtXSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGR1cHM7XG4gIH1cblxuICB2YWxpZGF0ZShjYWxsYmFjaykge1xuICAgIGxldCBlcnJvcnMgPSBbXTtcbiAgICBsZXQgZHVwcztcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAvLyBMb29raW5nIGZvciBkdXBsaWNhdGUgY29sdW1uX25hbWVcbiAgICBkdXBzID0gdGhpcy5maW5kRHVwbGljYXRlcyhkYXRhc291cmNlLmNvbHVtbnMsIG9iaiA9PiBvYmouY29sdW1uX25hbWUpO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBkdXBzLm1hcChuYW1lID0+IHQoJ0NvbHVtbiBuYW1lIFslc10gaXMgZHVwbGljYXRlZCcsIG5hbWUpKSxcbiAgICApO1xuXG4gICAgLy8gTG9va2luZyBmb3IgZHVwbGljYXRlIG1ldHJpY19uYW1lXG4gICAgZHVwcyA9IHRoaXMuZmluZER1cGxpY2F0ZXMoZGF0YXNvdXJjZS5tZXRyaWNzLCBvYmogPT4gb2JqLm1ldHJpY19uYW1lKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgZHVwcy5tYXAobmFtZSA9PiB0KCdNZXRyaWMgbmFtZSBbJXNdIGlzIGR1cGxpY2F0ZWQnLCBuYW1lKSksXG4gICAgKTtcblxuICAgIC8vIE1ha2luZyBzdXJlIGNhbGN1bGF0ZWRDb2x1bW5zIGhhdmUgYW4gZXhwcmVzc2lvbiBkZWZpbmVkXG4gICAgY29uc3Qgbm9GaWx0ZXJDYWxjQ29scyA9IHRoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnMuZmlsdGVyKFxuICAgICAgY29sID0+ICFjb2wuZXhwcmVzc2lvbiAmJiAhY29sLmpzb24sXG4gICAgKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgbm9GaWx0ZXJDYWxjQ29scy5tYXAoY29sID0+XG4gICAgICAgIHQoJ0NhbGN1bGF0ZWQgY29sdW1uIFslc10gcmVxdWlyZXMgYW4gZXhwcmVzc2lvbicsIGNvbC5jb2x1bW5fbmFtZSksXG4gICAgICApLFxuICAgICk7XG5cbiAgICAvLyB2YWxpZGF0ZSBjdXJyZW5jeSBjb2RlXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3RhdGUuZGF0YXNvdXJjZS5tZXRyaWNzPy5mb3JFYWNoKFxuICAgICAgICBtZXRyaWMgPT5cbiAgICAgICAgICBtZXRyaWMuY3VycmVuY3k/LnN5bWJvbCAmJlxuICAgICAgICAgIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZW4tVVMnLCB7XG4gICAgICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JyxcbiAgICAgICAgICAgIGN1cnJlbmN5OiBtZXRyaWMuY3VycmVuY3kuc3ltYm9sLFxuICAgICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoW3QoJ0ludmFsaWQgY3VycmVuY3kgY29kZSBpbiBzYXZlZCBtZXRyaWNzJyldKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHsgZXJyb3JzIH0sIGNhbGxiYWNrKTtcbiAgfVxuXG4gIGhhbmRsZVRhYlNlbGVjdChhY3RpdmVUYWJLZXkpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgYWN0aXZlVGFiS2V5IH0pO1xuICB9XG5cbiAgc29ydE1ldHJpY3MobWV0cmljcykge1xuICAgIHJldHVybiBtZXRyaWNzLnNvcnQoKHsgaWQ6IGEgfSwgeyBpZDogYiB9KSA9PiBiIC0gYSk7XG4gIH1cblxuICByZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdCYXNpYycpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cImRlZmF1bHRfZW5kcG9pbnRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZWZhdWx0IFVSTCcpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgYERlZmF1bHQgVVJMIHRvIHJlZGlyZWN0IHRvIHdoZW4gYWNjZXNzaW5nIGZyb20gdGhlIGRhdGFzZXQgbGlzdCBwYWdlLlxuICAgICAgICAgICAgQWNjZXB0cyByZWxhdGl2ZSBVUkxzIHN1Y2ggYXMgPHNwYW4gc3R5bGU94oCed2hpdGUtc3BhY2U6IG5vd3JhcDvigJ0+L3N1cGVyc2V0L2Rhc2hib2FyZC97aWR9Lzwvc3Bhbj5gLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImRlZmF1bHRfZW5kcG9pbnRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJmaWx0ZXJfc2VsZWN0X2VuYWJsZWRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgZmlsdGVycycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdXaGV0aGVyIHRvIHBvcHVsYXRlIGF1dG9jb21wbGV0ZSBmaWx0ZXJzIG9wdGlvbnMnKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIC8+fVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgcXVlcnkgcHJlZGljYXRlJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ1doZW4gdXNpbmcgXCJBdXRvY29tcGxldGUgZmlsdGVyc1wiLCB0aGlzIGNhbiBiZSB1c2VkIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UgJyArXG4gICAgICAgICAgICAgICAgJ29mIHRoZSBxdWVyeSBmZXRjaGluZyB0aGUgdmFsdWVzLiBVc2UgdGhpcyBvcHRpb24gdG8gYXBwbHkgYSAnICtcbiAgICAgICAgICAgICAgICAncHJlZGljYXRlIChXSEVSRSBjbGF1c2UpIHRvIHRoZSBxdWVyeSBzZWxlY3RpbmcgdGhlIGRpc3RpbmN0ICcgK1xuICAgICAgICAgICAgICAgICd2YWx1ZXMgZnJvbSB0aGUgdGFibGUuIFR5cGljYWxseSB0aGUgaW50ZW50IHdvdWxkIGJlIHRvIGxpbWl0IHRoZSBzY2FuICcgK1xuICAgICAgICAgICAgICAgICdieSBhcHBseWluZyBhIHJlbGF0aXZlIHRpbWUgZmlsdGVyIG9uIGEgcGFydGl0aW9uZWQgb3IgaW5kZXhlZCB0aW1lLXJlbGF0ZWQgZmllbGQuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgICAgICBtaW5MaW5lcz17NX1cbiAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZXh0cmFcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ0V4dHJhJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ0V4dHJhIGRhdGEgdG8gc3BlY2lmeSB0YWJsZSBtZXRhZGF0YS4gQ3VycmVudGx5IHN1cHBvcnRzICcgK1xuICAgICAgICAgICAgICAgICdtZXRhZGF0YSBvZiB0aGUgZm9ybWF0OiBgeyBcImNlcnRpZmljYXRpb25cIjogeyBcImNlcnRpZmllZF9ieVwiOiAnICtcbiAgICAgICAgICAgICAgICAnXCJEYXRhIFBsYXRmb3JtIFRlYW1cIiwgXCJkZXRhaWxzXCI6IFwiVGhpcyB0YWJsZSBpcyB0aGUgc291cmNlIG9mIHRydXRoLlwiICcgK1xuICAgICAgICAgICAgICAgICd9LCBcIndhcm5pbmdfbWFya2Rvd25cIjogXCJUaGlzIGlzIGEgd2FybmluZy5cIiB9YC4nLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZXh0cmFcIlxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxPd25lcnNTZWxlY3RvclxuICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgb25DaGFuZ2U9e25ld093bmVycyA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZSh7IC4uLmRhdGFzb3VyY2UsIG93bmVyczogbmV3T3duZXJzIH0pO1xuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdBZHZhbmNlZCcpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiY2FjaGVfdGltZW91dFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0NhY2hlIHRpbWVvdXQnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgZHVyYXRpb24gb2YgdGltZSBpbiBzZWNvbmRzIGJlZm9yZSB0aGUgY2FjaGUgaXMgaW52YWxpZGF0ZWQuIFNldCB0byAtMSB0byBieXBhc3MgdGhlIGNhY2hlLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwiY2FjaGVfdGltZW91dFwiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cIm9mZnNldFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0hvdXJzIG9mZnNldCcpfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJvZmZzZXRcIiAvPn1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgbnVtYmVyIG9mIGhvdXJzLCBuZWdhdGl2ZSBvciBwb3NpdGl2ZSwgdG8gc2hpZnQgdGhlIHRpbWUgY29sdW1uLiBUaGlzIGNhbiBiZSB1c2VkIHRvIG1vdmUgVVRDIHRpbWUgdG8gbG9jYWwgdGltZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cInRlbXBsYXRlX3BhcmFtc1wiXG4gICAgICAgICAgICBsYWJlbD17dCgnVGVtcGxhdGUgcGFyYW1ldGVycycpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdBIHNldCBvZiBwYXJhbWV0ZXJzIHRoYXQgYmVjb21lIGF2YWlsYWJsZSBpbiB0aGUgcXVlcnkgdXNpbmcgSmluamEgdGVtcGxhdGluZyBzeW50YXgnLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJ0ZW1wbGF0ZV9wYXJhbXNcIiAvPn1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cIm5vcm1hbGl6ZV9jb2x1bW5zXCJcbiAgICAgICAgICBsYWJlbD17dCgnTm9ybWFsaXplIGNvbHVtbiBuYW1lcycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0FsbG93IGNvbHVtbiBuYW1lcyB0byBiZSBjaGFuZ2VkIHRvIGNhc2UgaW5zZW5zaXRpdmUgZm9ybWF0LCBpZiBzdXBwb3J0ZWQgKGUuZy4gT3JhY2xlLCBTbm93Zmxha2UpLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cIm5vcm1hbGl6ZV9jb2x1bW5zXCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiYWx3YXlzX2ZpbHRlcl9tYWluX2R0dG1cIlxuICAgICAgICAgIGxhYmVsPXt0KCdBbHdheXMgZmlsdGVyIG1haW4gZGF0ZXRpbWUgY29sdW1uJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICBgV2hlbiB0aGUgc2Vjb25kYXJ5IHRlbXBvcmFsIGNvbHVtbnMgYXJlIGZpbHRlcmVkLCBhcHBseSB0aGUgc2FtZSBmaWx0ZXIgdG8gdGhlIG1haW4gZGF0ZXRpbWUgY29sdW1uLmAsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCIgLz59XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJTcGF0aWFsVGFiKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IHNwYXRpYWxzLCBhbGxfY29sczogYWxsQ29scyB9ID0gZGF0YXNvdXJjZTtcbiAgICByZXR1cm4gKFxuICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICB0YWI9ezxDb2xsZWN0aW9uVGFiVGl0bGUgY29sbGVjdGlvbj17c3BhdGlhbHN9IHRpdGxlPXt0KCdTcGF0aWFsJyl9IC8+fVxuICAgICAgICBrZXk9ezR9XG4gICAgICA+XG4gICAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgICB0YWJsZUNvbHVtbnM9e1snbmFtZScsICdjb25maWcnXX1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcywgJ3NwYXRpYWxzJyl9XG4gICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHQoJzxuZXcgc3BhdGlhbD4nKSxcbiAgICAgICAgICAgIHR5cGU6IHQoJzxubyB0eXBlPicpLFxuICAgICAgICAgICAgY29uZmlnOiBudWxsLFxuICAgICAgICAgIH0pfVxuICAgICAgICAgIGNvbGxlY3Rpb249e3NwYXRpYWxzfVxuICAgICAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgICAgIGl0ZW1SZW5kZXJlcnM9e3tcbiAgICAgICAgICAgIG5hbWU6IChkLCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZSBjYW5FZGl0IHRpdGxlPXtkfSBvblNhdmVUaXRsZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgY29uZmlnOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPFNwYXRpYWxDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IGNob2ljZXM9e2FsbENvbHN9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU291cmNlRmllbGRzZXQoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICA8RWRpdExvY2tDb250YWluZXI+XG4gICAgICAgICAgPHNwYW4gcm9sZT1cImJ1dHRvblwiIHRhYkluZGV4PXswfSBvbkNsaWNrPXt0aGlzLm9uQ2hhbmdlRWRpdE1vZGV9PlxuICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNFZGl0TW9kZSA/IChcbiAgICAgICAgICAgICAgPEljb25zLlVubG9ja091dGxpbmVkXG4gICAgICAgICAgICAgICAgaWNvblNpemU9XCJ4bFwiXG4gICAgICAgICAgICAgICAgY3NzPXt0aGVtZSA9PiBjc3NgXG4gICAgICAgICAgICAgICAgICBtYXJnaW46IGF1dG8gJHt0aGVtZS5ncmlkVW5pdH1weCBhdXRvIDA7XG4gICAgICAgICAgICAgICAgYH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDxJY29ucy5Mb2NrT3V0bGluZWRcbiAgICAgICAgICAgICAgICBpY29uU2l6ZT1cInhsXCJcbiAgICAgICAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7XG4gICAgICAgICAgICAgICAgICBtYXJnaW46IGBhdXRvICR7dGhlbWUuZ3JpZFVuaXR9cHggYXV0byAwYCxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgIHshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmIChcbiAgICAgICAgICAgIDxkaXY+e3QoJ0NsaWNrIHRoZSBsb2NrIHRvIG1ha2UgY2hhbmdlcy4nKX08L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgPGRpdj57dCgnQ2xpY2sgdGhlIGxvY2sgdG8gcHJldmVudCBmdXJ0aGVyIGNoYW5nZXMuJyl9PC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9FZGl0TG9ja0NvbnRhaW5lcj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtLWwtMTAgbS10LTIwIG0tYi0xMFwiPlxuICAgICAgICAgIHtEQVRBU09VUkNFX1RZUEVTX0FSUi5tYXAodHlwZSA9PiAoXG4gICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAga2V5PXt0eXBlLmtleX1cbiAgICAgICAgICAgICAgdmFsdWU9e3R5cGUua2V5fVxuICAgICAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlVHlwZUNoYW5nZS5iaW5kKHRoaXMsIHR5cGUua2V5KX1cbiAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5zdGF0ZS5kYXRhc291cmNlVHlwZSA9PT0gdHlwZS5rZXl9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7dHlwZS5sYWJlbH1cbiAgICAgICAgICAgIDwvUmFkaW8+XG4gICAgICAgICAgKSl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8aHIgLz5cbiAgICAgICAgPEZpZWxkc2V0IGl0ZW09e2RhdGFzb3VyY2V9IG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX0gY29tcGFjdD5cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5kYXRhc291cmNlVHlwZSA9PT0gREFUQVNPVVJDRV9UWVBFUy52aXJ0dWFsLmtleSAmJiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkYXRhYmFzZVNlbGVjdG9yXCJcbiAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnVmlydHVhbCcpfVxuICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjc3M9e3sgbWFyZ2luVG9wOiA4IH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RGF0YWJhc2VTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiPXtkYXRhc291cmNlPy5kYXRhYmFzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRhbG9nPXtkYXRhc291cmNlLmNhdGFsb2d9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hPXtkYXRhc291cmNlLnNjaGVtYX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNhdGFsb2dDaGFuZ2U9e2NhdGFsb2cgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdjYXRhbG9nJywgY2F0YWxvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TY2hlbWFDaGFuZ2U9e3NjaGVtYSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3NjaGVtYScsIHNjaGVtYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25EYkNoYW5nZT17ZGF0YWJhc2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdkYXRhYmFzZScsIGRhdGFiYXNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtTW9kZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXJyb3I9e3RoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IHdpZHRoOiAnY2FsYygxMDAlIC0gMzRweCknLCBtYXJnaW5Ub3A6IC0xNiB9fT5cbiAgICAgICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidGFibGVfbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnTmFtZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cInRhYmxlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0YWJsZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3RhYmxlX25hbWUnLCB0YWJsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGF0YXNldCBuYW1lJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInNxbFwiXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdTUUwnKX1cbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAgICAgJ1doZW4gc3BlY2lmeWluZyBTUUwsIHRoZSBkYXRhc291cmNlIGFjdHMgYXMgYSB2aWV3LiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdTdXBlcnNldCB3aWxsIHVzZSB0aGlzIHN0YXRlbWVudCBhcyBhIHN1YnF1ZXJ5IHdoaWxlIGdyb3VwaW5nIGFuZCBmaWx0ZXJpbmcgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnb24gdGhlIGdlbmVyYXRlZCBwYXJlbnQgcXVlcmllcy4nLFxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cInNxbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkxpbmVzPXsyMH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1heExpbmVzPXtJbmZpbml0eX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplPVwiYm90aFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwT3B0aW9ucz17c3FsVG9vbHRpcE9wdGlvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgICAge3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5ICYmIChcbiAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ0YWJsZVNlbGVjdG9yXCJcbiAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdQaHlzaWNhbCcpfVxuICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IG1hcmdpblRvcDogOCB9fT5cbiAgICAgICAgICAgICAgICAgICAgICA8VGFibGVTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJhYmxlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UuZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlX25hbWU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXNvdXJjZS5kYXRhYmFzZT8uZGF0YWJhc2VfbmFtZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuZGF0YWJhc2U/Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGJJZD17ZGF0YXNvdXJjZS5kYXRhYmFzZT8uaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcj17dGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGFsb2c9e2RhdGFzb3VyY2UuY2F0YWxvZ31cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYT17ZGF0YXNvdXJjZS5zY2hlbWF9XG4gICAgICAgICAgICAgICAgICAgICAgICBzcWxMYWJNb2RlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlVmFsdWU9e2RhdGFzb3VyY2UudGFibGVfbmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2F0YWxvZ0NoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY2F0YWxvZyA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ2NhdGFsb2cnLCBjYXRhbG9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblNjaGVtYUNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gc2NoZW1hID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnc2NoZW1hJywgc2NoZW1hKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkRiQ2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBkYXRhYmFzZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGFiYXNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblRhYmxlU2VsZWN0Q2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0YWJsZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3RhYmxlX25hbWUnLCB0YWJsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgICAgICAgJ1RoZSBwb2ludGVyIHRvIGEgcGh5c2ljYWwgdGFibGUgKG9yIHZpZXcpLiBLZWVwIGluIG1pbmQgdGhhdCB0aGUgY2hhcnQgaXMgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ2Fzc29jaWF0ZWQgdG8gdGhpcyBTdXBlcnNldCBsb2dpY2FsIHRhYmxlLCBhbmQgdGhpcyBsb2dpY2FsIHRhYmxlIHBvaW50cyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAndGhlIHBoeXNpY2FsIHRhYmxlIHJlZmVyZW5jZWQgaGVyZS4nLFxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJFcnJvcnMoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUuZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxBbGVydFxuICAgICAgICAgIGNzcz17dGhlbWUgPT4gKHsgbWFyZ2luQm90dG9tOiB0aGVtZS5ncmlkVW5pdCAqIDQgfSl9XG4gICAgICAgICAgdHlwZT1cImVycm9yXCJcbiAgICAgICAgICBtZXNzYWdlPXtcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmVycm9ycy5tYXAoZXJyID0+IChcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17ZXJyfT57ZXJyfTwvZGl2PlxuICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgIDwvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmVuZGVyTWV0cmljQ29sbGVjdGlvbigpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBtZXRyaWNzIH0gPSBkYXRhc291cmNlO1xuICAgIGNvbnN0IHNvcnRlZE1ldHJpY3MgPSBtZXRyaWNzPy5sZW5ndGggPyB0aGlzLnNvcnRNZXRyaWNzKG1ldHJpY3MpIDogW107XG4gICAgcmV0dXJuIChcbiAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgdGFibGVDb2x1bW5zPXtbJ21ldHJpY19uYW1lJywgJ3ZlcmJvc2VfbmFtZScsICdleHByZXNzaW9uJ119XG4gICAgICAgIHNvcnRDb2x1bW5zPXtbJ21ldHJpY19uYW1lJywgJ3ZlcmJvc2VfbmFtZScsICdleHByZXNzaW9uJ119XG4gICAgICAgIGNvbHVtbkxhYmVscz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KCdNZXRyaWMgS2V5JyksXG4gICAgICAgICAgdmVyYm9zZV9uYW1lOiB0KCdMYWJlbCcpLFxuICAgICAgICAgIGV4cHJlc3Npb246IHQoJ1NRTCBleHByZXNzaW9uJyksXG4gICAgICAgIH19XG4gICAgICAgIGNvbHVtbkxhYmVsVG9vbHRpcHM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdChcbiAgICAgICAgICAgICdUaGlzIGZpZWxkIGlzIHVzZWQgYXMgYSB1bmlxdWUgaWRlbnRpZmllciB0byBhdHRhY2ggJyArXG4gICAgICAgICAgICAgICd0aGUgbWV0cmljIHRvIGNoYXJ0cy4gSXQgaXMgYWxzbyB1c2VkIGFzIHRoZSBhbGlhcyBpbiB0aGUgJyArXG4gICAgICAgICAgICAgICdTUUwgcXVlcnkuJyxcbiAgICAgICAgICApLFxuICAgICAgICB9fVxuICAgICAgICBleHBhbmRGaWVsZHNldD17XG4gICAgICAgICAgPEZvcm1Db250YWluZXI+XG4gICAgICAgICAgICA8RmllbGRzZXQgY29tcGFjdD5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImQzZm9ybWF0XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnRDMgZm9ybWF0Jyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2wgY29udHJvbElkPVwiZDNmb3JtYXRcIiBwbGFjZWhvbGRlcj1cIiV5LyVtLyVkXCIgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY3VycmVuY3lcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdNZXRyaWMgY3VycmVuY3knKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxDdXJyZW5jeUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3lTZWxlY3RPdmVycmlkZVByb3BzPXt7XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IHQoJ1NlbGVjdCBvciB0eXBlIGN1cnJlbmN5IHN5bWJvbCcpLFxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBzeW1ib2xTZWxlY3RBZGRpdGlvbmFsU3R5bGVzPXtjc3NgXG4gICAgICAgICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAzMCU7XG4gICAgICAgICAgICAgICAgICAgIGB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmllZCBieScpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWVkX2J5XCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgICAgICdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgbWV0cmljJyxcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpY2F0aW9uX2RldGFpbHNcIlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdEZXRhaWxzIG9mIHRoZSBjZXJ0aWZpY2F0aW9uJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdXYXJuaW5nJyl9XG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ3YXJuaW5nX21hcmtkb3duXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnT3B0aW9uYWwgd2FybmluZyBhYm91dCB1c2Ugb2YgdGhpcyBtZXRyaWMnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwid2FybmluZ19tYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwibWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L0ZpZWxkc2V0PlxuICAgICAgICAgIDwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgfVxuICAgICAgICBjb2xsZWN0aW9uPXtzb3J0ZWRNZXRyaWNzfVxuICAgICAgICBhbGxvd0FkZEl0ZW1cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMsICdtZXRyaWNzJyl9XG4gICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoJzxuZXcgbWV0cmljPicpLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogJycsXG4gICAgICAgICAgZXhwcmVzc2lvbjogJycsXG4gICAgICAgIH0pfVxuICAgICAgICBpdGVtQ2VsbFByb3BzPXt7XG4gICAgICAgICAgZXhwcmVzc2lvbjogKCkgPT4gKHtcbiAgICAgICAgICAgIHdpZHRoOiAnMjQwcHgnLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9fVxuICAgICAgICBpdGVtUmVuZGVyZXJzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6ICh2LCBvbkNoYW5nZSwgXywgcmVjb3JkKSA9PiAoXG4gICAgICAgICAgICA8RmxleFJvd0NvbnRhaW5lcj5cbiAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtyZWNvcmQud2FybmluZ19tYXJrZG93biAmJiAoXG4gICAgICAgICAgICAgICAgPFdhcm5pbmdJY29uV2l0aFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgIHdhcm5pbmdNYXJrZG93bj17cmVjb3JkLndhcm5pbmdfbWFya2Rvd259XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPEVkaXRhYmxlVGl0bGUgY2FuRWRpdCB0aXRsZT17dn0gb25TYXZlVGl0bGU9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICAgPC9GbGV4Um93Q29udGFpbmVyPlxuICAgICAgICAgICksXG4gICAgICAgICAgdmVyYm9zZV9uYW1lOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgIDxUZXh0Q29udHJvbCBjYW5FZGl0IHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgICBleHByZXNzaW9uOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgY2FuRWRpdFxuICAgICAgICAgICAgICBpbml0aWFsVmFsdWU9e3Z9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzPXtbJ2RhdGFzb3VyY2Utc3FsLWV4cHJlc3Npb24nXX1cbiAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJzcWxcIlxuICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgbWluTGluZXM9ezV9XG4gICAgICAgICAgICAgIHRleHRBcmVhU3R5bGVzPXt7IG1pbldpZHRoOiAnMjAwcHgnLCBtYXhXaWR0aDogJzQ1MHB4JyB9fVxuICAgICAgICAgICAgICByZXNpemU9XCJib3RoXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogKHYsIG9uQ2hhbmdlLCBsYWJlbCkgPT4gKFxuICAgICAgICAgICAgPFN0YWNrZWRGaWVsZFxuICAgICAgICAgICAgICBsYWJlbD17bGFiZWx9XG4gICAgICAgICAgICAgIGZvcm1FbGVtZW50PXs8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkNoYW5nZX0gLz59XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZDNmb3JtYXQ6ICh2LCBvbkNoYW5nZSwgbGFiZWwpID0+IChcbiAgICAgICAgICAgIDxTdGFja2VkRmllbGRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICBmb3JtRWxlbWVudD17PFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICB9fVxuICAgICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgICAgc3RpY2t5SGVhZGVyXG4gICAgICAvPlxuICAgICk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlLCBhY3RpdmVUYWJLZXkgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBtZXRyaWNzIH0gPSBkYXRhc291cmNlO1xuICAgIGNvbnN0IHNvcnRlZE1ldHJpY3MgPSBtZXRyaWNzPy5sZW5ndGggPyB0aGlzLnNvcnRNZXRyaWNzKG1ldHJpY3MpIDogW107XG4gICAgY29uc3QgeyB0aGVtZSB9ID0gdGhpcy5wcm9wcztcblxuICAgIHJldHVybiAoXG4gICAgICA8RGF0YXNvdXJjZUNvbnRhaW5lciBkYXRhLXRlc3Q9XCJkYXRhc291cmNlLWVkaXRvclwiPlxuICAgICAgICB7dGhpcy5yZW5kZXJFcnJvcnMoKX1cbiAgICAgICAgPEFsZXJ0XG4gICAgICAgICAgY3NzPXt0aGVtZSA9PiAoeyBtYXJnaW5Cb3R0b206IHRoZW1lLmdyaWRVbml0ICogNCB9KX1cbiAgICAgICAgICB0eXBlPVwid2FybmluZ1wiXG4gICAgICAgICAgbWVzc2FnZT17XG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7JyAnfVxuICAgICAgICAgICAgICA8c3Ryb25nPnt0KCdCZSBjYXJlZnVsLicpfSA8L3N0cm9uZz5cbiAgICAgICAgICAgICAge3QoXG4gICAgICAgICAgICAgICAgJ0NoYW5naW5nIHRoZXNlIHNldHRpbmdzIHdpbGwgYWZmZWN0IGFsbCBjaGFydHMgdXNpbmcgdGhpcyBkYXRhc2V0LCBpbmNsdWRpbmcgY2hhcnRzIG93bmVkIGJ5IG90aGVyIHBlb3BsZS4nLFxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgICA8U3R5bGVkVGFibGVUYWJzXG4gICAgICAgICAgZnVsbFdpZHRoPXtmYWxzZX1cbiAgICAgICAgICBpZD1cInRhYmxlLXRhYnNcIlxuICAgICAgICAgIGRhdGEtdGVzdD1cImVkaXQtZGF0YXNldC10YWJzXCJcbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVUYWJTZWxlY3R9XG4gICAgICAgICAgZGVmYXVsdEFjdGl2ZUtleT17YWN0aXZlVGFiS2V5fVxuICAgICAgICA+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSBrZXk9ezB9IHRhYj17dCgnU291cmNlJyl9PlxuICAgICAgICAgICAge3RoaXMucmVuZGVyU291cmNlRmllbGRzZXQodGhlbWUpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgIHRhYj17XG4gICAgICAgICAgICAgIDxDb2xsZWN0aW9uVGFiVGl0bGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uPXtzb3J0ZWRNZXRyaWNzfVxuICAgICAgICAgICAgICAgIHRpdGxlPXt0KCdNZXRyaWNzJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXk9ezF9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge3RoaXMucmVuZGVyTWV0cmljQ29sbGVjdGlvbigpfVxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgICAgIHRhYj17XG4gICAgICAgICAgICAgIDxDb2xsZWN0aW9uVGFiVGl0bGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uPXt0aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1uc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnQ29sdW1ucycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXsyfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgICAgPFN0eWxlZEJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvblNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwidGVydGlhcnlcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnN5bmNNZXRhZGF0YX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic3luYy1mcm9tLXNvdXJjZVwiXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxJY29ucy5EYXRhYmFzZU91dGxpbmVkIGljb25TaXplPVwibVwiIC8+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdTeW5jIGNvbHVtbnMgZnJvbSBzb3VyY2UnKX1cbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgPC9Db2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQ29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29sdW1ucy10YWJsZVwiXG4gICAgICAgICAgICAgICAgY29sdW1ucz17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgZGF0YXNvdXJjZT17ZGF0YXNvdXJjZX1cbiAgICAgICAgICAgICAgICBvbkNvbHVtbnNDaGFuZ2U9e2RhdGFiYXNlQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgZGF0YWJhc2VDb2x1bW5zIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLm1ldGFkYXRhTG9hZGluZyAmJiA8TG9hZGluZyAvPn1cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgPENvbGxlY3Rpb25UYWJUaXRsZVxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb249e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NhbGN1bGF0ZWQgY29sdW1ucycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXszfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkNvbGxlY3Rpb25UYWJsZVxuICAgICAgICAgICAgICAgIGNvbHVtbnM9e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgb25Db2x1bW5zQ2hhbmdlPXtjYWxjdWxhdGVkQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgY2FsY3VsYXRlZENvbHVtbnMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29sdW1uTGFiZWxUb29sdGlwcz17e1xuICAgICAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoXG4gICAgICAgICAgICAgICAgICAgICdUaGlzIGZpZWxkIGlzIHVzZWQgYXMgYSB1bmlxdWUgaWRlbnRpZmllciB0byBhdHRhY2ggJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBjYWxjdWxhdGVkIGRpbWVuc2lvbiB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAnYXMgdGhlIGFsaWFzIGluIHRoZSBTUUwgcXVlcnkuJyxcbiAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lXG4gICAgICAgICAgICAgICAgc2hvd0V4cHJlc3Npb25cbiAgICAgICAgICAgICAgICBhbGxvd0FkZEl0ZW1cbiAgICAgICAgICAgICAgICBhbGxvd0VkaXREYXRhVHlwZVxuICAgICAgICAgICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnPG5ldyBjb2x1bW4+JyksXG4gICAgICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZ3JvdXBieTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IHQoJzxlbnRlciBTUUwgZXhwcmVzc2lvbiBoZXJlPicpLFxuICAgICAgICAgICAgICAgICAgX19leHBhbmRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSBrZXk9ezR9IHRhYj17dCgnU2V0dGluZ3MnKX0+XG4gICAgICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj57dGhpcy5yZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCl9PC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgPEZvcm1Db250YWluZXI+e3RoaXMucmVuZGVyQWR2YW5jZWRGaWVsZHNldCgpfTwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgPC9TdHlsZWRUYWJsZVRhYnM+XG4gICAgICA8L0RhdGFzb3VyY2VDb250YWluZXI+XG4gICAgKTtcbiAgfVxufVxuXG5EYXRhc291cmNlRWRpdG9yLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcbkRhdGFzb3VyY2VFZGl0b3IucHJvcFR5cGVzID0gcHJvcFR5cGVzO1xuXG5jb25zdCBEYXRhU291cmNlQ29tcG9uZW50ID0gd2l0aFRoZW1lKERhdGFzb3VyY2VFZGl0b3IpO1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoVG9hc3RzKERhdGFTb3VyY2VDb21wb25lbnQpO1xuIl19 */\"), children:\n                  _jsx(Field, {\n                    fieldKey: \"table_name\",\n                    label: t('Name'),\n                    control:\n                    _jsx(TextControl, {\n                      controlId: \"table_name\",\n                      onChange: (table) => {\n                        this.onDatasourcePropChange('table_name', table);\n                      },\n                      placeholder: t('Dataset name'),\n                      disabled: !this.state.isEditMode }\n                    ) }\n\n                  ) }\n                )] }\n              ),\n              _jsx(Field, {\n                fieldKey: \"sql\",\n                label: t('SQL'),\n                description: t(\n                  'When specifying SQL, the datasource acts as a view. ' +\n                  'Superset will use this statement as a subquery while grouping and filtering ' +\n                  'on the generated parent queries.'\n                ),\n                control:\n                _jsx(TextAreaControl, {\n                  language: \"sql\",\n                  offerEditInModal: false,\n                  minLines: 20,\n                  maxLines: Infinity,\n                  readOnly: !this.state.isEditMode,\n                  resize: \"both\",\n                  tooltipOptions: sqlTooltipOptions }\n                ) }\n\n              )] }\n            ) }\n\n          ),\n\n          this.state.datasourceType === DATASOURCE_TYPES.physical.key &&\n          _jsx(Col, { xs: 24, md: 12, children:\n            this.state.isSqla &&\n            _jsx(Field, {\n              fieldKey: \"tableSelector\",\n              label: t('Physical'),\n              control:\n              _jsx(\"div\", { css: _ref3, children:\n                _jsx(TableSelector, {\n                  clearable: false,\n                  database: {\n                    ...datasource.database,\n                    database_name:\n                    ((_datasource$database = datasource.database) == null ? void 0 : _datasource$database.database_name) || ((_datasource$database2 =\n                    datasource.database) == null ? void 0 : _datasource$database2.name)\n                  },\n                  dbId: (_datasource$database3 = datasource.database) == null ? void 0 : _datasource$database3.id,\n                  handleError: this.props.addDangerToast,\n                  catalog: datasource.catalog,\n                  schema: datasource.schema,\n                  sqlLabMode: false,\n                  tableValue: datasource.table_name,\n                  onCatalogChange:\n                  this.state.isEditMode ?\n                  (catalog) =>\n                  this.onDatasourcePropChange('catalog', catalog) :\n                  undefined,\n\n                  onSchemaChange:\n                  this.state.isEditMode ?\n                  (schema) =>\n                  this.onDatasourcePropChange('schema', schema) :\n                  undefined,\n\n                  onDbChange:\n                  this.state.isEditMode ?\n                  (database) =>\n                  this.onDatasourcePropChange(\n                    'database',\n                    database\n                  ) :\n                  undefined,\n\n                  onTableSelectChange:\n                  this.state.isEditMode ?\n                  (table) =>\n                  this.onDatasourcePropChange('table_name', table) :\n                  undefined,\n\n                  readOnly: !this.state.isEditMode }\n                ) }\n              ),\n\n              description: t(\n                'The pointer to a physical table (or view). Keep in mind that the chart is ' +\n                'associated to this Superset logical table, and this logical table points ' +\n                'the physical table referenced here.'\n              ) }\n            ) }\n\n          )] }\n\n        )] }\n      ));\n\n  }\n\n  renderErrors() {\n    if (this.state.errors.length > 0) {\n      return (\n        _jsx(Alert, {\n          css: (theme) => ({ marginBottom: theme.gridUnit * 4 }),\n          type: \"error\",\n          message:\n          _jsx(_Fragment, { children:\n            this.state.errors.map((err) =>\n            _jsx(\"div\", { children: err }, err)\n            ) }\n          ) }\n\n        ));\n\n    }\n    return null;\n  }\n\n  renderMetricCollection() {\n    const { datasource } = this.state;\n    const { metrics } = datasource;\n    const sortedMetrics = metrics != null && metrics.length ? this.sortMetrics(metrics) : [];\n    return (\n      _jsx(CollectionTable, {\n        tableColumns: ['metric_name', 'verbose_name', 'expression'],\n        sortColumns: ['metric_name', 'verbose_name', 'expression'],\n        columnLabels: {\n          metric_name: t('Metric Key'),\n          verbose_name: t('Label'),\n          expression: t('SQL expression')\n        },\n        columnLabelTooltips: {\n          metric_name: t(\n            'This field is used as a unique identifier to attach ' +\n            'the metric to charts. It is also used as the alias in the ' +\n            'SQL query.'\n          )\n        },\n        expandFieldset:\n        _jsx(FormContainer, { children:\n          _jsxs(Fieldset, { compact: true, children: [\n            _jsx(Field, {\n              fieldKey: \"description\",\n              label: t('Description'),\n              control:\n              _jsx(TextControl, {\n                controlId: \"description\",\n                placeholder: t('Description') }\n              ) }\n\n            ),\n            _jsx(Field, {\n              fieldKey: \"d3format\",\n              label: t('D3 format'),\n              control:\n              _jsx(TextControl, { controlId: \"d3format\", placeholder: \"%y/%m/%d\" }) }\n\n            ),\n            _jsx(Field, {\n              fieldKey: \"currency\",\n              label: t('Metric currency'),\n              control:\n              _jsx(CurrencyControl, {\n                currencySelectOverrideProps: {\n                  placeholder: t('Select or type currency symbol')\n                },\n                symbolSelectAdditionalStyles: css`\n                      max-width: 30%;\n                    ` }\n              ) }\n\n            ),\n            _jsx(Field, {\n              label: t('Certified by'),\n              fieldKey: \"certified_by\",\n              description: t(\n                'Person or group that has certified this metric'\n              ),\n              control:\n              _jsx(TextControl, {\n                controlId: \"certified_by\",\n                placeholder: t('Certified by') }\n              ) }\n\n            ),\n            _jsx(Field, {\n              label: t('Certification details'),\n              fieldKey: \"certification_details\",\n              description: t('Details of the certification'),\n              control:\n              _jsx(TextControl, {\n                controlId: \"certification_details\",\n                placeholder: t('Certification details') }\n              ) }\n\n            ),\n            _jsx(Field, {\n              label: t('Warning'),\n              fieldKey: \"warning_markdown\",\n              description: t('Optional warning about use of this metric'),\n              control:\n              _jsx(TextAreaControl, {\n                controlId: \"warning_markdown\",\n                language: \"markdown\",\n                offerEditInModal: false,\n                resize: \"vertical\" }\n              ) }\n\n            )] }\n          ) }\n        ),\n\n        collection: sortedMetrics,\n        allowAddItem: true,\n        onChange: this.onDatasourcePropChange.bind(this, 'metrics'),\n        itemGenerator: () => ({\n          metric_name: t('<new metric>'),\n          verbose_name: '',\n          expression: ''\n        }),\n        itemCellProps: {\n          expression: () => ({\n            width: '240px'\n          })\n        },\n        itemRenderers: {\n          metric_name: (v, onChange, _, record) =>\n          _jsxs(FlexRowContainer, { children: [\n            record.is_certified &&\n            _jsx(CertifiedBadge, {\n              certifiedBy: record.certified_by,\n              details: record.certification_details }\n            ),\n\n            record.warning_markdown &&\n            _jsx(WarningIconWithTooltip, {\n              warningMarkdown: record.warning_markdown }\n            ),\n\n            _jsx(EditableTitle, { canEdit: true, title: v, onSaveTitle: onChange })] }\n          ),\n\n          verbose_name: (v, onChange) =>\n          _jsx(TextControl, { canEdit: true, value: v, onChange: onChange }),\n\n          expression: (v, onChange) =>\n          _jsx(TextAreaControl, {\n            canEdit: true,\n            initialValue: v,\n            onChange: onChange,\n            extraClasses: ['datasource-sql-expression'],\n            language: \"sql\",\n            offerEditInModal: false,\n            minLines: 5,\n            textAreaStyles: { minWidth: '200px', maxWidth: '450px' },\n            resize: \"both\" }\n          ),\n\n          description: (v, onChange, label) =>\n          _jsx(StackedField, {\n            label: label,\n            formElement: _jsx(TextControl, { value: v, onChange: onChange }) }\n          ),\n\n          d3format: (v, onChange, label) =>\n          _jsx(StackedField, {\n            label: label,\n            formElement: _jsx(TextControl, { value: v, onChange: onChange }) }\n          )\n\n        },\n        allowDeletes: true,\n        stickyHeader: true }\n      ));\n\n  }\n\n  render() {\n    const { datasource, activeTabKey } = this.state;\n    const { metrics } = datasource;\n    const sortedMetrics = metrics != null && metrics.length ? this.sortMetrics(metrics) : [];\n    const { theme } = this.props;\n\n    return (\n      _jsxs(DatasourceContainer, { children: [\n        this.renderErrors(),\n        _jsx(Alert, {\n          css: (theme) => ({ marginBottom: theme.gridUnit * 4 }),\n          type: \"warning\",\n          message:\n          _jsxs(_Fragment, { children: [\n            ' ',\n            _jsxs(\"strong\", { children: [t('Be careful.'), \" \"] }),\n            t(\n              'Changing these settings will affect all charts using this dataset, including charts owned by other people.'\n            )] }\n          ) }\n\n        ),\n        _jsxs(StyledTableTabs, {\n          fullWidth: false,\n          id: \"table-tabs\",\n\n          onChange: this.handleTabSelect,\n          defaultActiveKey: activeTabKey, children: [\n\n          _jsx(Tabs.TabPane, { tab: t('Source'), children:\n            this.renderSourceFieldset(theme) }, 0\n          ),\n          _jsx(Tabs.TabPane, {\n            tab:\n            _jsx(CollectionTabTitle, {\n              collection: sortedMetrics,\n              title: t('Metrics') }\n            ), children:\n\n\n\n            this.renderMetricCollection() }, 1\n          ),\n          _jsx(Tabs.TabPane, {\n            tab:\n            _jsx(CollectionTabTitle, {\n              collection: this.state.databaseColumns,\n              title: t('Columns') }\n            ), children:\n\n\n\n            _jsxs(StyledColumnsTabWrapper, { children: [\n              _jsx(ColumnButtonWrapper, { children:\n                _jsx(StyledButtonWrapper, { children:\n                  _jsxs(Button, {\n                    buttonSize: \"small\",\n                    buttonStyle: \"tertiary\",\n                    onClick: this.syncMetadata,\n                    className: \"sync-from-source\",\n                    disabled: this.state.isEditMode, children: [\n\n                    _jsx(Icons.DatabaseOutlined, { iconSize: \"m\" }),\n                    t('Sync columns from source')] }\n                  ) }\n                ) }\n              ),\n              _jsx(ColumnCollectionTable, {\n                className: \"columns-table\",\n                columns: this.state.databaseColumns,\n                datasource: datasource,\n                onColumnsChange: (databaseColumns) =>\n                this.setColumns({ databaseColumns }),\n\n                onDatasourceChange: this.onDatasourceChange }\n              ),\n              this.state.metadataLoading && _jsx(Loading, {})] }\n            ) }, 2\n          ),\n          _jsx(Tabs.TabPane, {\n            tab:\n            _jsx(CollectionTabTitle, {\n              collection: this.state.calculatedColumns,\n              title: t('Calculated columns') }\n            ), children:\n\n\n\n            _jsx(StyledColumnsTabWrapper, { children:\n              _jsx(ColumnCollectionTable, {\n                columns: this.state.calculatedColumns,\n                onColumnsChange: (calculatedColumns) =>\n                this.setColumns({ calculatedColumns }),\n\n                columnLabelTooltips: {\n                  column_name: t(\n                    'This field is used as a unique identifier to attach ' +\n                    'the calculated dimension to charts. It is also used ' +\n                    'as the alias in the SQL query.'\n                  )\n                },\n                onDatasourceChange: this.onDatasourceChange,\n                datasource: datasource,\n                editableColumnName: true,\n                showExpression: true,\n                allowAddItem: true,\n                allowEditDataType: true,\n                itemGenerator: () => ({\n                  column_name: t('<new column>'),\n                  filterable: true,\n                  groupby: true,\n                  expression: t('<enter SQL expression here>'),\n                  __expanded: true\n                }) }\n              ) }\n            ) }, 3\n          ),\n          _jsx(Tabs.TabPane, { tab: t('Settings'), children:\n            _jsxs(Row, { gutter: 16, children: [\n              _jsx(Col, { xs: 24, md: 12, children:\n                _jsx(FormContainer, { children: this.renderSettingsFieldset() }) }\n              ),\n              _jsx(Col, { xs: 24, md: 12, children:\n                _jsx(FormContainer, { children: this.renderAdvancedFieldset() }) }\n              )] }\n            ) }, 4\n          )] }\n        )] }\n      ));\n\n  }\n}\n\nDatasourceEditor.defaultProps = defaultProps;\nDatasourceEditor.propTypes = propTypes;\n\nconst DataSourceComponent = withTheme(DatasourceEditor);\n\nexport default withToasts(DataSourceComponent);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}